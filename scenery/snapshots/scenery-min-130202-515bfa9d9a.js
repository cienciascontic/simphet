'use strict';var phetDebug=!1,phet=phet||{};phet.assert=function(c,b){if (!c)throw Error("Assertion failed: "+b);};phet.debugAssert=function(c,b){if (phetDebug&&!c())throw Error("Assertion failed: "+b);};phet.util=phet.util||{};
(function(){phet.util.remove=function(c,b){c.splice(c.indexOf(b),1)};phet.util.isArray=function(c){return"[object Array]"===Object.prototype.toString.call(c)};phet.util.foreach=function(c,b){for (var a=0;a<c.length;a++)b.call(void 0,c[a])};phet.util.map=function(c,b){var a=[];phet.util.foreach(c,function(e){a.push(b.call(void 0,e))});return a};phet.util.rangeInclusive=function(c,b){for (var a=Array(b-c+1),e=c;e<=b;e++)a[e]=e;return a};phet.util.mkString=function(c,b){var a="";b=void 0===b?", ":b;var e=
!0;phet.util.foreach(c,function(d){e||(a+=b);e=!1;a=void 0===d?a+"undefined":a+d.toString()});return a};phet.util.pairs=function(c){for (var b=[],a=c.length,e=0;e<a-1;e++)for (var d=c[e],f=e+1;f<a;f++)b.push([d,c[f]]);return b};phet.util.partition=function(c,b){for (var a=[],e=[],d=0;d<c.length;d++){var f=c[d];b.call(void 0,f)?a.push(f):e.push(f)}return[a,e]};phet.util.filter=function(c,b){for (var a=[],e=0;e<c.length;e++){var d=c[e];b.call(void 0,d)&&a.push(d)}return a};phet.util.unique=function(c,b){b||
(b=function(a,d){return a===d});for (var a=[],e=0;e<c.length;e++){for (var d=!0,f=c[e],n=0;n<a.length;n++)if (b(f,a[n])){d=!1;break}d&&a.push(f)}return a};phet.util.first=function(c,b){for (var a=0;a<c.length;a++)if (b(c[a]))return c[a]};phet.util.firstOrNull=function(c,b){var a=phet.util.first(c,b);return void 0===a?null:a};phet.util.subtract=function(c,b){return phet.util.filter(c,function(a){return-1===b.indexOf(a)})};phet.util.count=function(c,b){for (var a=0,e=0;e<c.length;e++)b(c[e])&&a++;return a}})();
(function(){Object.create||(Object.create=function(a){function d(){}if (1<arguments.length)throw Error("Object.create implementation only accepts the first parameter.");d.prototype=a;return new d});window.Float32Array||(window.Float32Array=Array);for (var c=0,b=["ms","moz","webkit","o"],a=0;a<b.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[b[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[a]+"CancelAnimationFrame"]||window[b[a]+"CancelRequestAnimationFrame"];
window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var d=(new Date).getTime(),b=Math.max(0,16-(d-c)),n=window.setTimeout(function(){a(d+b)},b);c=d+b;return n});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})})();phet=phet||{};phet.model=phet.model||{};
(function(){phet.model.Property=function(b){this.observers=[];this.initialValue=this.value=b};var c=phet.model.Property;c.prototype={constructor:c,addObserver:function(b,a){this.observers.push(b);a&&b.call(void 0,this.value,this.value)},removeObserver:function(b){this.observers.splice(this.observers.indexOf(b),1)},notifyObservers:function(b,a){for (var e in this.observers)this.observers.hasOwnProperty(e)&&this.observers[e].call(void 0,b,a)},toString:function(){return this.value.toString()},get:function(){return this.value},
set:function(b){var a=this.value;if (null===b?null!==a:b!==a||b.equals&&b.equals(a))this.value=b,this.notifyObservers(a,this.value)},getInitialValue:function(){return this.initialValue}}})();phet=phet||{};phet.model=phet.model||{};
(function(){phet.model.Notifier=function(){this.listeners=[]};var c=phet.model.Notifier;c.prototype={constructor:c,addListener:function(a){this.listeners.push(a)},addUpdateListener:function(a,e){this.listeners.push(a);e&&a()},removeListener:function(a){this.listeners.splice(this.listeners.indexOf(a),1)},updateListeners:function(a){for (var e=0;e<this.listeners.length;e++)this.listeners[e](a)}};phet.model.CompositeNotifier=function(a){function e(a){d.updateListeners(a)}c.call(this);this.notifiers=a;
for (var d=this,b=0;b<a.length;b++)a[b].addListener(e)};var b=phet.model.CompositeNotifier;b.prototype=Object.create(c.prototype);b.prototype.constructor=b})();phet=phet||{};phet.math=phet.math||{};phet.math.clamp=function(c,b,a){return c<b?b:c>a?a:c};phet.math.toRadians=function(c){return Math.PI*c/180};phet=phet||{};phet.math=phet.math||{};
(function(){phet.math.Vector2=function(a,e){this.x=a||0;this.y=e||0};var c=phet.math.Vector2;c.createPolar=function(a,e){return(new c(Math.cos(e),Math.sin(e))).timesScalar(a)};phet.math.Vector2.prototype={constructor:phet.math.Vector2,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.dot(this)},dot:function(a){return this.x*a.x+this.y*a.y},crossScalar:function(a){return this.magnitude()*a.magnitude()*Math.sin(this.getAngle()-a.getAngle())},normalized:function(){var a=
this.magnitude();if (0===a)throw Error("Cannot normalize a zero-magnitude vector");return new c(this.x/a,this.y/a)},timesScalar:function(a){return new c(this.x*a,this.y*a)},times:function(a){phet.assert(void 0===a.dimension);return this.timesScalar(a)},componentTimes:function(a){return new c(this.x*a.x,this.y*a.y)},plus:function(a){return new c(this.x+a.x,this.y+a.y)},plusScalar:function(a){return new c(this.x+a,this.y+a)},minus:function(a){return new c(this.x-a.x,this.y-a.y)},minusScalar:function(a){return new c(this.x-
a,this.y-a)},dividedScalar:function(a){return new c(this.x/a,this.y/a)},negated:function(){return new c(-this.x,-this.y)},angle:function(){return Math.atan2(this.x,this.y)},perpendicular:function(){return new c(this.y,-this.x)},angleBetween:function(a){return Math.acos(phet.math.clamp(this.normalized().dot(a.normalized()),-1,1))},rotated:function(a){return c.createPolar(this.magnitude(),this.getAngle+a)},toString:function(){return"Vector2("+this.x+", "+this.y+")"},toVector3:function(){return new phet.math.Vector3(this.x,
this.y)},set:function(a,e){this.x=a;this.y=e},setX:function(a){this.x=a},setY:function(a){this.y=a},copy:function(a){this.x=a.x;this.y=a.y},add:function(a){this.x+=a.x;this.y+=a.y},addScalar:function(a){this.x+=a;this.y+=a},subtract:function(a){this.x-=a.x;this.y-=a.y},subtractScalar:function(a){this.x-=a;this.y-=a},componentMultiply:function(a){this.x*=a.x;this.y*=a.y},divideScalar:function(a){this.x/=a;this.y/=a},negate:function(){this.x=-this.x;this.y=-this.y},equals:function(a,e){e||(e=0);return Math.abs(this.x-
a.x)+Math.abs(this.y-a.y)<=e},isVector2:!0,dimension:2};c.Immutable=function(a,e){this.x=a||0;this.y=e||0};var b=c.Immutable;b.prototype=new phet.math.Vector2;b.prototype.constructor=b;b.mutableOverrideHelper=function(a){b.prototype[a]=function(){throw Error("Cannot call mutable method '"+a+"' on immutable Vector2");}};b.mutableOverrideHelper("set");b.mutableOverrideHelper("setX");b.mutableOverrideHelper("setY");b.mutableOverrideHelper("copy");b.mutableOverrideHelper("add");b.mutableOverrideHelper("addScalar");
b.mutableOverrideHelper("subtract");b.mutableOverrideHelper("subtractScalar");b.mutableOverrideHelper("componentMultiply");b.mutableOverrideHelper("divideScalar");b.mutableOverrideHelper("negate");c.ZERO=new b(0,0);c.X_UNIT=new b(1,0);c.Y_UNIT=new b(0,1)})();phet=phet||{};phet.math=phet.math||{};
(function(){phet.math.Vector3=function(a,e,d){this.x=a||0;this.y=e||0;this.z=d||0};var c=phet.math.Vector3;phet.math.Vector3.prototype={constructor:phet.math.Vector3,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.dot(this)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},cross:function(a){return new c(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,this.x*a.y-this.y*a.x)},normalized:function(){var a=this.magnitude();if (0===a)throw Error("Cannot normalize a zero-magnitude vector");
return new c(this.x/a,this.y/a,this.z/a)},timesScalar:function(a){return new c(this.x*a,this.y*a,this.z*a)},times:function(a){phet.assert(void 0===a.dimension);return this.timesScalar(a)},componentTimes:function(a){return new c(this.x*a.x,this.y*a.y,this.z*a.z)},plus:function(a){return new c(this.x+a.x,this.y+a.y,this.z+a.z)},plusScalar:function(a){return new c(this.x+a,this.y+a,this.z+a)},minus:function(a){return new c(this.x-a.x,this.y-a.y,this.z-a.z)},minusScalar:function(a){return new c(this.x-
a,this.y-a,this.z-a)},dividedScalar:function(a){return new c(this.x/a,this.y/a,this.z/a)},negated:function(){return new c(-this.x,-this.y,-this.z)},angleBetween:function(a){return Math.acos(phet.math.clamp(this.normalized().dot(a.normalized()),-1,1))},toString:function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"},toVector2:function(){return new phet.math.Vector2(this.x,this.y)},toVector4:function(){return new phet.math.Vector4(this.x,this.y,this.z)},set:function(a,e,d){this.x=a;this.y=e;
this.z=d},setX:function(a){this.x=a},setY:function(a){this.y=a},setZ:function(a){this.z=a},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a},subtract:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z},subtractScalar:function(a){this.x-=a;this.y-=a;this.z-=a},componentMultiply:function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z},divideScalar:function(a){this.x/=a;this.y/=a;this.z/=a},negate:function(){this.x=
-this.x;this.y=-this.y;this.z=-this.z},equals:function(a,e){e||(e=0);return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)<=e},isVector3:!0,dimension:3};c.Immutable=function(a,e,d){this.x=a||0;this.y=e||0;this.z=d||0};var b=c.Immutable;b.prototype=new phet.math.Vector3;b.prototype.constructor=b;b.mutableOverrideHelper=function(a){b.prototype[a]=function(){throw Error("Cannot call mutable method '"+a+"' on immutable Vector3");}};b.mutableOverrideHelper("set");b.mutableOverrideHelper("setX");
b.mutableOverrideHelper("setY");b.mutableOverrideHelper("setZ");b.mutableOverrideHelper("copy");b.mutableOverrideHelper("add");b.mutableOverrideHelper("addScalar");b.mutableOverrideHelper("subtract");b.mutableOverrideHelper("subtractScalar");b.mutableOverrideHelper("componentMultiply");b.mutableOverrideHelper("divideScalar");b.mutableOverrideHelper("negate");c.ZERO=new b(0,0,0);c.X_UNIT=new b(1,0,0);c.Y_UNIT=new b(0,1,0);c.Z_UNIT=new b(0,0,1)})();phet=phet||{};phet.math=phet.math||{};
(function(){phet.math.Vector4=function(a,e,d,b){this.x=a||0;this.y=e||0;this.z=d||0;this.w=void 0!==b?b:1};var c=phet.math.Vector4;phet.math.Vector4.prototype={constructor:phet.math.Vector4,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){this.dot(this)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},normalized:function(){var a=this.magnitude();if (0===a)throw Error("Cannot normalize a zero-magnitude vector");return new c(this.x/a,this.y/
a,this.z/a,this.w/a)},timesScalar:function(a){return new c(this.x*a,this.y*a,this.z*a,this.w*a)},times:function(a){phet.assert(void 0===a.dimension);return this.timesScalar(a)},componentTimes:function(a){return new c(this.x*a.x,this.y*a.y,this.z*a.z,this.w*a.w)},plus:function(a){return new c(this.x+a.x,this.y+a.y,this.z+a.z,this.w+a.w)},plusScalar:function(a){return new c(this.x+a,this.y+a,this.z+a,this.w+a)},minus:function(a){return new c(this.x-a.x,this.y-a.y,this.z-a.z,this.w-a.w)},minusScalar:function(a){return new c(this.x-
a,this.y-a,this.z-a,this.w-a)},dividedScalar:function(a){return new c(this.x/a,this.y/a,this.z/a,this.w/a)},negated:function(){return new c(-this.x,-this.y,-this.z,-this.w)},angleBetween:function(a){return Math.acos(phet.math.clamp(this.normalized().dot(a.normalized()),-1,1))},toString:function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},toVector3:function(){return new phet.math.Vector3(this.x,this.y,this.z)},set:function(a,e,d,b){this.x=a;this.y=e;this.z=d;this.w=b},setX:function(a){this.x=
a},setY:function(a){this.y=a},setZ:function(a){this.z=a},setW:function(a){this.w=a},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a},subtract:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w},subtractScalar:function(a){this.x-=a;this.y-=a;this.z-=a;this.w-=a},componentMultiply:function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;this.w*=a.w},divideScalar:function(a){this.x/=
a;this.y/=a;this.z/=a;this.w/=a},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w},equals:function(a,e){e||(e=0);return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)+Math.abs(this.w-a.w)<=e},isVector4:!0,dimension:4};c.Immutable=function(a,e,d,b){this.x=a||0;this.y=e||0;this.z=d||0;this.w=void 0!==b?b:1};var b=c.Immutable;b.prototype=new phet.math.Vector4;b.prototype.constructor=b;b.mutableOverrideHelper=function(a){b.prototype[a]=function(){throw Error("Cannot call mutable method '"+
a+"' on immutable Vector4");}};b.mutableOverrideHelper("set");b.mutableOverrideHelper("setX");b.mutableOverrideHelper("setY");b.mutableOverrideHelper("setZ");b.mutableOverrideHelper("setW");b.mutableOverrideHelper("copy");b.mutableOverrideHelper("add");b.mutableOverrideHelper("addScalar");b.mutableOverrideHelper("subtract");b.mutableOverrideHelper("subtractScalar");b.mutableOverrideHelper("componentMultiply");b.mutableOverrideHelper("divideScalar");b.mutableOverrideHelper("negate");c.ZERO=new b(0,
0,0,0);c.X_UNIT=new b(1,0,0,0);c.Y_UNIT=new b(0,1,0,0);c.Z_UNIT=new b(0,0,1,0);c.W_UNIT=new b(0,0,0,1)})();phet=phet||{};phet.math=phet.math||{};
(function(){phet.math.Matrix3=function(a,d,b,c,g,h,k,p,s,r){this.entries=Array(9);this.rowMajor(void 0===a?1:a,d||0,b||0,c||0,void 0===g?1:g,h||0,k||0,p||0,void 0===s?1:s,r)};phet.math.Matrix3.Types={OTHER:0,IDENTITY:1,TRANSLATION_2D:2,SCALING:3};var c=phet.math.Matrix3,b=phet.math.Vector3,a=c.Types;c.identity=function(){return new c(1,0,0,0,1,0,0,0,1,a.IDENTITY)};c.translation=function(e,d){return new c(1,0,e,0,1,d,0,0,1,a.TRANSLATION_2D)};c.translationFromVector=function(a){return c.translation(a.x,
a.y)};c.scaling=function(e,d){return new c(e,0,0,0,void 0===d?e:d,0,0,0,1,a.SCALING)};c.rotationAxisAngle=function(e,d){var b=Math.cos(d),n=Math.sin(d),g=1-b;return new c(e.x*e.x*g+b,e.x*e.y*g-e.z*n,e.x*e.z*g+e.y*n,e.y*e.x*g+e.z*n,e.y*e.y*g+b,e.y*e.z*g-e.x*n,e.z*e.x*g-e.y*n,e.z*e.y*g+e.x*n,e.z*e.z*g+b,a.OTHER)};c.rotationX=function(e){var d=Math.cos(e);e=Math.sin(e);return new c(1,0,0,0,d,-e,0,e,d,a.OTHER)};c.rotationY=function(e){var d=Math.cos(e);e=Math.sin(e);return new c(d,0,e,0,1,0,-e,0,d,a.OTHER)};
c.rotationZ=function(e){var d=Math.cos(e);e=Math.sin(e);return new c(d,-e,0,e,d,0,0,0,1,a.OTHER)};c.rotation2=c.rotationZ;c.fromSVGMatrix=function(e){return new c(e.a,e.c,e.e,e.b,e.d,e.f,0,0,1,a.OTHER)};c.rotateAToB=function(a,d){var f,n,g=a.cross(d);f=a.dot(d);if (0.9999<(0>f?-f:f)){var h,k,g=new b(0<a.x?a.x:-a.x,0<a.y?a.y:-a.y,0<a.z?a.z:-a.z),g=g.x<g.y?g.x<g.z?b.X_UNIT:b.Z_UNIT:g.y<g.z?b.Y_UNIT:b.Z_UNIT;f=g.minus(a);g=g.minus(d);n=2/f.dot(f);h=2/g.dot(g);k=n*h*f.dot(g);return c.IDENTITY.plus(c.rowMajor(-n*
f.x*f.x-h*g.x*g.x+k*g.x*f.x,-n*f.x*f.y-h*g.x*g.y+k*g.x*f.y,-n*f.x*f.z-h*g.x*g.z+k*g.x*f.z,-n*f.y*f.x-h*g.y*g.x+k*g.y*f.x,-n*f.y*f.y-h*g.y*g.y+k*g.y*f.y,-n*f.y*f.z-h*g.y*g.z+k*g.y*f.z,-n*f.z*f.x-h*g.z*g.x+k*g.z*f.x,-n*f.z*f.y-h*g.z*g.y+k*g.z*f.y,-n*f.z*f.z-h*g.z*g.z+k*g.z*f.z))}var p,s,r;n=1/(1+f);h=n*g.x;k=n*g.z;p=h*g.y;s=h*g.z;r=k*g.y;return c.rowMajor(f+h*g.x,p-g.z,s+g.y,p+g.z,f+n*g.y*g.y,r-g.x,s-g.y,r+g.x,f+k*g.z)};c.prototype={constructor:c,rowMajor:function(e,d,b,c,g,h,k,p,s,r){this.entries[0]=
e;this.entries[1]=c;this.entries[2]=k;this.entries[3]=d;this.entries[4]=g;this.entries[5]=p;this.entries[6]=b;this.entries[7]=h;this.entries[8]=s;this.type=void 0===r?a.OTHER:r},columnMajor:function(a,d,b,c,g,h,k,p,s,r){this.rowMajor(a,c,k,d,g,p,b,h,s,r)},m00:function(){return this.entries[0]},m01:function(){return this.entries[3]},m02:function(){return this.entries[6]},m10:function(){return this.entries[1]},m11:function(){return this.entries[4]},m12:function(){return this.entries[7]},m20:function(){return this.entries[2]},
m21:function(){return this.entries[5]},m22:function(){return this.entries[8]},plus:function(a){return new c(this.m00()+a.m00(),this.m01()+a.m01(),this.m02()+a.m02(),this.m10()+a.m10(),this.m11()+a.m11(),this.m12()+a.m12(),this.m20()+a.m20(),this.m21()+a.m21(),this.m22()+a.m22())},minus:function(a){return new c(this.m00()-a.m00(),this.m01()-a.m01(),this.m02()-a.m02(),this.m10()-a.m10(),this.m11()-a.m11(),this.m12()-a.m12(),this.m20()-a.m20(),this.m21()-a.m21(),this.m22()-a.m22())},transposed:function(){return new c(this.m00(),
this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22())},negated:function(){return new c(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},inverted:function(){var a=this.determinant();if (0!==a)return new c((-this.m12()*this.m21()+this.m11()*this.m22())/a,(this.m02()*this.m21()-this.m01()*this.m22())/a,(-this.m02()*this.m11()+this.m01()*this.m12())/a,(this.m12()*this.m20()-this.m10()*this.m22())/a,(-this.m02()*
this.m20()+this.m00()*this.m22())/a,(this.m02()*this.m10()-this.m00()*this.m12())/a,(-this.m11()*this.m20()+this.m10()*this.m21())/a,(this.m01()*this.m20()-this.m00()*this.m21())/a,(-this.m01()*this.m10()+this.m00()*this.m11())/a);throw Error("Matrix could not be inverted, determinant === 0");},timesMatrix:function(e){var d=a.OTHER;this.type===a.TRANSLATION_2D&&e.type===a.TRANSLATION_2D&&(d=a.TRANSLATION_2D);this.type===a.SCALING&&e.type===a.SCALING&&(d=a.SCALING);this.type===a.IDENTITY&&(d=e.type);
e.type===a.IDENTITY&&(d=this.type);return new c(this.m00()*e.m00()+this.m01()*e.m10()+this.m02()*e.m20(),this.m00()*e.m01()+this.m01()*e.m11()+this.m02()*e.m21(),this.m00()*e.m02()+this.m01()*e.m12()+this.m02()*e.m22(),this.m10()*e.m00()+this.m11()*e.m10()+this.m12()*e.m20(),this.m10()*e.m01()+this.m11()*e.m11()+this.m12()*e.m21(),this.m10()*e.m02()+this.m11()*e.m12()+this.m12()*e.m22(),this.m20()*e.m00()+this.m21()*e.m10()+this.m22()*e.m20(),this.m20()*e.m01()+this.m21()*e.m11()+this.m22()*e.m21(),
this.m20()*e.m02()+this.m21()*e.m12()+this.m22()*e.m22(),d)},timesVector2:function(a){var d=this.m00()*a.x+this.m01()*a.y+this.m02();a=this.m10()*a.x+this.m11()*a.y+this.m12();return new phet.math.Vector2(d,a)},timesVector3:function(a){var d=this.m00()*a.x+this.m01()*a.y+this.m02()*a.z,b=this.m10()*a.x+this.m11()*a.y+this.m12()*a.z;a=this.m20()*a.x+this.m21()*a.y+this.m22()*a.z;return new phet.math.Vector3(d,b,a)},timesTransposeVector2:function(a){var d=this.m00()*a.x+this.m10()*a.y;a=this.m01()*
a.x+this.m11()*a.y;return new phet.math.Vector2(d,a)},timesRelativeVector2:function(a){var d=this.m00()*a.x+this.m10()*a.y;a=this.m01()*a.y+this.m11()*a.y;return new phet.math.Vector2(d,a)},determinant:function(){return this.m00()*this.m11()*this.m22()+this.m01()*this.m12()*this.m20()+this.m02()*this.m10()*this.m21()-this.m02()*this.m11()*this.m20()-this.m01()*this.m10()*this.m22()-this.m00()*this.m12()*this.m21()},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+"\n"+this.m10()+
" "+this.m11()+" "+this.m12()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()},toMatrix4:function(){return new phet.math.Matrix4(this.m00(),this.m01(),this.m02(),0,this.m10(),this.m11(),this.m12(),0,this.m20(),this.m21(),this.m22(),0,0,0,0,1)},translation:function(){return new phet.math.Vector2(this.m02(),this.m12())},scaling:function(){return new phet.math.Vector3(this.m00(),this.m11(),this.m22())},rotation:function(){var a=this.timesVector2(phet.math.Vector2.X_UNIT).minus(this.timesVector2(phet.math.Vector2.ZERO));
return Math.atan2(a.y,a.x)},makeImmutable:function(){this.rowMajor=function(){throw Error("Cannot modify immutable matrix");}},toSVGMatrix:function(){var a=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();a.a=this.m00();a.b=this.m10();a.c=this.m01();a.d=this.m11();a.e=this.m02();a.f=this.m12();return a},canvasSetTransform:function(a){a.setTransform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},canvasAppendTransform:function(a){a.transform(this.entries[0],
this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},cssTransform:function(){return"matrix("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+")"}};c.IDENTITY=new c(1,0,0,0,1,0,0,0,1,a.IDENTITY);c.IDENTITY.makeImmutable()})();phet=phet||{};phet.math=phet.math||{};
(function(){phet.math.Matrix4=function(a,e,d,b,c,g,h,k,p,s,r,q,t,j,m,l,u){this.entries=new Float32Array(16);this.rowMajor(void 0===a?1:a,e||0,d||0,b||0,c||0,void 0===g?1:g,h||0,k||0,p||0,s||0,void 0===r?1:r,q||0,t||0,j||0,m||0,void 0===l?1:l,u)};phet.math.Matrix4.Types={OTHER:0,IDENTITY:1,TRANSLATION_3D:2,SCALING:3};var c=phet.math.Matrix4,b=c.Types;c.identity=function(){return new c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,b.IDENTITY)};c.translation=function(a,e,d){return new c(1,0,0,a,0,1,0,e,0,0,1,d,0,
0,0,1,b.TRANSLATION_3D)};c.translationFromVector=function(a){return c.translation(a.x,a.y,a.z)};c.scaling=function(a,e,d){return new c(a,0,0,0,0,void 0===e?a:e,0,0,0,0,void 0===d?a:d,0,0,0,0,1,b.SCALING)};c.rotationAxisAngle=function(a,e){var d=Math.cos(e),f=Math.sin(e),n=1-d;return new c(a.x*a.x*n+d,a.x*a.y*n-a.z*f,a.x*a.z*n+a.y*f,0,a.y*a.x*n+a.z*f,a.y*a.y*n+d,a.y*a.z*n-a.x*f,0,a.z*a.x*n-a.y*f,a.z*a.y*n+a.x*f,a.z*a.z*n+d,0,0,0,0,1,b.OTHER)};c.rotationX=function(a){var e=Math.cos(a);a=Math.sin(a);
return new c(1,0,0,0,0,e,-a,0,0,a,e,0,0,0,0,1,b.OTHER)};c.rotationY=function(a){var e=Math.cos(a);a=Math.sin(a);return new c(e,0,a,0,0,1,0,0,-a,0,e,0,0,0,0,1,b.OTHER)};c.rotationZ=function(a){var e=Math.cos(a);a=Math.sin(a);return new c(e,-a,0,0,a,e,0,0,0,0,1,0,0,0,0,1,b.OTHER)};c.gluPerspective=function(a,e,d,b){a=Math.cos(a)/Math.sin(a);return new c(a/e,0,0,0,0,a,0,0,0,0,(b+d)/(d-b),2*b*d/(d-b),0,0,-1,0)};c.prototype={constructor:c,rowMajor:function(a,e,d,f,c,g,h,k,p,s,r,q,t,j,m,l,u){this.entries[0]=
a;this.entries[1]=c;this.entries[2]=p;this.entries[3]=t;this.entries[4]=e;this.entries[5]=g;this.entries[6]=s;this.entries[7]=j;this.entries[8]=d;this.entries[9]=h;this.entries[10]=r;this.entries[11]=m;this.entries[12]=f;this.entries[13]=k;this.entries[14]=q;this.entries[15]=l;this.type=void 0===u?b.OTHER:u},columnMajor:function(a,e,d,b,c,g,h,k,p,s,r,q,t,j,m,l,u){this.rowMajor(a,c,p,t,e,g,s,j,d,h,r,m,b,k,q,l,u)},m00:function(){return this.entries[0]},m01:function(){return this.entries[4]},m02:function(){return this.entries[8]},
m03:function(){return this.entries[12]},m10:function(){return this.entries[1]},m11:function(){return this.entries[5]},m12:function(){return this.entries[9]},m13:function(){return this.entries[13]},m20:function(){return this.entries[2]},m21:function(){return this.entries[6]},m22:function(){return this.entries[10]},m23:function(){return this.entries[14]},m30:function(){return this.entries[3]},m31:function(){return this.entries[7]},m32:function(){return this.entries[11]},m33:function(){return this.entries[15]},
plus:function(a){return new c(this.m00()+a.m00(),this.m01()+a.m01(),this.m02()+a.m02(),this.m03()+a.m03(),this.m10()+a.m10(),this.m11()+a.m11(),this.m12()+a.m12(),this.m13()+a.m13(),this.m20()+a.m20(),this.m21()+a.m21(),this.m22()+a.m22(),this.m23()+a.m23(),this.m30()+a.m30(),this.m31()+a.m31(),this.m32()+a.m32(),this.m33()+a.m33())},minus:function(a){return new c(this.m00()-a.m00(),this.m01()-a.m01(),this.m02()-a.m02(),this.m03()-a.m03(),this.m10()-a.m10(),this.m11()-a.m11(),this.m12()-a.m12(),this.m13()-
a.m13(),this.m20()-a.m20(),this.m21()-a.m21(),this.m22()-a.m22(),this.m23()-a.m23(),this.m30()-a.m30(),this.m31()-a.m31(),this.m32()-a.m32(),this.m33()-a.m33())},transposed:function(){return new c(this.m00(),this.m10(),this.m20(),this.m30(),this.m01(),this.m11(),this.m21(),this.m31(),this.m02(),this.m12(),this.m22(),this.m32(),this.m03(),this.m13(),this.m23(),this.m33())},negated:function(){return new c(-this.m00(),-this.m01(),-this.m02(),-this.m03(),-this.m10(),-this.m11(),-this.m12(),-this.m13(),
-this.m20(),-this.m21(),-this.m22(),-this.m23(),-this.m30(),-this.m31(),-this.m32(),-this.m33())},inverted:function(){var a=this.determinant();if (0!==a)return new c((-this.m31()*this.m22()*this.m13()+this.m21()*this.m32()*this.m13()+this.m31()*this.m12()*this.m23()-this.m11()*this.m32()*this.m23()-this.m21()*this.m12()*this.m33()+this.m11()*this.m22()*this.m33())/a,(this.m31()*this.m22()*this.m03()-this.m21()*this.m32()*this.m03()-this.m31()*this.m02()*this.m23()+this.m01()*this.m32()*this.m23()+
this.m21()*this.m02()*this.m33()-this.m01()*this.m22()*this.m33())/a,(-this.m31()*this.m12()*this.m03()+this.m11()*this.m32()*this.m03()+this.m31()*this.m02()*this.m13()-this.m01()*this.m32()*this.m13()-this.m11()*this.m02()*this.m33()+this.m01()*this.m12()*this.m33())/a,(this.m21()*this.m12()*this.m03()-this.m11()*this.m22()*this.m03()-this.m21()*this.m02()*this.m13()+this.m01()*this.m22()*this.m13()+this.m11()*this.m02()*this.m23()-this.m01()*this.m12()*this.m23())/a,(this.m30()*this.m22()*this.m13()-
this.m20()*this.m32()*this.m13()-this.m30()*this.m12()*this.m23()+this.m10()*this.m32()*this.m23()+this.m20()*this.m12()*this.m33()-this.m10()*this.m22()*this.m33())/a,(-this.m30()*this.m22()*this.m03()+this.m20()*this.m32()*this.m03()+this.m30()*this.m02()*this.m23()-this.m00()*this.m32()*this.m23()-this.m20()*this.m02()*this.m33()+this.m00()*this.m22()*this.m33())/a,(this.m30()*this.m12()*this.m03()-this.m10()*this.m32()*this.m03()-this.m30()*this.m02()*this.m13()+this.m00()*this.m32()*this.m13()+
this.m10()*this.m02()*this.m33()-this.m00()*this.m12()*this.m33())/a,(-this.m20()*this.m12()*this.m03()+this.m10()*this.m22()*this.m03()+this.m20()*this.m02()*this.m13()-this.m00()*this.m22()*this.m13()-this.m10()*this.m02()*this.m23()+this.m00()*this.m12()*this.m23())/a,(-this.m30()*this.m21()*this.m13()+this.m20()*this.m31()*this.m13()+this.m30()*this.m11()*this.m23()-this.m10()*this.m31()*this.m23()-this.m20()*this.m11()*this.m33()+this.m10()*this.m21()*this.m33())/a,(this.m30()*this.m21()*this.m03()-
this.m20()*this.m31()*this.m03()-this.m30()*this.m01()*this.m23()+this.m00()*this.m31()*this.m23()+this.m20()*this.m01()*this.m33()-this.m00()*this.m21()*this.m33())/a,(-this.m30()*this.m11()*this.m03()+this.m10()*this.m31()*this.m03()+this.m30()*this.m01()*this.m13()-this.m00()*this.m31()*this.m13()-this.m10()*this.m01()*this.m33()+this.m00()*this.m11()*this.m33())/a,(this.m20()*this.m11()*this.m03()-this.m10()*this.m21()*this.m03()-this.m20()*this.m01()*this.m13()+this.m00()*this.m21()*this.m13()+
this.m10()*this.m01()*this.m23()-this.m00()*this.m11()*this.m23())/a,(this.m30()*this.m21()*this.m12()-this.m20()*this.m31()*this.m12()-this.m30()*this.m11()*this.m22()+this.m10()*this.m31()*this.m22()+this.m20()*this.m11()*this.m32()-this.m10()*this.m21()*this.m32())/a,(-this.m30()*this.m21()*this.m02()+this.m20()*this.m31()*this.m02()+this.m30()*this.m01()*this.m22()-this.m00()*this.m31()*this.m22()-this.m20()*this.m01()*this.m32()+this.m00()*this.m21()*this.m32())/a,(this.m30()*this.m11()*this.m02()-
this.m10()*this.m31()*this.m02()-this.m30()*this.m01()*this.m12()+this.m00()*this.m31()*this.m12()+this.m10()*this.m01()*this.m32()-this.m00()*this.m11()*this.m32())/a,(-this.m20()*this.m11()*this.m02()+this.m10()*this.m21()*this.m02()+this.m20()*this.m01()*this.m12()-this.m00()*this.m21()*this.m12()-this.m10()*this.m01()*this.m22()+this.m00()*this.m11()*this.m22())/a);throw Error("Matrix could not be inverted, determinant === 0");},timesMatrix:function(a){var e=b.OTHER;this.type===b.TRANSLATION_3D&&
a.type===b.TRANSLATION_3D&&(e=b.TRANSLATION_3D);this.type===b.SCALING&&a.type===b.SCALING&&(e=b.SCALING);this.type===b.IDENTITY&&(e=a.type);a.type===b.IDENTITY&&(e=this.type);return new c(this.m00()*a.m00()+this.m01()*a.m10()+this.m02()*a.m20()+this.m03()*a.m30(),this.m00()*a.m01()+this.m01()*a.m11()+this.m02()*a.m21()+this.m03()*a.m31(),this.m00()*a.m02()+this.m01()*a.m12()+this.m02()*a.m22()+this.m03()*a.m32(),this.m00()*a.m03()+this.m01()*a.m13()+this.m02()*a.m23()+this.m03()*a.m33(),this.m10()*
a.m00()+this.m11()*a.m10()+this.m12()*a.m20()+this.m13()*a.m30(),this.m10()*a.m01()+this.m11()*a.m11()+this.m12()*a.m21()+this.m13()*a.m31(),this.m10()*a.m02()+this.m11()*a.m12()+this.m12()*a.m22()+this.m13()*a.m32(),this.m10()*a.m03()+this.m11()*a.m13()+this.m12()*a.m23()+this.m13()*a.m33(),this.m20()*a.m00()+this.m21()*a.m10()+this.m22()*a.m20()+this.m23()*a.m30(),this.m20()*a.m01()+this.m21()*a.m11()+this.m22()*a.m21()+this.m23()*a.m31(),this.m20()*a.m02()+this.m21()*a.m12()+this.m22()*a.m22()+
this.m23()*a.m32(),this.m20()*a.m03()+this.m21()*a.m13()+this.m22()*a.m23()+this.m23()*a.m33(),this.m30()*a.m00()+this.m31()*a.m10()+this.m32()*a.m20()+this.m33()*a.m30(),this.m30()*a.m01()+this.m31()*a.m11()+this.m32()*a.m21()+this.m33()*a.m31(),this.m30()*a.m02()+this.m31()*a.m12()+this.m32()*a.m22()+this.m33()*a.m32(),this.m30()*a.m03()+this.m31()*a.m13()+this.m32()*a.m23()+this.m33()*a.m33(),e)},timesVector4:function(a){var e=this.m00()*a.x+this.m01()*a.y+this.m02()*a.z+this.m03()*a.w,d=this.m10()*
a.x+this.m11()*a.y+this.m12()*a.z+this.m13()*a.w,b=this.m20()*a.x+this.m21()*a.y+this.m22()*a.z+this.m23()*a.w;a=this.m30()*a.x+this.m31()*a.y+this.m32()*a.z+this.m33()*a.w;return new phet.math.Vector4(e,d,b,a)},timesVector3:function(a){return this.timesVector4(a.toVector4()).toVector3()},timesTransposeVector4:function(a){var e=this.m00()*a.x+this.m10()*a.y+this.m20()*a.z+this.m30()*a.w,d=this.m01()*a.x+this.m11()*a.y+this.m21()*a.z+this.m31()*a.w,b=this.m02()*a.x+this.m12()*a.y+this.m22()*a.z+this.m32()*
a.w;a=this.m03()*a.x+this.m13()*a.y+this.m23()*a.z+this.m33()*a.w;return new phet.math.Vector4(e,d,b,a)},timesTransposeVector3:function(a){return this.timesTransposeVector4(a.toVector4()).toVector3()},timesRelativeVector3:function(a){var e=this.m00()*a.x+this.m10()*a.y+this.m20()*a.z,d=this.m01()*a.y+this.m11()*a.y+this.m21()*a.z;a=this.m02()*a.z+this.m12()*a.y+this.m22()*a.z;return new phet.math.Vector3(e,d,a)},determinant:function(){return this.m03()*this.m12()*this.m21()*this.m30()-this.m02()*
this.m13()*this.m21()*this.m30()-this.m03()*this.m11()*this.m22()*this.m30()+this.m01()*this.m13()*this.m22()*this.m30()+this.m02()*this.m11()*this.m23()*this.m30()-this.m01()*this.m12()*this.m23()*this.m30()-this.m03()*this.m12()*this.m20()*this.m31()+this.m02()*this.m13()*this.m20()*this.m31()+this.m03()*this.m10()*this.m22()*this.m31()-this.m00()*this.m13()*this.m22()*this.m31()-this.m02()*this.m10()*this.m23()*this.m31()+this.m00()*this.m12()*this.m23()*this.m31()+this.m03()*this.m11()*this.m20()*
this.m32()-this.m01()*this.m13()*this.m20()*this.m32()-this.m03()*this.m10()*this.m21()*this.m32()+this.m00()*this.m13()*this.m21()*this.m32()+this.m01()*this.m10()*this.m23()*this.m32()-this.m00()*this.m11()*this.m23()*this.m32()-this.m02()*this.m11()*this.m20()*this.m33()+this.m01()*this.m12()*this.m20()*this.m33()+this.m02()*this.m10()*this.m21()*this.m33()-this.m00()*this.m12()*this.m21()*this.m33()-this.m01()*this.m10()*this.m22()*this.m33()+this.m00()*this.m11()*this.m22()*this.m33()},toString:function(){return this.m00()+
" "+this.m01()+" "+this.m02()+" "+this.m03()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+" "+this.m13()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()+" "+this.m23()+"\n"+this.m30()+" "+this.m31()+" "+this.m32()+" "+this.m33()},translation:function(){return new phet.math.Vector3(this.m03(),this.m13(),this.m23())},scaling:function(){return new phet.math.Vector3(this.m00(),this.m11(),this.m22())},makeImmutable:function(){this.rowMajor=function(){throw Error("Cannot modify immutable matrix");}}};c.IDENTITY=
new c;c.IDENTITY.makeImmutable()})();phet=phet||{};phet.math=phet.math||{};(function(){phet.math.Ray2=function(b,a){this.pos=b;this.dir=a;phet.debugAssert(function(){return 0.01>Math.abs(a.magnitude()-1)})};var c=phet.math.Ray2;c.prototype={constructor:c,shifted:function(b){return new c(this.pointAtDistance(b),this.dir)},pointAtDistance:function(b){return this.pos.plus(this.dir.timesScalar(b))},toString:function(){return this.pos.toString()+" => "+this.dir.toString()}}})();phet=phet||{};
phet.math=phet.math||{};(function(){phet.math.Ray3=function(b,a){this.pos=b;this.dir=a};var c=phet.math.Ray3;c.prototype={constructor:c,shifted:function(b){return new c(this.pointAtDistance(b),this.dir)},pointAtDistance:function(b){return this.pos.plus(this.dir.timesScalar(b))},toString:function(){return this.pos.toString()+" => "+this.dir.toString()}}})();phet=phet||{};phet.math=phet.math||{};
(function(){var c=phet.math.Matrix3,b=phet.math.Vector2;phet.math.Transform3=function(a){this.set(void 0===a?c.IDENTITY:a)};var a=phet.math.Transform3;a.prototype={constructor:a,set:function(a){this.matrix=a;this.inverseTransposed=this.matrixTransposed=this.inverse=null},prepend:function(a){this.set(a.timesMatrix(this.matrix))},append:function(a){this.set(this.matrix.timesMatrix(a))},prependTransform:function(a){this.prepend(a.matrix)},appendTransform:function(a){this.append(a.matrix)},applyToCanvasContext:function(a){a.setTransform(this.matrix.m00(),
this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m02(),this.matrix.m12())},getMatrix:function(){return this.matrix},getInverse:function(){null===this.inverse&&(this.inverse=this.matrix.inverted());return this.inverse},getMatrixTransposed:function(){null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed());return this.matrixTransposed},getInverseTransposed:function(){null===this.inverseTransposed&&(this.inverseTransposed=this.getInverse().transposed());return this.inverseTransposed},
isIdentity:function(){return this.matrix.type===c.Types.IDENTITY},transformPosition2:function(a){return this.matrix.timesVector2(a)},transformDelta2:function(a){return this.matrix.timesRelativeVector2(a)},transformNormal2:function(a){return this.getInverse().timesTransposeVector2(a)},transformDeltaX:function(a){return this.transformDelta2(new b(a,0)).x},transformDeltaY:function(a){return this.transformDelta2(new b(0,a)).y},transformBounds2:function(a){return a.transformed(this.matrix)},transformShape:function(a){return a.transformed(this.matrix)},
inversePosition2:function(a){return this.getInverse().timesVector2(a)},inverseDelta2:function(a){return this.inversePosition2(a).minus(this.inversePosition2(b.ZERO))},inverseNormal2:function(a){return this.matrix.timesTransposeVector2(a)},inverseDeltaX:function(a){return this.inverseDelta2(new b(a,0)).x},inverseDeltaY:function(a){return this.inverseDelta2(new b(0,a)).y},inverseBounds2:function(a){return a.transformed(this.getInverse())},inverseShape:function(a){return a.transformed(this.getInverse())}}})();
phet=phet||{};phet.math=phet.math||{};
(function(){var c=phet.math.Matrix4,b=phet.math.Vector3;phet.math.Transform4=function(a){this.set(void 0===a?c.IDENTITY:a)};var a=phet.math.Transform4;a.prototype={constructor:a,set:function(a){this.matrix=a;this.inverseTransposed=this.matrixTransposed=this.inverse=null},getMatrix:function(){return this.matrix},getInverse:function(){null===this.inverse&&(this.inverse=this.matrix.inverted());return this.inverse},getMatrixTransposed:function(){null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed());
return this.matrixTransposed},getInverseTransposed:function(){null===this.inverseTransposed&&(this.inverseTransposed=this.getInverse().transposed());return this.inverseTransposed},prepend:function(a){this.set(a.timesMatrix(this.matrix))},append:function(a){this.set(this.matrix.timesMatrix(a))},prependTransform:function(a){this.prepend(a.matrix)},appendTransform:function(a){this.append(a.matrix)},isIdentity:function(){return this.matrix.type===c.Types.IDENTITY},applyToCanvasContext:function(a){a.setTransform(this.matrix.m00(),
this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m03(),this.matrix.m13())},transformPosition3:function(a){return this.matrix.timesVector3(a)},transformDelta3:function(a){return this.matrix.timesRelativeVector3(a)},transformNormal3:function(a){return this.getInverse().timesTransposeVector3(a)},transformDeltaX:function(a){return this.transformDelta3(new b(a,0,0)).x},transformDeltaY:function(a){return this.transformDelta3(new b(0,a,0)).y},transformDeltaZ:function(a){return this.transformDelta3(new b(0,
0,a)).z},transformRay:function(a){return new phet.math.Ray3(this.transformPosition3(a.pos),this.transformPosition3(a.pos.plus(a.dir)).minus(this.transformPosition3(a.pos)))},inversePosition3:function(a){return this.getInverse().timesVector3(a)},inverseDelta3:function(a){return this.inversePosition3(a).minus(this.inversePosition3(b.ZERO))},inverseNormal3:function(a){return this.matrix.timesTransposeVector3(a)},inverseDeltaX:function(a){return this.inverseDelta3(new b(a,0,0)).x},inverseDeltaY:function(a){return this.inverseDelta3(new b(0,
a,0)).y},inverseDeltaZ:function(a){return this.inverseDelta3(new b(0,0,a)).z},inverseRay:function(a){return new phet.math.Ray3(this.inversePosition3(a.pos),this.inversePosition3(a.pos.plus(a.dir)).minus(this.inversePosition3(a.pos)))}}})();phet=phet||{};phet.math=phet.math||{};
(function(){function c(a,b,d){if (0===a.length)d.call(void 0,b);else for (var f=0;f<a.length;f++){var n=a[f],g=a.slice(0);g.splice(f,1);var h=b.slice(0);h.push(n);c(g,h,d)}}phet.math.Permutation=function(a){this.indices=a};var b=phet.math.Permutation;b.identity=function(a){phet.assert(0<=a);for (var e=Array(a),d=0;d<a;d++)e[d]=d;return new b(e)};b.permutations=function(a){var e=[];b.forEachPermutation(phet.util.rangeInclusive(0,a-1),function(a){e.push(new b(a))});return e};b.forEachPermutation=function(a,
b){c(a,[],b)};phet.math.Permutation.prototype={constructor:b,size:function(){return this.indices.length},apply:function(a){if (phet.util.isArray(a)){if (a.length!==this.size())throw Error("Permutation length "+this.size()+" not equal to list length "+a.length);for (var b=Array(a.length),d=0;d<a.length;d++)b[d]=a[this.indices[d]];return b}return this.indices[a]},inverted:function(){for (var a=Array(this.size()),e=0;e<this.size();e++)a[this.indices[e]]=e;return new b(a)},withIndicesPermuted:function(a){var e=
[],d=this;b.forEachPermutation(a,function(f){for (var c=d.indices,g=c.slice(0),h=0;h<a.length;h++)g[a[h]]=c[f[h]];e.push(new b(g))});return e},toString:function(){return"P["+phet.util.mkString(this.indices,", ")+"]"}};b.testMe=function(a){var e=new b([1,4,3,2,0]);a.log(e.toString());e=e.inverted();a.log(e.toString());a.log(e.withIndicesPermuted([0,3,4]).toString());a.log(b.permutations(4).toString())}})();phet=phet||{};phet.math=phet.math||{};
(function(){phet.math.Matrix=function(b,a,e,d){this.m=b;this.n=a;this.size=b*=a;if (d)this.entries=e;else if (e||(e=0),this.entries=new Float32Array(b),phet.util.isArray(e)){phet.assert(e.length===b);for (d=0;d<b;d++)this.entries[d]=e[d]}else for (d=0;d<b;d++)this.entries[d]=e};var c=phet.math.Matrix;c.hypot=function(b,a){var e;Math.abs(b)>Math.abs(a)?(e=a/b,e=Math.abs(b)*Math.sqrt(1+e*e)):0!==a?(e=b/a,e=Math.abs(a)*Math.sqrt(1+e*e)):e=0;return e};c.prototype={constructor:c,copy:function(){for (var b=
new c(this.m,this.n),a=0;a<this.size;a++)b.entries[a]=this.entries[a];return b},getArray:function(){return this.entries},getArrayCopy:function(){return new Float32Array(this.entries)},getRowDimension:function(){return this.m},getColumnDimension:function(){return this.n},index:function(b,a){return b*this.n+a},get:function(b,a){return this.entries[this.index(b,a)]},set:function(b,a,e){this.entries[this.index(b,a)]=e},getMatrix:function(b,a,e,d){for (var f=new c(a-b+1,d-e+1),n=b;n<=a;n++)for (var g=e;g<=
d;g++)f.entries[f.index(n-b,g-e)]=this.entries[this.index(n,g)];return f},getArrayRowMatrix:function(b,a,e){for (var d=new c(b.length,e-a+1),f=0;f<b.length;f++)for (var n=a;n<=e;n++)d.entries[d.index(f,n-a)]=this.entries[this.index(b[f],n)];return d},transpose:function(){for (var b=new c(this.n,this.m),a=0;a<this.m;a++)for (var e=0;e<this.n;e++)b.entries[b.index(e,a)]=this.entries[this.index(a,e)];return b},norm1:function(){for (var b=0,a=0;a<this.n;a++){for (var e=0,d=0;d<this.m;d++)e+=Math.abs(this.entries[this.index(d,
a)]);b=Math.max(b,e)}return b},norm2:function(){return(new phet.math.SingularValueDecomposition(this)).norm2()},normInf:function(){for (var b=0,a=0;a<this.m;a++){for (var e=0,d=0;d<this.n;d++)e+=Math.abs(this.entries[this.index(a,d)]);b=Math.max(b,e)}return b},normF:function(){for (var b=0,a=0;a<this.m;a++)for (var e=0;e<this.n;e++)b=c.hypot(b,this.entries[this.index(a,e)]);return b},uminus:function(){for (var b=new c(this.m,this.n),a=0;a<this.m;a++)for (var e=0;e<this.n;e++)b.entries[b.index(a,e)]=-this.entries[this.index(a,
e)];return b},plus:function(b){this.checkMatrixDimensions(b);for (var a=new c(this.m,this.n),e=0;e<this.m;e++)for (var d=0;d<this.n;d++){var f=a.index(e,d);a.entries[f]=this.entries[f]+b.entries[f]}return a},plusEquals:function(b){this.checkMatrixDimensions(b);for (var a=new c(this.m,this.n),e=0;e<this.m;e++)for (var d=0;d<this.n;d++){var f=a.index(e,d);this.entries[f]+=b.entries[f]}return this},minus:function(b){this.checkMatrixDimensions(b);for (var a=new c(this.m,this.n),e=0;e<this.m;e++)for (var d=
0;d<this.n;d++){var f=this.index(e,d);a.entries[f]=this.entries[f]-b.entries[f]}return a},minusEquals:function(b){this.checkMatrixDimensions(b);for (var a=0;a<this.m;a++)for (var e=0;e<this.n;e++){var d=this.index(a,e);this.entries[d]-=b.entries[d]}return this},arrayTimes:function(b){this.checkMatrixDimensions(b);for (var a=new c(this.m,this.n),e=0;e<this.m;e++)for (var d=0;d<this.n;d++){var f=a.index(e,d);a.entries[f]=this.entries[f]*b.entries[f]}return a},arrayTimesEquals:function(b){this.checkMatrixDimensions(b);
for (var a=0;a<this.m;a++)for (var e=0;e<this.n;e++){var d=this.index(a,e);this.entries[d]*=b.entries[d]}return this},arrayRightDivide:function(b){this.checkMatrixDimensions(b);for (var a=new c(this.m,this.n),e=0;e<this.m;e++)for (var d=0;d<this.n;d++){var f=this.index(e,d);a.entries[f]=this.entries[f]/b.entries[f]}return a},arrayRightDivideEquals:function(b){this.checkMatrixDimensions(b);for (var a=0;a<this.m;a++)for (var e=0;e<this.n;e++){var d=this.index(a,e);this.entries[d]/=b.entries[d]}return this},
arrayLeftDivide:function(b){this.checkMatrixDimensions(b);for (var a=new c(this.m,this.n),e=0;e<this.m;e++)for (var d=0;d<this.n;d++){var f=this.index(e,d);a.entries[f]=b.entries[f]/this.entries[f]}return a},arrayLeftDivideEquals:function(b){this.checkMatrixDimensions(b);for (var a=0;a<this.m;a++)for (var e=0;e<this.n;e++){var d=this.index(a,e);this.entries[d]=b.entries[d]/this.entries[d]}return this},times:function(b){var a,e,d,f,n;if (b.isMatrix){if (b.m!==this.n)throw Error("Matrix inner dimensions must agree.");
a=new c(this.m,b.n);var g=new Float32Array(this.n);for (d=0;d<b.n;d++){for (f=0;f<this.n;f++)g[f]=b.entries[b.index(f,d)];for (e=0;e<this.m;e++){for (f=n=0;f<this.n;f++)n+=this.entries[this.index(e,f)]*g[f];a.entries[a.index(e,d)]=n}}}else{n=b;a=new c(this.m,this.n);for (e=0;e<this.m;e++)for (d=0;d<this.n;d++)a.entries[a.index(e,d)]=n*this.entries[this.index(e,d)]}return a},timesEquals:function(b){for (var a=0;a<this.m;a++)for (var e=0;e<this.n;e++){var d=this.index(a,e);this.entries[d]*=b}return this},solve:function(b){return this.m===
this.n?(new phet.math.LUDecomposition(this)).solve(b):(new phet.math.QRDecomposition(this)).solve(b)},solveTranspose:function(b){return this.transpose().solve(b.transpose())},inverse:function(){return this.solve(c.identity(this.m,this.m))},det:function(){return(new phet.math.LUDecomposition(this)).det()},rank:function(){return(new phet.math.SingularValueDecomposition(this)).rank()},cond:function(){return(new phet.math.SingularValueDecomposition(this)).cond()},trace:function(){for (var b=0,a=0;a<Math.min(this.m,
this.n);a++)b+=this.entries[this.index(a,a)];return b},checkMatrixDimensions:function(b){if (b.m!==this.m||b.n!==this.n)throw Error("Matrix dimensions must agree.");},toString:function(){var b;b=""+("dim: "+this.getRowDimension()+"x"+this.getColumnDimension()+"\n");for (var a=0;a<this.getRowDimension();a++){for (var e=0;e<this.getColumnDimension();e++)b+=this.get(a,e)+" ";b+="\n"}return b},extractVector2:function(b){phet.assert(2===this.m);return new phet.math.Vector2(this.get(0,b),this.get(1,b))},extractVector3:function(b){phet.assert(3===
this.m);return new phet.math.Vector3(this.get(0,b),this.get(1,b),this.get(2,b))},extractVector4:function(b){phet.assert(4===this.m);return new phet.math.Vector4(this.get(0,b),this.get(1,b),this.get(2,b),this.get(3,b))},isMatrix:!0};c.identity=function(b,a){for (var e=new c(b,a),d=0;d<b;d++)for (var f=0;f<a;f++)e.entries[e.index(d,f)]=d===f?1:0;return e};c.rowVector2=function(b){return new c(1,2,[b.x,b.y])};c.rowVector3=function(b){return new c(1,3,[b.x,b.y,b.z])};c.rowVector4=function(b){return new c(1,
4,[b.x,b.y,b.z,b.w])};c.rowVector=function(b){if (b.isVector2)return c.rowVector2(b);if (b.isVector3)return c.rowVector3(b);if (b.isVector4)return c.rowVector4(b);throw Error("undetected type of vector: "+b.toString());};c.columnVector2=function(b){return new c(2,1,[b.x,b.y])};c.columnVector3=function(b){return new c(3,1,[b.x,b.y,b.z])};c.columnVector4=function(b){return new c(4,1,[b.x,b.y,b.z,b.w])};c.columnVector=function(b){if (b.isVector2)return c.columnVector2(b);if (b.isVector3)return c.columnVector3(b);
if (b.isVector4)return c.columnVector4(b);throw Error("undetected type of vector: "+b.toString());};c.fromVectors2=function(b){for (var a=b.length,e=new Float32Array(2*a),d=0;d<a;d++){var f=b[d];e[d]=f.x;e[d+a]=f.y}return new c(2,a,e,!0)};c.fromVectors3=function(b){for (var a=b.length,e=new Float32Array(3*a),d=0;d<a;d++){var f=b[d];e[d]=f.x;e[d+a]=f.y;e[d+2*a]=f.z}return new c(3,a,e,!0)};c.fromVectors4=function(b){for (var a=b.length,e=new Float32Array(4*a),d=0;d<a;d++){var f=b[d];e[d]=f.x;e[d+a]=f.y;
e[d+2*a]=f.z;e[d+3*a]=f.w}return new c(4,a,e,!0)}})();phet=phet||{};phet.math=phet.math||{};
(function(){var c=phet.math.Matrix;phet.math.LUDecomposition=function(a){var b,d,f;this.matrix=a;var c=this.LU=a.getArrayCopy(),g=this.m=a.getRowDimension(),h=this.n=a.getColumnDimension();this.piv=new Uint32Array(g);for (b=0;b<g;b++)this.piv[b]=b;this.pivsign=1;var k=new Float32Array(g);for (d=0;d<h;d++){for (b=0;b<g;b++)k[b]=c[a.index(b,d)];for (b=0;b<g;b++){var p=Math.min(b,d),s=0;for (f=0;f<p;f++)var r=a.index(b,f),s=s+c[r]*k[f];k[b]-=s;c[a.index(b,d)]=k[b]}p=d;for (b=d+1;b<g;b++)Math.abs(k[b])>Math.abs(k[p])&&
(p=b);if (p!==d){for (f=0;f<h;f++)b=a.index(p,f),s=a.index(d,f),r=c[b],c[b]=c[s],c[s]=r;f=this.piv[p];this.piv[p]=this.piv[d];this.piv[d]=f;this.pivsign=-this.pivsign}if (d<g&&0!==c[this.matrix.index(d,d)])for (b=d+1;b<g;b++)c[a.index(b,d)]/=c[a.index(d,d)]}};var b=phet.math.LUDecomposition;b.prototype={constructor:b,isNonsingular:function(){for (var a=0;a<this.n;a++){var b=this.matrix.index(a,a);if (0===this.LU[b])return!1}return!0},getL:function(){for (var a=new c(this.m,this.n),b=0;b<this.m;b++)for (var d=
0;d<this.n;d++)b>d?a.entries[a.index(b,d)]=this.LU[this.matrix.index(b,d)]:b===d?a.entries[a.index(b,d)]=1:a.entries[a.index(b,d)]=0;return a},getU:function(){for (var a=new c(this.n,this.n),b=0;b<this.n;b++)for (var d=0;d<this.n;d++)b<=d?a.entries[a.index(b,d)]=this.LU[this.matrix.index(b,d)]:a.entries[a.index(b,d)]=0;return a},getPivot:function(){for (var a=new Uint32Array(this.m),b=0;b<this.m;b++)a[b]=this.piv[b];return a},getDoublePivot:function(){for (var a=new Float32Array(this.m),b=0;b<this.m;b++)a[b]=
this.piv[b];return a},det:function(){if (this.m!==this.n)throw Error("Matrix must be square.");for (var a=this.pivsign,b=0;b<this.n;b++)a*=this.LU[this.matrix.index(b,b)];return a},solve:function(a){var b,d;if (a.getRowDimension()!==this.m)throw Error("Matrix row dimensions must agree.");if (!this.isNonsingular())throw Error("Matrix is singular.");var f=a.getColumnDimension(),c=a.getArrayRowMatrix(this.piv,0,f-1);for (d=0;d<this.n;d++)for (a=d+1;a<this.n;a++)for (b=0;b<f;b++)c.entries[c.index(a,b)]-=c.entries[c.index(d,
b)]*this.LU[this.matrix.index(a,d)];for (d=this.n-1;0<=d;d--){for (b=0;b<f;b++)c.entries[c.index(d,b)]/=this.LU[this.matrix.index(d,d)];for (a=0;a<d;a++)for (b=0;b<f;b++)c.entries[c.index(a,b)]-=c.entries[c.index(d,b)]*this.LU[this.matrix.index(a,d)]}return c}}})();phet=phet||{};phet.math=phet.math||{};
(function(){var c=phet.math.Matrix;phet.math.QRDecomposition=function(a){this.matrix=a;var b=this.QR=a.getArrayCopy(),d=this.m=a.getRowDimension();a=this.n=a.getColumnDimension();this.Rdiag=new Float32Array(a);var f,n,g;for (g=0;g<a;g++){var h=0;for (f=g;f<d;f++)h=c.hypot(h,b[this.matrix.index(f,g)]);if (0!==h){0>b[this.matrix.index(g,g)]&&(h=-h);for (f=g;f<d;f++)b[this.matrix.index(f,g)]/=h;b[this.matrix.index(g,g)]+=1;for (n=g+1;n<a;n++){var k=0;for (f=g;f<d;f++)k+=b[this.matrix.index(f,g)]*b[this.matrix.index(f,
n)];k=-k/b[this.matrix.index(g,g)];for (f=g;f<d;f++)b[this.matrix.index(f,n)]+=k*b[this.matrix.index(f,g)]}}this.Rdiag[g]=-h}};var b=phet.math.QRDecomposition;b.prototype={constructor:b,isFullRank:function(){for (var a=0;a<this.n;a++)if (0===this.Rdiag[a])return!1;return!0},getH:function(){for (var a=new c(this.m,this.n),b=0;b<this.m;b++)for (var d=0;d<this.n;d++)b>=d?a.entries[a.index(b,d)]=this.QR[this.matrix.index(b,d)]:a.entries[a.index(b,d)]=0;return a},getR:function(){for (var a=new c(this.n,this.n),
b=0;b<this.n;b++)for (var d=0;d<this.n;d++)b<d?a.entries[a.index(b,d)]=this.QR[this.matrix.index(b,d)]:b===d?a.entries[a.index(b,d)]=this.Rdiag[b]:a.entries[a.index(b,d)]=0;return a},getQ:function(){var a,b,d,f=new c(this.m,this.n);for (d=this.n-1;0<=d;d--){for (a=0;a<this.m;a++)f.entries[f.index(a,d)]=0;f.entries[f.index(d,d)]=1;for (b=d;b<this.n;b++)if (0!==this.QR[this.matrix.index(d,d)]){var n=0;for (a=d;a<this.m;a++)n+=this.QR[this.matrix.index(a,d)]*f.entries[f.index(a,b)];n=-n/this.QR[this.matrix.index(d,
d)];for (a=d;a<this.m;a++)f.entries[f.index(a,b)]+=n*this.QR[this.matrix.index(a,d)]}}return f},solve:function(a){if (a.getRowDimension()!==this.m)throw Error("Matrix row dimensions must agree.");if (!this.isFullRank())throw Error("Matrix is rank deficient.");var b,d,f,n=a.getColumnDimension(),g=a.getArrayCopy();for (f=0;f<this.n;f++)for (d=0;d<n;d++){var h=0;for (b=f;b<this.m;b++)h+=this.QR[this.matrix.index(b,f)]*g[a.index(b,d)];h=-h/this.QR[this.matrix.index(f,f)];for (b=f;b<this.m;b++)g[a.index(b,d)]+=
h*this.QR[this.matrix.index(b,f)]}for (f=this.n-1;0<=f;f--){for (d=0;d<n;d++)g[a.index(f,d)]/=this.Rdiag[f];for (b=0;b<f;b++)for (d=0;d<n;d++)g[a.index(b,d)]-=g[a.index(f,d)]*this.QR[this.matrix.index(b,f)]}return(new c(g,this.n,n)).getMatrix(0,this.n-1,0,n-1)}}})();phet=phet||{};phet.math=phet.math||{};
(function(){var c=phet.math.Matrix;phet.math.SingularValueDecomposition=function(a){this.matrix=a;var b=a.getArrayCopy();this.m=a.getRowDimension();this.n=a.getColumnDimension();a=this.m;var d=this.n,f=Math.min,n=Math.max,g=Math.pow,h=Math.abs,k=f(a,d),p=this.s=new Float32Array(f(a+1,d)),s=this.U=new Float32Array(a*k),r=this.V=new Float32Array(d*d),q=new Float32Array(d),t=new Float32Array(a),j,m,l,u,v,w,y=c.hypot,x=f(a-1,d);v=n(0,f(d-2,a));for (l=0;l<n(x,v);l++){if (l<x){p[l]=0;for (j=l;j<a;j++)p[l]=
y(p[l],b[j*d+l]);if (0!==p[l]){0>b[l*d+l]&&(p[l]=-p[l]);for (j=l;j<a;j++)b[j*d+l]/=p[l];b[l*d+l]+=1}p[l]=-p[l]}for (m=l+1;m<d;m++){if (l<x&&0!==p[l]){u=0;for (j=l;j<a;j++)u+=b[j*d+l]*b[j*d+m];u=-u/b[l*d+l];for (j=l;j<a;j++)b[j*d+m]+=u*b[j*d+l]}q[m]=b[l*d+m]}if (l<x)for (j=l;j<a;j++)s[j*k+l]=b[j*d+l];if (l<v){q[l]=0;for (j=l+1;j<d;j++)q[l]=y(q[l],q[j]);if (0!==q[l]){0>q[l+1]&&(q[l]=-q[l]);for (j=l+1;j<d;j++)q[j]/=q[l];q[l+1]+=1}q[l]=-q[l];if (l+1<a&&0!==q[l]){for (j=l+1;j<a;j++)t[j]=0;for (m=l+1;m<d;m++)for (j=l+
1;j<a;j++)t[j]+=q[m]*b[j*d+m];for (m=l+1;m<d;m++){u=-q[m]/q[l+1];for (j=l+1;j<a;j++)b[j*d+m]+=u*t[j]}}for (j=l+1;j<d;j++)r[j*d+l]=q[j]}}f=f(d,a+1);x<d&&(p[x]=b[x*d+x]);a<f&&(p[f-1]=0);v+1<f&&(q[v]=b[v*d+f-1]);q[f-1]=0;for (m=x;m<k;m++){for (j=0;j<a;j++)s[j*k+m]=0;s[m*k+m]=1}for (l=x-1;0<=l;l--)if (0!==p[l]){for (m=l+1;m<k;m++){u=0;for (j=l;j<a;j++)u+=s[j*k+l]*s[j*k+m];u=-u/s[l*k+l];for (j=l;j<a;j++)s[j*k+m]+=u*s[j*k+l]}for (j=l;j<a;j++)s[j*k+l]=-s[j*k+l];s[l*k+l]=1+s[l*k+l];for (j=0;j<l-1;j++)s[j*k+l]=0}else{for (j=
0;j<a;j++)s[j*k+l]=0;s[l*k+l]=1}for (l=d-1;0<=l;l--){if (l<v&&0!==q[l])for (m=l+1;m<k;m++){u=0;for (j=l+1;j<d;j++)u+=r[j*d+l]*r[j*d+m];u=-u/r[l+1*d+l];for (j=l+1;j<d;j++)r[j*d+m]+=u*r[j*d+l]}for (j=0;j<d;j++)r[j*d+l]=0;r[l*d+l]=1}b=f-1;x=g(2,-52);for (g=g(2,-966);0<f;){for (l=f-2;-1<=l&&-1!==l;l--)if (h(q[l])<=g+x*(h(p[l])+h(p[l+1]))){q[l]=0;break}if (l===f-2)u=4;else{for (j=f-1;j>=l&&j!==l;j--)if (u=(j!==f?h(q[j]):0)+(j!==l+1?h(q[j-1]):0),h(p[j])<=g+x*u){p[j]=0;break}j===l?u=3:j===f-1?u=1:(u=2,l=j)}l++;switch(u){case 1:v=
q[f-2];q[f-2]=0;for (m=f-2;m>=l;m--){u=y(p[m],v);t=p[m]/u;w=v/u;p[m]=u;m!==l&&(v=-w*q[m-1],q[m-1]*=t);for (j=0;j<d;j++)u=t*r[j*d+m]+w*r[j*d+f-1],r[j*d+f-1]=-w*r[j*d+m]+t*r[j*d+f-1],r[j*d+m]=u}break;case 2:v=q[l-1];q[l-1]=0;for (m=l;m<f;m++){u=y(p[m],v);t=p[m]/u;w=v/u;p[m]=u;v=-w*q[m];q[m]*=t;for (j=0;j<a;j++)u=t*s[j*k+m]+w*s[j*k+l-1],s[j*k+l-1]=-w*s[j*k+m]+t*s[j*k+l-1],s[j*k+m]=u}break;case 3:m=n(n(n(n(h(p[f-1]),h(p[f-2])),h(q[f-2])),h(p[l])),h(q[l]));j=p[f-1]/m;t=p[f-2]/m;v=q[f-2]/m;u=p[l]/m;m=q[l]/
m;t=((t+j)*(t-j)+v*v)/2;v=j*v*j*v;w=0;if (0!==t||0!==v)w=Math.sqrt(t*t+v),0>t&&(w=-w),w=v/(t+w);v=(u+j)*(u-j)+w;var z=u*m;for (m=l;m<f-1;m++){u=y(v,z);t=v/u;w=z/u;m!==l&&(q[m-1]=u);v=t*p[m]+w*q[m];q[m]=t*q[m]-w*p[m];z=w*p[m+1];p[m+1]*=t;for (j=0;j<d;j++)u=t*r[j*d+m]+w*r[j*d+m+1],r[j*d+m+1]=-w*r[j*d+m]+t*r[j*d+m+1],r[j*d+m]=u;u=y(v,z);t=v/u;w=z/u;p[m]=u;v=t*q[m]+w*p[m+1];p[m+1]=-w*q[m]+t*p[m+1];z=w*q[m+1];q[m+1]*=t;if (m<a-1)for (j=0;j<a;j++)u=t*s[j*k+m]+w*s[j*k+m+1],s[j*k+m+1]=-w*s[j*k+m]+t*s[j*k+m+1],
s[j*k+m]=u}q[f-2]=v;break;case 4:if (0>=p[l]){p[l]=0>p[l]?-p[l]:0;for (j=0;j<=b;j++)r[j*d+l]=-r[j*d+l]}for (;l<b&&!(p[l]>=p[l+1]);){u=p[l];p[l]=p[l+1];p[l+1]=u;if (l<d-1)for (j=0;j<d;j++)u=r[j*d+l+1],r[j*d+l+1]=r[j*d+l],r[j*d+l]=u;if (l<a-1)for (j=0;j<a;j++)u=s[j*k+l+1],s[j*k+l+1]=s[j*k+l],s[j*k+l]=u;l++}f--}}};var b=phet.math.SingularValueDecomposition;b.prototype={constructor:b,getU:function(){return new c(this.m,Math.min(this.m+1,this.n),this.U,!0)},getV:function(){return new c(this.n,this.n,this.V,!0)},
getSingularValues:function(){return this.s},getS:function(){for (var a=new c(this.n,this.n),b=0;b<this.n;b++){for (var d=0;d<this.n;d++)a.entries[a.index(b,d)]=0;a.entries[a.index(b,b)]=this.s[b]}return a},norm2:function(){return this.s[0]},cond:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},rank:function(){for (var a=Math.pow(2,-23),a=Math.max(this.m,this.n)*this.s[0]*a,b=0,d=0;d<this.s.length;d++)this.s[d]>a&&b++;return b}}})();phet=phet||{};phet.math=phet.math||{};
(function(){var c=phet.math.Matrix4;phet.math.StageCenteringCanvasTransform=function(a,b){this.canvasSizeProperty=a;this.stageSize=b;this.transform=new phet.model.Property(null);var d=this;a.addObserver(function(){d.updateTransform()},!0)};var b=phet.math.StageCenteringCanvasTransform;b.fieldOfViewYFactor=function(a,b){var d=a.width/b.width,f=a.height/b.height;return 0===d||0===f?1:f>d?f/d:1};b.compute=function(a,b){var d=a.width/b.width,f=a.height/b.height,d=d<f?d:f,d=0>=d?1:d;return c.translation(a.width/
2-d*b.width/2,a.height/2-d*b.height/2).timesMatrix(c.scaling(d))};b.prototype={constructor:b,fieldOfViewYFactor:function(){return b.fieldOfViewYFactor(this.canvasSizeProperty.get(),this.stageSize)},updateTransform:function(){var a=b.compute(this.canvasSizeProperty.get(),this.stageSize);this.transform.set(new phet.math.Transform4(a))}}})();phet=phet||{};phet.math=phet.math||{};
(function(){phet.math.Dimension2=function(b,a){this.width=b;this.height=a};var c=phet.math.Dimension2;c.prototype={constructor:c,toString:function(){return"["+this.width+"w, "+this.height+"h]"},equals:function(b){return this.width===b.width&&this.height===b.height}}})();phet=phet||{};phet.math=phet.math||{};
(function(){var c=phet.math.Vector2;phet.math.Bounds2=function(a,b,d,f){this.minX=a;this.minY=b;this.maxX=d;this.maxY=f};var b=phet.math.Bounds2;b.prototype={constructor:b,width:function(){return this.maxX-this.minX},height:function(){return this.maxY-this.minY},x:function(){return this.minX},y:function(){return this.minY},centerX:function(){return(this.maxX+this.minX)/2},centerY:function(){return(this.maxY+this.minY)/2},isEmpty:function(){return 0>=this.width()||0>=this.height()},union:function(a){return new b(Math.min(this.minX,
a.minX),Math.min(this.minY,a.minY),Math.max(this.maxX,a.maxX),Math.max(this.maxY,a.maxY))},intersection:function(a){return new b(Math.max(this.minX,a.minX),Math.max(this.minY,a.minY),Math.min(this.maxX,a.maxX),Math.min(this.maxY,a.maxY))},withPoint:function(a){return new b(Math.min(this.minX,a.x),Math.min(this.minY,a.y),Math.max(this.maxX,a.x),Math.max(this.maxY,a.y))},withMinX:function(a){return new b(a,this.minY,this.maxX,this.maxY)},withMinY:function(a){return new b(this.minX,a,this.maxX,this.maxY)},
withMaxX:function(a){return new b(this.minX,this.minY,a,this.maxY)},withMaxY:function(a){return new b(this.minX,this.minY,this.maxX,a)},roundedOut:function(){return new b(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundedIn:function(){return new b(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},containsPoint:function(a){return this.minX<=a.x&&a.x<=this.maxX&&this.minY<=a.y&&a.y<=this.maxY},containsBounds:function(a){return this.minX<=
a.minX&&this.maxX>=a.maxX&&this.minY<=a.minY&&this.maxY>=a.maxY},intersectsBounds:function(a){return!this.intersection(a).isEmpty()},transformed:function(a){if (this.isEmpty())return b.NOTHING;var e=b.NOTHING,e=e.withPoint(a.timesVector2(new c(this.minX,this.minY))),e=e.withPoint(a.timesVector2(new c(this.minX,this.maxY))),e=e.withPoint(a.timesVector2(new c(this.maxX,this.minY)));return e=e.withPoint(a.timesVector2(new c(this.maxX,this.maxY)))},dilated:function(a){return new b(this.minX-a,this.minY-
a,this.maxX+a,this.maxY+a)},eroded:function(a){return this.dilated(-a)},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+")]"},equals:function(a){return this.minX===a.minX&&this.minY===a.minY&&this.maxX===a.maxX&&this.maxY===a.maxY}};b.EVERYTHING=new b(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);b.NOTHING=new b(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY)})();
phet=phet||{};phet.ui=phet.ui||{};
(function(){phet.ui.Color=function(b,a,c,d){this.a=void 0===d?255:d;void 0===a||void 0===c?(this.r=b>>16&&255,this.g=b>>8&&255,this.b=b>>0&&255):(this.r=b,this.g=a,this.b=c)};var c=phet.ui.Color;c.BLACK=new c(0,0,0);c.BLUE=new c(0,0,255);c.CYAN=new c(0,255,255);c.DARK_GRAY=new c(64,64,64);c.GRAY=new c(128,128,128);c.GREEN=new c(0,255,0);c.LIGHT_GRAY=new c(192,192,192);c.MAGENTA=new c(255,0,255);c.ORANGE=new c(255,200,0);c.PINK=new c(255,175,175);c.RED=new c(255,0,0);c.WHITE=new c(255,255,255);c.YELLOW=
new c(255,255,0)})();phet=phet||{};phet.webgl=phet.webgl||{};
(function(){phet.webgl.getShaderFromDOM=function(c,b){var a=document.getElementById(b);if (!a)throw Error("shader DOM not found: for id="+b);for (var e="",d=a.firstChild;d;)3===d.nodeType&&(e+=d.textContent),d=d.nextSibling;if ("x-shader/x-fragment"===a.type)a=c.createShader(c.FRAGMENT_SHADER);else if ("x-shader/x-vertex"===a.type)a=c.createShader(c.VERTEX_SHADER);else throw Error("shader DOM type not recognized: "+a.type);c.shaderSource(a,e);c.compileShader(a);if (!c.getShaderParameter(a,c.COMPILE_STATUS))throw Error(c.getShaderInfoLog(a));
return a};phet.webgl.initWebGL=function(c){var b=null;try{b=c.getContext("webgl")||c.getContext("experimental-webgl")}catch(a){}if (!b)throw Error("Unable to initialize WebGL. Your browser may not support it.");return b}})();phet=phet||{};phet.webgl=phet.webgl||{};
(function(){phet.webgl.GLNode=function(){this.parent=null;this.children=[];this.visible=!0;this.transform=new phet.math.Transform4;this.wrappers=[]};var c=phet.webgl.GLNode,b=phet.math.Matrix4;c.RenderState=function(){this.transform=new phet.math.Transform4;this.textureCoordinateAttribute=this.normalAttribute=this.positionAttribute=this.inverseTransposeAttribute=this.transformAttribute=null};c.prototype={constructor:c,render:function(a){this.transform.isIdentity()||a.transform.append(this.transform.getMatrix());
this.preRender(a);this.renderSelf(a);this.renderChildren(a);this.postRender(a);this.transform.isIdentity()||a.transform.append(this.transform.getInverse())},renderSelf:function(){},renderChildren:function(a){for (var b=0;b<this.children.length;b++)this.children[b].render(a)},preRender:function(a){for (var b=0;b<this.wrappers.length;b++)this.wrappers[b].preRender(a)},postRender:function(a){for (var b=0;b<this.wrappers.length;b++)this.wrappers[b].postRender(a)},addChild:function(a){phet.assert(null!==
a&&void 0!==a);this.isChild(a)||(null!==a.parent&&a.parent.removeChild(a),a.parent=this,this.children.push(a))},removeChild:function(a){phet.assert(this.isChild(a));a.parent=null;this.children.splice(this.children.indexOf(a),1)},hasParent:function(){return null!==this.parent&&void 0!==this.parent},detach:function(){this.hasParent()&&this.parent.removeChild(this)},isChild:function(a){phet.assert(a.parent===this===(-1!==this.children.indexOf(a)));return a.parent===this},translate:function(a,c,d){this.transform.append(b.translation(a,
c,d))},scale:function(a,c,d){this.transform.append(b.scaling(a,c,d))},rotate:function(a,c){this.transform.append(b.rotationAxisAngle(a,c))}}})();phet=phet||{};phet.webgl=phet.webgl||{};
(function(){phet.webgl.Quad=function(b,a,c,d,f){phet.webgl.GLNode.call(this);this.gl=b;this.width=a||1;this.height=c||1;this.xOffset=d||1;this.yOffset=f||1;this.setupBuffers()};var c=phet.webgl.Quad;c.prototype=Object.create(phet.webgl.GLNode.prototype);c.prototype.constructor=c;c.prototype.setupBuffers=function(){var b=this.gl;this.positionBuffer=b.createBuffer();this.normalBuffer=b.createBuffer();this.indexBuffer=b.createBuffer();this.textureBuffer=b.createBuffer();var a=this.width,c=this.height,
d=this.xOffset,f=this.yOffset,a=[d,f,0,d+a,f,0,d+a,f+c,0,d,f+c,0],c=[0,0,1,0,0,1,0,0,1,0,0,1],d=[0,1,2,0,2,3],f=[0,0,1,0,1,1,0,1];b.bindBuffer(b.ARRAY_BUFFER,this.normalBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(c),b.STATIC_DRAW);this.normalBuffer.itemSize=3;this.normalBuffer.numItems=c.length/3;b.bindBuffer(b.ARRAY_BUFFER,this.textureBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(f),b.STATIC_DRAW);this.textureBuffer.itemSize=2;this.textureBuffer.numItems=f.length/2;b.bindBuffer(b.ARRAY_BUFFER,
this.positionBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(a),b.STATIC_DRAW);this.positionBuffer.itemSize=3;this.positionBuffer.numItems=a.length/3;b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),b.STREAM_DRAW);this.indexBuffer.itemSize=3;this.indexBuffer.numItems=d.length};c.prototype.renderSelf=function(b){var a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,this.positionBuffer);a.vertexAttribPointer(b.positionAttribute,this.positionBuffer.itemSize,
a.FLOAT,!1,0,0);null!==b.textureCoordinateAttribute&&(a.bindBuffer(a.ARRAY_BUFFER,this.textureBuffer),a.vertexAttribPointer(b.textureCoordinateAttribute,this.textureBuffer.itemSize,a.FLOAT,!1,0,0));null!==b.normalAttribute&&(a.bindBuffer(a.ARRAY_BUFFER,this.normalBuffer),a.vertexAttribPointer(b.normalAttribute,this.normalBuffer.itemSize,a.FLOAT,!1,0,0));null!==b.transformAttribute&&a.uniformMatrix4fv(b.transformAttribute,!1,b.transform.getMatrix().entries);null!==b.inverseTransposeAttribute&&a.uniformMatrix4fv(b.inverseTransposeAttribute,
!1,b.transform.getInverseTransposed().entries);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.drawElements(a.TRIANGLES,this.indexBuffer.numItems,a.UNSIGNED_SHORT,0)}})();phet=phet||{};phet.webgl=phet.webgl||{};
(function(){phet.webgl.Sphere=function(b,a,c,d){phet.webgl.GLNode.call(this);this.gl=b;this.radius=a;this.latitudeStrips=c||10;this.longitudeStrips=d||10;this.setupBuffers()};var c=phet.webgl.Sphere;c.prototype=Object.create(phet.webgl.GLNode.prototype);c.prototype.constructor=c;c.prototype.setupBuffers=function(){var b=this.gl;this.positionBuffer=b.createBuffer();this.normalBuffer=b.createBuffer();this.indexBuffer=b.createBuffer();this.textureBuffer=b.createBuffer();for (var a=[],c=[],d=[],f=[],n=
this.latitudeStrips+1,g=this.longitudeStrips,h,k=0;k<n;k++){var p=k/(n-1);h=(p-0.5)*Math.PI;var s=Math.cos(h),r=Math.sin(h);for (h=0;h<=g;h++){var q=h/g,t=2*q*Math.PI,j=Math.cos(t),m=Math.sin(t),t=m*s,m=m*r;a.push(t*this.radius);a.push(m*this.radius);a.push(j*this.radius);c.push(t);c.push(m);c.push(j);f.push(q);f.push(p)}if (0<k){p=(k-1)*(g+1);s=k*(g+1);for (h=1;h<=g;h++)d.push(p+h-1),d.push(s+h-1),d.push(s+h),d.push(p+h-1),d.push(s+h),d.push(p+h)}}b.bindBuffer(b.ARRAY_BUFFER,this.normalBuffer);b.bufferData(b.ARRAY_BUFFER,
new Float32Array(c),b.STATIC_DRAW);this.normalBuffer.itemSize=3;this.normalBuffer.numItems=c.length/3;b.bindBuffer(b.ARRAY_BUFFER,this.textureBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(f),b.STATIC_DRAW);this.textureBuffer.itemSize=2;this.textureBuffer.numItems=f.length/2;b.bindBuffer(b.ARRAY_BUFFER,this.positionBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(a),b.STATIC_DRAW);this.positionBuffer.itemSize=3;this.positionBuffer.numItems=a.length/3;b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,
this.indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),b.STREAM_DRAW);this.indexBuffer.itemSize=3;this.indexBuffer.numItems=d.length};c.prototype.renderSelf=function(b){var a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,this.positionBuffer);a.vertexAttribPointer(b.positionAttribute,this.positionBuffer.itemSize,a.FLOAT,!1,0,0);null!==b.textureCoordinateAttribute&&(a.bindBuffer(a.ARRAY_BUFFER,this.textureBuffer),a.vertexAttribPointer(b.textureCoordinateAttribute,this.textureBuffer.itemSize,
a.FLOAT,!1,0,0));null!==b.normalAttribute&&(a.bindBuffer(a.ARRAY_BUFFER,this.normalBuffer),a.vertexAttribPointer(b.normalAttribute,this.normalBuffer.itemSize,a.FLOAT,!1,0,0));null!==b.transformAttribute&&a.uniformMatrix4fv(b.transformAttribute,!1,b.transform.getMatrix().entries);null!==b.inverseTransposeAttribute&&a.uniformMatrix4fv(b.inverseTransposeAttribute,!1,b.transform.getInverseTransposed().entries);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.drawElements(a.TRIANGLES,this.indexBuffer.numItems,
a.UNSIGNED_SHORT,0)};c.prototype.intersect=function(b,a){a=void 0===a?1E-5:a;var c=new phet.math.Vector3,d=b.dir,f=b.pos,n=f.minus(c),g=d.dot(n),n=n.magnitudeSquared(),g=4*g*g-4*(n-this.radius*this.radius);if (g<a)return null;f=d.dot(c)-d.dot(f);g=Math.sqrt(g)/2;d=f-g;f+=g;if (f<a)return null;g=b.pointAtDistance(f);n=g.minus(c).normalized();if (d<a)return{distance:f,hitPoint:g,normal:n.negated(),fromOutside:!1};f=b.pointAtDistance(d);c=f.minus(c).normalized();return{distance:d,hitPoint:f,normal:c,fromOutside:!0}}})();
phet=phet||{};phet.webgl=phet.webgl||{};
(function(){phet.webgl.Cylinder=function(b,a,c,d,f){phet.webgl.GLNode.call(this);this.gl=b;this.radius=a;this.length=c;this.radialStrips=d||16;this.axisStrips=f||1;this.setupBuffers()};var c=phet.webgl.Cylinder;c.prototype=Object.create(phet.webgl.GLNode.prototype);c.prototype.constructor=c;c.prototype.setupBuffers=function(){var b=this.gl;this.positionBuffer=b.createBuffer();this.normalBuffer=b.createBuffer();this.indexBuffer=b.createBuffer();this.textureBuffer=b.createBuffer();for (var a=[],c=[],
d=[],f=[],n=this.radialStrips+1,g=this.axisStrips+1,h=0;h<n;h++)for (var k=h/(n-1),p=2*k*Math.PI,s=Math.cos(p),p=Math.sin(p),r=0;r<g;r++){var q=r/(g-1),t=(q-0.5)*this.length;a.push(s*this.radius);a.push(p*this.radius);a.push(t);c.push(s);c.push(p);c.push(0);f.push(k);f.push(q);0<h&&0<r&&(q=(h-1)*g,t=h*g,d.push(q+r-1),d.push(t+r-1),d.push(t+r),d.push(q+r-1),d.push(t+r),d.push(q+r))}b.bindBuffer(b.ARRAY_BUFFER,this.normalBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(c),b.STATIC_DRAW);this.normalBuffer.itemSize=
3;this.normalBuffer.numItems=c.length/3;b.bindBuffer(b.ARRAY_BUFFER,this.textureBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(f),b.STATIC_DRAW);this.textureBuffer.itemSize=2;this.textureBuffer.numItems=f.length/2;b.bindBuffer(b.ARRAY_BUFFER,this.positionBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(a),b.STATIC_DRAW);this.positionBuffer.itemSize=3;this.positionBuffer.numItems=a.length/3;b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),
b.STREAM_DRAW);this.indexBuffer.itemSize=3;this.indexBuffer.numItems=d.length};c.prototype.renderSelf=function(b){var a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,this.positionBuffer);a.vertexAttribPointer(b.positionAttribute,this.positionBuffer.itemSize,a.FLOAT,!1,0,0);null!==b.textureCoordinateAttribute&&(a.bindBuffer(a.ARRAY_BUFFER,this.textureBuffer),a.vertexAttribPointer(b.textureCoordinateAttribute,this.textureBuffer.itemSize,a.FLOAT,!1,0,0));null!==b.normalAttribute&&(a.bindBuffer(a.ARRAY_BUFFER,
this.normalBuffer),a.vertexAttribPointer(b.normalAttribute,this.normalBuffer.itemSize,a.FLOAT,!1,0,0));null!==b.transformAttribute&&a.uniformMatrix4fv(b.transformAttribute,!1,b.transform.getMatrix().entries);null!==b.inverseTransposeAttribute&&a.uniformMatrix4fv(b.inverseTransposeAttribute,!1,b.transform.getInverseTransposed().entries);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.drawElements(a.TRIANGLES,this.indexBuffer.numItems,a.UNSIGNED_SHORT,0)}})();phet=phet||{};
phet.canvas=phet.canvas||{};(function(){phet.canvas.initCanvas=function(c){var b=null;try{b=c.getContext("2d")}catch(a){}if (!b)throw Error("Unable to initialize HTML5 canvas. Your browser may not support it.");return b};phet.canvas.backingScale=function(c){return"devicePixelRatio"in window&&1<window.devicePixelRatio&&2>c.webkitBackingStorePixelRatio?window.devicePixelRatio:1}})();phet=phet||{};scenery=scenery||{};
(function(){var c=!1,b=phet.math.Matrix3,a=phet.math.Transform3,e=phet.math.Bounds2,d=phet.math.Vector2;scenery.canvasTextBoundsAccurate=function(a,d){phet.assert(void 0!==d);return scenery.canvasAccurateBounds(function(b){b.font=d.font;b.textAlign=d.textAlign;b.textBaseline=d.textBaseline;b.direction=d.direction;b.fillText(a,0,0)})};scenery.scanBounds=function(a,b,c){for (var h=_.map(_.range(b),function(){return!1}),k=_.map(_.range(b),function(){return!1}),p=0;p<b;p++)for (var s=0;s<b;s++){var r=
4*(s*b+p);if (0!==a.data[r]||0!==a.data[r+1]||0!==a.data[r+2]||0!==a.data[r+3])h[p]=!0,k[s]=!0}a=_.indexOf(h,!0);h=_.lastIndexOf(h,!0);p=_.indexOf(k,!0);k=_.lastIndexOf(k,!0);s=b/16;return{minBounds:new e(1>a||a>=b-1?Number.POSITIVE_INFINITY:c.inversePosition2(new d(a+1+s,0)).x,1>p||p>=b-1?Number.POSITIVE_INFINITY:c.inversePosition2(new d(0,p+1+s)).y,1>h||h>=b-1?Number.NEGATIVE_INFINITY:c.inversePosition2(new d(h-s,0)).x,1>k||k>=b-1?Number.NEGATIVE_INFINITY:c.inversePosition2(new d(0,k-s)).y),maxBounds:new e(1>
a||a>=b-1?Number.NEGATIVE_INFINITY:c.inversePosition2(new d(a-1-s,0)).x,1>p||p>=b-1?Number.NEGATIVE_INFINITY:c.inversePosition2(new d(0,p-1-s)).y,1>h||h>=b-1?Number.POSITIVE_INFINITY:c.inversePosition2(new d(h+2+s,0)).x,1>k||k>=b-1?Number.POSITIVE_INFINITY:c.inversePosition2(new d(0,k+2+s)).y)}};scenery.canvasAccurateBounds=function(f,n){function g(a){j.save();a.matrix.canvasSetTransform(j);f(j);j.restore();var d=j.getImageData(0,0,p,p);a=scenery.scanBounds(d,p,a);if (c){var b=document.createElement("canvas");
b.width=p;b.height=p;phet.canvas.initCanvas(b).putImageData(d,0,0);$(b).css("border","1px solid black");$(window).ready(function(){$("#display").append(b)})}j.clearRect(0,0,p,p);return a}function h(d){var f=(p-4)/(d.maxX-d.minX),c=(p-4)/(d.maxY-d.minY);return new a(b.translation(-f*d.minX+2,-c*d.minY+2).timesMatrix(b.scaling(f,c)))}var k=n&&n.precision?n.precision:0.001,p=n&&n.resolution?n.resolution:128,s=n&&n.initialScale?n.initialScale:0.0625,r=e.NOTHING,q=e.EVERYTHING,t=document.createElement("canvas");
t.width=p;t.height=p;var j=phet.canvas.initCanvas(t);c&&$(window).ready(function(){var a=document.createElement("h2");$(a).text("Bounds Scan");$("#display").append(a)});t=new a;t.append(b.translation(p/2,p/2));t.append(b.scaling(s));for (var s=g(t),r=r.union(s.minBounds),q=q.intersection(s.maxBounds),m,s=q.minY,t=q.maxY;isFinite(r.minX)&&isFinite(q.minX)&&Math.abs(r.minX-q.minX)>k;){m=g(h(new e(q.minX,s,r.minX,t)));if (r.minX<=m.minBounds.minX&&q.minX>=m.maxBounds.minX){c&&(console.log("warning, exiting infinite loop!"),
console.log('transformed "min" minX: '+h(new e(q.minX,q.minY,r.minX,q.maxY)).transformPosition2(new d(r.minX,0))),console.log('transformed "max" minX: '+h(new e(q.minX,q.minY,r.minX,q.maxY)).transformPosition2(new d(q.minX,0))));break}r=r.withMinX(Math.min(r.minX,m.minBounds.minX));q=q.withMinX(Math.max(q.minX,m.maxBounds.minX));s=Math.max(s,m.maxBounds.minY);t=Math.min(t,m.maxBounds.maxY)}s=q.minY;for (t=q.maxY;isFinite(r.maxX)&&isFinite(q.maxX)&&Math.abs(r.maxX-q.maxX)>k;){m=g(h(new e(r.maxX,s,q.maxX,
t)));if (r.maxX>=m.minBounds.maxX&&q.maxX<=m.maxBounds.maxX){c&&console.log("warning, exiting infinite loop!");break}r=r.withMaxX(Math.max(r.maxX,m.minBounds.maxX));q=q.withMaxX(Math.min(q.maxX,m.maxBounds.maxX));s=Math.max(s,m.maxBounds.minY);t=Math.min(t,m.maxBounds.maxY)}s=q.minX;for (t=q.maxX;isFinite(r.minY)&&isFinite(q.minY)&&Math.abs(r.minY-q.minY)>k;){m=g(h(new e(s,q.minY,t,r.minY)));if (r.minY<=m.minBounds.minY&&q.minY>=m.maxBounds.minY){c&&console.log("warning, exiting infinite loop!");break}r=
r.withMinY(Math.min(r.minY,m.minBounds.minY));q=q.withMinY(Math.max(q.minY,m.maxBounds.minY));s=Math.max(s,m.maxBounds.minX);t=Math.min(t,m.maxBounds.maxX)}s=q.minX;for (t=q.maxX;isFinite(r.maxY)&&isFinite(q.maxY)&&Math.abs(r.maxY-q.maxY)>k;){m=g(h(new e(s,r.maxY,t,q.maxY)));if (r.maxY>=m.minBounds.maxY&&q.maxY<=m.maxBounds.maxY){c&&console.log("warning, exiting infinite loop!");break}r=r.withMaxY(Math.max(r.maxY,m.minBounds.maxY));q=q.withMaxY(Math.min(q.maxY,m.maxBounds.maxY));s=Math.max(s,m.maxBounds.minX);
t=Math.min(t,m.maxBounds.maxX)}c&&(console.log("minBounds: "+r),console.log("maxBounds: "+q));k=new e((r.minX+q.minX)/2,(r.minY+q.minY)/2,(r.maxX+q.maxX)/2,(r.maxY+q.maxY)/2);k.minBounds=r;k.maxBounds=q;k.isConsistent=q.containsBounds(r);k.precision=Math.max(Math.abs(r.minX-q.minX),Math.abs(r.minY-q.minY),Math.abs(r.maxX-q.maxX),Math.abs(r.maxY-q.maxY));return k}})();phet=phet||{};scenery=scenery||{};
(function(){function c(a,b){return new d(a,b)}function b(a,d){phet.assert(void 0!==d);return a.start.plus(a.startTangent.perpendicular().negated().times(d/2))}function a(a,d){phet.assert(void 0!==d);return a.start.plus(a.startTangent.perpendicular().times(d/2))}function e(a,d,b,f){return c(((a.x*d.y-a.y*d.x)*(b.x-f.x)-(a.x-d.x)*(b.x*f.y-b.y*f.x))/((a.x-d.x)*(b.y-f.y)-(a.y-d.y)*(b.x-f.x)),((a.x*d.y-a.y*d.x)*(b.y-f.y)-(a.y-d.y)*(b.x*f.y-b.y*f.x))/((a.x-d.x)*(b.y-f.y)-(a.y-d.y)*(b.x-f.x)))}var d=phet.math.Vector2;
scenery.Shape=function(a,d){this.pieces=[];this.subpaths=[];this.bounds=phet.math.Bounds2.NOTHING;this._strokedShape=null;this._strokedShapeComputed=!1;this._strokedShapeStyles=null;var b=this;void 0!==a&&_.each(a,function(a){b.addPiece(a)});d&&this.addPiece(new h.Close)};var f=scenery.Shape;f.prototype={constructor:f,moveTo:function(a,b){if (void 0===b&&"object"===typeof a){var f=a instanceof d?a:new d(a.x,a.y);this.addPiece(new h.MoveTo(f))}else this.addPiece(new h.MoveTo(c(a,b)));return this},
lineTo:function(a,b){if (void 0===b&&"object"===typeof a){var f=a instanceof d?a:new d(a.x,a.y);this.addPiece(new h.LineTo(f))}else this.addPiece(new h.LineTo(c(a,b)));return this},quadraticCurveTo:function(a,b,f,e){void 0===f&&"object"===typeof a?(a=a instanceof d?a:new d(a.x,a.y),b=b instanceof d?b:new d(b.x,b.y),this.addPiece(new h.QuadraticCurveTo(a,b))):this.addPiece(new h.QuadraticCurveTo(c(a,b),c(f,e)));return this},rect:function(a,b,f,e){void 0===f&&"object"===typeof a&&"object"===typeof b?
(a=a instanceof d?a:new d(a.x,a.y),b=b instanceof d?b:new d(b.x,b.y),this.addPiece(new h.Rect(a,b))):this.addPiece(new h.Rect(c(a,b),c(a+f,b+e)));return this},close:function(){this.addPiece(new h.Close)},addPiece:function(a){this.pieces.push(a);a.applyPiece(this);this.invalidate()},writeToContext:function(a){_.each(this.pieces,function(d){d.writeToContext(a)})},transformed:function(a){return new f(_.flatten(_.map(this.pieces,function(d){return d.transformed(a)}),!0))},computeBounds:function(a){return a?
this.bounds.union(this.getStrokedShape(a).bounds):this.bounds},containsPoint:function(a){var d=0,b=new phet.math.Ray2(a,c(1,0));_.each(this.subpaths,function(a){a.isDrawable()&&(_.each(a.segments,function(a){d+=a.windingIntersection(b)}),a.hasClosingSegment()&&(d+=a.getClosingSegment().windingIntersection(b)))});return 0!==d},intersectsBounds:function(a){var d=!1;_.each(this.subpaths,function(b){b.isDrawable()&&(_.each(b.segments,function(b){d=d&&b.intersectsBounds(a)}),b.hasClosingSegment()&&(d=
d&&b.getClosingSegment().intersectsBounds(a)))});return d},invalidate:function(){this._strokedShapeComputed=!1},getStrokedShape:function(d){function c(a,b,f){var n=a.plus(b.perpendicular().negated().times(j/2));a=a.plus(f.perpendicular().negated().times(j/2));if (0<b.perpendicular().dot(f))switch(d.lineJoin){case "round":throw Error("stroked round lineJoin not implemented .. add arc/arcTo");case "miter":var g=b.angleBetween(f.negated());1/Math.sin(g/2)<=d.miterLimit&&(b=e(n,n.plus(b),a,a.plus(f)),
t.addPiece(new h.LineTo(b)));t.addPiece(new h.LineTo(a));break;case "bevel":t.addPiece(new h.LineTo(a))}else n.equals(a)||t.addPiece(new h.LineTo(a))}function g(a,b){switch(d.lineCap){case "butt":t.addPiece(new h.LineTo(a.plus(b.perpendicular().times(j/2))));break;case "round":throw Error("stroked round lineCap not implemented .. add arc/arcTo");case "square":var f=b.perpendicular().negated().times(j/2),c=b.perpendicular().times(j/2),e=b.times(j/2);t.addPiece(new h.LineTo(a.plus(f).plus(e)));t.addPiece(new h.LineTo(a.plus(c).plus(e)));
t.addPiece(new h.LineTo(a.plus(c)))}}void 0===d&&(d=new n);if (this._strokedShapeComputed&&this._strokedShapeStyles.equals(d))return this._strokedShape;var q=_.filter(this.subpaths,function(a){return a.isDrawable()}),t=new f,j=d.lineWidth;_.each(q,function(d){var f,e=d.segments,p=_.last(e).end.equals(_.first(e).start),n=p?null:new k.Line(e[e.length-1].end,e[0].start);t.addPiece(new h.MoveTo(b(_.first(e),j)));for (f=0;f<e.length;f++)0<f&&c(e[f].start,e[f-1].endTangent,e[f].startTangent,!0),_.each(e[f].strokeLeft(j),
function(a){t.addPiece(a)});d.closed?p?(c(_.last(e).end,_.last(e).endTangent,_.first(e).startTangent),t.addPiece(new h.Close),t.addPiece(new h.MoveTo(a(_.first(e),j))),c(_.last(e).end,_.first(e).startTangent.negated(),_.last(e).endTangent.negated())):(c(n.start,_.last(e).endTangent,n.startTangent),_.each(n.strokeLeft(j),function(a){t.addPiece(a)}),c(n.end,n.endTangent,_.first(e).startTangent),t.addPiece(new h.Close),t.addPiece(new h.MoveTo(a(_.first(e),j))),c(n.end,_.first(e).startTangent.negated(),
n.endTangent.negated()),_.each(n.strokeRight(j),function(a){t.addPiece(a)}),c(n.start,n.startTangent.negated(),_.last(e).endTangent.negated())):g(_.last(e).end,_.last(e).endTangent);for (f=e.length-1;0<=f;f--)f<e.length-1&&c(e[f].end,e[f+1].startTangent.negated(),e[f].endTangent.negated(),!1),_.each(e[f].strokeRight(j),function(a){t.addPiece(a)});d.closed||g(_.first(e).start,_.first(e).startTangent.negated());t.addPiece(new h.Close)});this._strokedShape=t;this._strokedShapeComputed=!0;this._strokedShapeStyles=
new n(d);return t},ensure:function(a){this.hasSubpaths()||(this.addSubpath(new g),this.getLastSubpath().addPoint(a))},addSubpath:function(a){this.subpaths.push(a)},hasSubpaths:function(){return 0<this.subpaths.length},getLastSubpath:function(){return _.last(this.subpaths)}};f.rectangle=function(a,d,b,c){return(new f).rect(a,d,b,c)};f.rect=f.rectangle;f.bounds=function(a){return(new f).rect(c(a.minX,a.minY),c(a.maxX,a.maxY))};f.lineSegment=function(a,d){return(new f).moveTo(a).lineTo(d)};f.regularPolygon=
function(a,d){var b=!0;return new f(_.map(_.range(a),function(f){f=2*Math.PI*f/a;return b?(b=!1,new h.MoveTo(c(d*Math.cos(f),d*Math.sin(f)))):new h.LineTo(c(d*Math.cos(f),d*Math.sin(f)))}),!0)};f.LineStyles=function(a){void 0===a&&(a={});this.lineWidth=void 0!==a.lineWidth?a.lineWidth:1;this.lineCap=void 0!==a.lineCap?a.lineCap:"butt";this.lineJoin=void 0!==a.lineJoin?a.lineJoin:"miter";this.miterLimit=void 0!==a.miterLimit?a.miterLimit:10};var n=f.LineStyles;n.prototype={constructor:n,equals:function(a){return this.lineWidth===
a.lineWidth&&this.lineCap===a.lineCap&&this.lineJoin===a.lineJoin&&this.miterLimit===a.miterLimit}};f.Subpath=function(){this.points=[];this.segments=[];this.closed=!1};var g=f.Subpath;g.prototype={addPoint:function(a){this.points.push(a)},addSegment:function(a){this.segments.push(a)},close:function(){this.closed=!0},getFirstPoint:function(){return _.first(this.points)},getLastPoint:function(){return _.last(this.points)},isDrawable:function(){return 0<this.segments.length},isClosed:function(){return this.closed},
hasClosingSegment:function(){return!this.getFirstPoint().equals(this.getLastPoint())},getClosingSegment:function(){phet.assert(this.isClosed());return new k.Line(this.getLastPoint(),this.getFirstPoint())}};f.Piece={};var h=f.Piece;h.Close=function(){};h.Close.prototype={constructor:h.Close,writeToContext:function(a){a.closePath()},transformed:function(){return[this]},applyPiece:function(a){if (a.hasSubpaths()){var d=a.getLastSubpath(),b=new g;d.close();a.addSubpath(b);b.addPoint(d.getFirstPoint())}}};
h.MoveTo=function(a){this.point=a};h.MoveTo.prototype={constructor:h.MoveTo,writeToContext:function(a){a.moveTo(this.point.x,this.point.y)},transformed:function(a){return[new h.MoveTo(a.timesVector2(this.point))]},applyPiece:function(a){var d=new g;d.addPoint(this.point);a.addSubpath(d)}};h.LineTo=function(a){this.point=a};h.LineTo.prototype={constructor:h.LineTo,writeToContext:function(a){a.lineTo(this.point.x,this.point.y)},transformed:function(a){return[new h.LineTo(a.timesVector2(this.point))]},
applyPiece:function(a){if (a.hasSubpaths()){var d=a.getLastSubpath().getLastPoint(),b=this.point,f=new k.Line(d,b);a.getLastSubpath().addSegment(f);a.getLastSubpath().addPoint(b);a.bounds=a.bounds.withPoint(d).withPoint(b);phet.assert(!isNaN(a.bounds.x()))}else a.ensure(this.point)}};h.QuadraticCurveTo=function(a,d){this.controlPoint=a;this.point=d};h.QuadraticCurveTo.prototype={constructor:h.QuadraticCurveTo,writeToContext:function(a){a.quadraticCurveTo(this.controlPoint.x,this.controlPoint.y,this.point.x,
this.point.y)},transformed:function(a){return[new h.QuadraticCurveTo(a.timesVector2(this.controlPoint),a.timesVector2(this.point))]},applyPiece:function(a){a.ensure(this.controlPoint);var d=a.getLastSubpath().getLastPoint(),d=new k.Quadratic(d,this.controlPoint,this.point);a.getLastSubpath().addSegment(d);a.getLastSubpath().addPoint(this.point);a.bounds=a.bounds.union(d.bounds)}};h.Rect=function(a,d){this.upperLeft=a;this.lowerRight=d;this.x=this.upperLeft.x;this.y=this.upperLeft.y;this.width=this.lowerRight.x-
this.x;this.height=this.lowerRight.y-this.y};h.Rect.prototype={constructor:h.Rect,writeToContext:function(a){a.rect(this.x,this.y,this.width,this.height)},transformed:function(a){var d=a.timesVector2(c(this.x,this.y)),b=a.timesVector2(c(this.x+this.width,this.y)),f=a.timesVector2(c(this.x+this.width,this.y+this.height));a=a.timesVector2(c(this.x,this.y+this.height));return[new h.MoveTo(d),new h.LineTo(b),new h.LineTo(f),new h.LineTo(a),new h.Close,new h.MoveTo(d)]},applyPiece:function(a){var d=new g;
a.addSubpath(d);d.addPoint(c(this.x,this.y));d.addPoint(c(this.x+this.width,this.y));d.addPoint(c(this.x+this.width,this.y+this.height));d.addPoint(c(this.x,this.y+this.height));d.addSegment(new k.Line(d.points[0],d.points[1]));d.addSegment(new k.Line(d.points[1],d.points[2]));d.addSegment(new k.Line(d.points[2],d.points[3]));d.close();a.addSubpath(new g);a.getLastSubpath().addPoint(c(this.x,this.y));a.bounds=a.bounds.withPoint(this.upperLeft).withPoint(this.lowerRight);phet.assert(!isNaN(a.bounds.x()))}};
f.Segment={};var k=f.Segment;k.Line=function(a,d){this.start=a;this.end=d;this.endTangent=this.startTangent=d.minus(a).normalized();this.bounds=(new phet.math.Bounds2).withPoint(a).withPoint(d)};k.Line.prototype={constructor:k.Line,toPieces:function(){return[new h.LineTo(this.end)]},strokeLeft:function(a){return[new h.LineTo(this.end.plus(this.endTangent.perpendicular().negated().times(a/2)))]},strokeRight:function(a){return[new h.LineTo(this.start.plus(this.startTangent.perpendicular().times(a/2)))]},
intersectsBounds:function(){throw Error("Segment.Line.intersectsBounds unimplemented");},windingIntersection:function(a){var d=this.start,b=this.end,f=e(d,b,a.pos,a.pos.plus(a.dir));return!isFinite(f.x)||!isFinite(f.y)||d.x!==b.x&&(d.x>b.x?f.x>=d.x||f.x<b.x:f.x<=d.x||f.x>b.x)||d.y!==b.y&&(d.y>b.y?f.y>=d.y||f.y<b.y:f.y<=d.y||f.y>b.y)||0>f.minus(a.pos).dot(a.dir)?0:0>a.dir.perpendicular().dot(b.minus(d))?1:-1}};k.Quadratic=function(a,d,b,f){this.start=a;this.control=d;this.end=b;if (!f){f=a.equals(d);
var c=b.equals(d);phet.assert(!f||!c);this.startTangent=f?b.minus(a).normalized():d.minus(a).normalized();this.endTangent=c?b.minus(a).normalized():b.minus(d).normalized();this.bounds=new phet.math.Bounds2(Math.min(a.x,b.x),Math.min(a.y,b.y),Math.max(a.x,b.x),Math.max(a.y,b.y));f=2*(b.x-2*d.x+a.x);0!==f&&(f=-2*(d.x-a.x)/f,0<f&&1>f&&(this.bounds=this.bounds.withPoint(this.positionAt(f))));b=2*(b.y-2*d.y+a.y);0!==b&&(f=-2*(d.y-a.y)/b,0<f&&1>f&&(this.bounds=this.bounds.withPoint(this.positionAt(f))))}};
k.Quadratic.prototype={constructor:k.Quadratic,positionAt:function(a){var d=1-a;return this.start.times(d*d).plus(this.control.times(2*d*a)).plus(this.end.times(a*a))},derivativeAt:function(a){return this.control.minus(this.start).times(2*(1-a)).plus(this.end.minus(this.control).times(2*a))},offsetTo:function(a,d,b){for (var f=[this],c=0;5>c;c++)f=_.flatten(_.map(f,function(a){return a.subdivided(!0)}));f=_.map(f,function(d){return d.approximateOffset(a)});b&&(f.reverse(),f=_.map(f,function(a){return a.reversed(!0)}));
b=_.map(f,function(a){return new h.QuadraticCurveTo(a.control,a.end)});return d?[new h.MoveTo(f[0].start)].concat(b):b},subdivided:function(a){var d=this.start.plus(this.control).times(0.5),b=this.control.plus(this.end).times(0.5),f=d.plus(b).times(0.5);return[new k.Quadratic(this.start,d,f,a),new k.Quadratic(f,b,this.end,a)]},reversed:function(){return new k.Quadratic(this.end,this.control,this.start)},approximateOffset:function(a){return new k.Quadratic(this.start.plus((this.start.equals(this.control)?
this.end.minus(this.start):this.control.minus(this.start)).perpendicular().normalized().times(a)),this.control.plus(this.end.minus(this.start).perpendicular().normalized().times(a)),this.end.plus((this.end.equals(this.control)?this.end.minus(this.start):this.end.minus(this.control)).perpendicular().normalized().times(a)))},toPieces:function(){return[new h.QuadraticCurveTo(this.control,this.end)]},strokeLeft:function(a){return this.offsetTo(-a/2,!1,!1)},strokeRight:function(a){return this.offsetTo(a/
2,!1,!0)},intersectsBounds:function(){throw Error("Segment.Quadratic.intersectsBounds unimplemented");},windingIntersection:function(a){var d=phet.math.Matrix3.rotation2(-a.dir.angle());phet.assert(0.99<d.timesVector2(a.dir).x);var b=d.timesVector2(this.start),f=d.timesVector2(this.control),c=d.timesVector2(this.end),e=f.y*f.y-b.y*c.y;if (1E-8>e)return 0;d=(b.y-f.y+Math.sqrt(e))/(b.y-2*f.y+c.y);b=(b.y-f.y-Math.sqrt(e))/(b.y-2*f.y+c.y);f=this.positionAt(d).minus(a.pos);c=this.positionAt(b).minus(a.pos);
f=0<d&&0<f.dot(a.dir);c=0<b&&0<c.dot(a.dir);e=0;f&&(e+=0>a.dir.perpendicular().dot(this.derivativeAt(d))?1:-1);c&&(e+=0>a.dir.perpendicular().dot(this.derivativeAt(b))?1:-1);return e}};k.Cubic=function(a,d,b,f){this.start=a;this.control1=d;this.control2=b;this.end=f};k.Cubic.prototype={}})();phet=phet||{};scenery=scenery||{};
(function(){var c=phet.math.Bounds2,b=scenery.Shape;scenery.Node=function(a){this._visible=!0;this._clipShape=this._layerType=null;this.children=[];this.transform=new phet.math.Transform3;this.parent=null;this._isRoot=!1;this._inputListeners=[];this._includeStrokeInHitRegion=!1;this._layerReference=this._layerAfterRender=this._layerBeforeRender=null;this._hasLayerBelow=!1;this._childBounds=this._selfBounds=this._bounds=c.NOTHING;this._childBoundsDirty=this._selfBoundsDirty=this._boundsDirty=
!0;this._oldPaintMarked=this._childPaintDirty=this._paintDirty=!1;this._fill=this._stroke=this._shape=null;this._lineDrawingStyles=new b.LineStyles;a&&this.mutate(a)};var a=scenery.Node,e=phet.math.Matrix3;a.prototype={constructor:a,renderSelf:function(a){if (this.hasShape())if (a.isCanvasState()){a=a.layer;var b=a.context;b.beginPath();this._shape.writeToContext(b);this._fill&&(a.setFillStyle(this._fill),b.fill());this._stroke&&(a.setStrokeStyle(this._stroke),a.setLineWidth(this.getLineWidth()),
a.setLineCap(this.getLineCap()),a.setLineJoin(this.getLineJoin()),b.stroke())}else throw Error("layer type shape rendering not implemented");},enterState:function(a){this._layerBeforeRender&&a.switchToLayer(this._layerBeforeRender);this.transform.isIdentity()||a.applyTransformationMatrix(this.transform.getMatrix());this._clipShape&&a.pushClipShape(this._clipShape)},exitState:function(a){this._clipShape&&a.popClipShape();this.transform.isIdentity()||a.applyTransformationMatrix(this.transform.getInverse());
this._layerAfterRender&&a.switchToLayer(this._layerAfterRender)},insertChild:function(a,b){phet.assert(null!==a&&void 0!==a);if (!this.isChild(a)){null!==a.parent&&a.parent.removeChild(a);a.parent=this;this.children.splice(b,0,a);a.invalidateBounds();a.invalidatePaint();if (a._hasLayerBelow||a.isLayerRoot()){for (var c=this;null!==c&&!c._hasLayerBelow;)c._hasLayerBelow=!0,c=c.parent;this.markLayerRefreshNeeded()}if (!this._hasLayerBelow&&this.isRooted()&&a._layerReference!==this._layerReference){var e=
this._layerReference;a.walkDepthFirst(function(a){a._layerReference=e})}}},addChild:function(a){this.insertChild(a,this.children.length)},removeChild:function(a){phet.assert(this.isChild(a));a.markOldPaint();a.parent=null;this.children.splice(this.children.indexOf(a),1);this.invalidateBounds();if (a._hasLayerBelow||a.isLayerRoot()){for (;null!==this&&!(this._hasLayerBelow=_.some(this.children,function(a){return a._hasLayerBelow})););this.markLayerRefreshNeeded()}},setLayerType:function(a){if (this._layerType!==
a){this._layerType=a;for (a=this.parent;null!==a;)a._hasLayerBelow=!0,a=a.parent;this.markLayerRefreshNeeded()}},getLayerType:function(){return this._layerType},detach:function(){this.hasParent()&&this.parent.removeChild(this)},validateBounds:function(){var a=this;this._selfBoundsDirty&&(this._selfBoundsDirty=!1,this.markDirtyRegion(this._selfBounds));this._childBoundsDirty&&(_.each(this.children,function(a){a.validateBounds()}),this._childBounds=c.NOTHING,_.each(this.children,function(b){a._childBounds=
a._childBounds.union(b._bounds)}),this._childBoundsDirty=!1);if (this._boundsDirty){var b=this._bounds,e=this.localToParentBounds(this._selfBounds).union(a.localToParentBounds(this._childBounds));e.equals(b)||(this._bounds=e,null!==this.parent&&this.parent.invalidateBounds());this._boundsDirty=!1}},validatePaint:function(){this._paintDirty&&(this.markDirtyRegion(this.parentToLocalBounds(this._bounds)),this._paintDirty=!1);if (this._childPaintDirty||this._oldPaintMarked)this._oldPaintMarked=this._childPaintDirty=
!1,_.each(this.children,function(a){a.validatePaint()})},invalidateBounds:function(){this._boundsDirty=!0;for (var a=this.parent;null!==a&&!a._childBoundsDirty;)a._childBoundsDirty=!0,a=a.parent},invalidatePaint:function(){this._paintDirty=!0;for (var a=this.parent;null!==a&&!a._childPaintDirty;)a._childPaintDirty=!0,a=a.parent},invalidateSelf:function(a){phet.assert(!isNaN(a.x()));this.markOldSelfPaint();this._selfBounds.equals(a)||(this._selfBoundsDirty=!0,this.invalidateBounds(),this._selfBounds=
a);this.invalidatePaint()},invalidateShape:function(){this.markOldSelfPaint();this.hasShape()&&(this.invalidateSelf(this._shape.computeBounds(this._stroke?this._lineDrawingStyles:null)),this.invalidatePaint())},markDirtyRegion:function(a){var b=this.localToGlobalBounds(a);_.each(this.findDescendantLayers(),function(a){a.markDirtyRegion(b)})},markOldSelfPaint:function(){this.markOldPaint(!0)},markLayerRefreshNeeded:function(){this.isRooted()&&this.getScene().layersDirtyUnder(this)},markOldPaint:function(a){for (var b=
this,c=this._oldPaintMarked;!c&&null!==b.parent;)b=b.parent,c=b._oldPaintMarked;c||(a?this.markDirtyRegion(this._selfBounds):(this.markDirtyRegion(this.parentToLocalBounds(this._bounds)),this._oldPaintMarked=!0))},isChild:function(a){phet.assert(a.parent===this===(-1!==this.children.indexOf(a)));return a.parent===this},isLayerRoot:function(){return null!==this._layerType},getLayer:function(){phet.assert(this.isLayerRoot());return this._layerBeforeRender},getSelfBounds:function(){return this._selfBounds},
getBounds:function(){this.validateBounds();return this._bounds},findLayer:function(){return this._layerReference},findDescendantLayers:function(){var a=this.findLayer();if (null===a)return[];for (var b=this;0!==b.children.length;)b=_.last(b.children);for (var b=b.findLayer(),c=[a];a!==b&&null!==a.nextLayer;)a=a.nextLayer,c.push(a);return c},getBaseNode:function(){return this.parent?this.parent.getBaseNode():this},isRoot:function(){return this._isRoot},isRooted:function(){return this.getBaseNode().isRoot()},
getScene:function(){return this.getBaseNode().scene},nodeUnderPoint:function(a){this.validateBounds();if (!this._bounds.containsPoint(a))return null;a=this.transform.inversePosition2(a);if (0<this.children.length&&this._childBounds.containsPoint(a))for (var b=this.children.length-1;0<=b;b--){var c=this.children[b].nodeUnderPoint(a);if (c)return c}return this._selfBounds.containsPoint(a)&&this.containsPointSelf(a)?this:null},containsPoint:function(a){return null!==this.nodeUnderPoint(a)},containsPointSelf:function(a){if (this.hasShape()){var b=
this._shape.containsPoint(a);!b&&(this._includeStrokeInHitRegion&&this.hasStroke())&&(b=this._shape.getStrokedShape(this._lineDrawingStyles).containsPoint(a));return b}return this._selfBounds.containsPoint(a)},intersectsBoundsSelf:function(a){return this.hasShape()?this._shape.intersectsBounds(a):this._selfBounds.intersectsBounds(a)},hasShape:function(){return null!==this._shape},hasFill:function(){return null!==this._fill},hasStroke:function(){return null!==this._stroke},hasParent:function(){return null!==
this.parent},hasChildren:function(){return 0<this.children.length},walkDepthFirst:function(a){a(this);_.each(this.children,function(b){b.walkDepthFirst(a)})},getChildrenWithinBounds:function(a){return _.filter(this.children,function(b){return!b._bounds.intersection(a).isEmpty()})},getAncestors:function(){return this.parent?this.parent.getPathToRoot():[]},getChildren:function(){return this.children.slice(0)},getPathToRoot:function(){for (var a=[],b=this;null!==b;)a.unshift(b),b=b.parent;return a},getPreviousRenderedNode:function(){if (null===
this.parent)return null;var a=_.indexOf(this.parent.children,this);if (0>a-1)return this.parent;for (a=this.parent.children[a-1];0<a.children.length;)a=_.last(a.children)},getNextRenderedNode:function(){for (var a=this.parent;null!==a;){var b=_.indexOf(a.children,this);if (b+1<a.children.length)return a.children[b+1]}return null},getLayerBeforeNodeRendered:function(){if (this._layerBeforeRender){if (null===this.parent)return this._layerBeforeRender;var a=_.indexOf(this.parent.children,this);return 0>a-
1?this.parent._layerReference:this.parent.children[a-1].getLayerAfterNodeRendered()}return this._layerReference},getLayerAfterNodeRendered:function(){return this._layerAfterRender?this._layerAfterRender:this.hasChildren()?_.last(this.children).getLayerAfterNodeRendered():this._layerReference},addInputListener:function(a){-1===_.indexOf(this._inputListeners,a)&&this._inputListeners.push(a)},removeInputListener:function(a){phet.assert(-1!==_.indexOf(this._inputListeners,a));this._inputListeners.splice(_.indexOf(this._inputListeners,
a),1)},getInputListeners:function(){return this._inputListeners.slice(0)},translate:function(a,b,c){"number"===typeof a?c?this.prependMatrix(e.translation(a,b)):this.appendMatrix(e.translation(a,b)):this.translate(a.x,a.y,b)},scaleBy:function(a,b,c){"number"===typeof a?void 0===b?this.appendMatrix(e.scaling(a,a)):c?this.prependMatrix(e.scaling(a,b)):this.appendMatrix(e.scaling(a,b)):this.scaleBy(a.x,a.y,b)},rotate:function(a,b){b?this.prependMatrix(e.rotation2(a)):this.appendMatrix(e.rotation2(a))},
rotateAround:function(a,b){var c=e.translation(-a.x,-a.y),c=e.rotation2(b).timesMatrix(c),c=e.translation(a.x,a.y).timesMatrix(c);this.prependMatrix(c)},getX:function(){return this.getTranslation().x},setX:function(a){this.setTranslation(a,this.getY());return this},getY:function(){return this.getTranslation().y},setY:function(a){this.setTranslation(this.getX(),a);return this},getScale:function(){return this.transform.getMatrix().scaling()},setScale:function(a,b){var c=this.getScale();"number"===typeof a?
(void 0===b&&(b=a),this.appendMatrix(phet.math.Matrix3.scaling(a/c.x,b/c.y))):this.appendMatrix(phet.math.Matrix3.scaling(a.x/c.x,a.y/c.y));return this},getRotation:function(){return this.transform.getMatrix().rotation()},setRotation:function(a){this.appendMatrix(phet.math.Matrix3.rotation2(a-this.getRotation()));return this},setTranslation:function(a,b){var c=this.getTranslation();"number"===typeof a?this.translate(a-c.x,b-c.y,!0):this.translate(a.x-c.x,a.y-c.y,!0);return this},getTranslation:function(){return this.transform.getMatrix().translation()},
appendMatrix:function(a){this.markOldPaint();this.transform.append(a);this.invalidateBounds();this.invalidatePaint()},prependMatrix:function(a){this.markOldPaint();this.transform.prepend(a);this.invalidateBounds();this.invalidatePaint()},setMatrix:function(a){this.markOldPaint();this.transform.set(a);this.invalidateBounds();this.invalidatePaint()},getMatrix:function(){return this.transform.getMatrix()},getLeft:function(){return this.getBounds().minX},setLeft:function(a){this.translate(a-this.getLeft(),
0,!0);return this},getRight:function(){return this.getBounds().maxX},setRight:function(a){this.translate(a-this.getRight(),0,!0);return this},getCenterX:function(){return this.getBounds().centerX()},setCenterX:function(a){this.translate(a-this.getCenterX(),0,!0);return this},getCenterY:function(){return this.getBounds().centerY()},setCenterY:function(a){this.translate(0,a-this.getCenterY(),!0);return this},getTop:function(){return this.getBounds().minY},setTop:function(a){this.translate(0,a-this.getTop(),
!0);return this},getBottom:function(){return this.getBounds().maxY},setBottom:function(a){this.translate(0,a-this.getBottom(),!0);return this},getWidth:function(){return this.getBounds().width()},getHeight:function(){return this.getBounds().height()},setShape:function(a){this._shape!==a&&(this._shape=a,this.invalidateShape());return this},getShape:function(){return this._shape},getLineWidth:function(){return this._lineDrawingStyles.lineWidth},setLineWidth:function(a){this.getLineWidth()!==a&&(this.markOldSelfPaint(),
this._lineDrawingStyles.lineWidth=a,this.invalidateShape());return this},getLineCap:function(){return this._lineDrawingStyles.lineCap},setLineCap:function(a){this._lineDrawingStyles.lineCap!==a&&(this.markOldSelfPaint(),this._lineDrawingStyles.lineCap=a,this.invalidateShape());return this},getLineJoin:function(){return this._lineDrawingStyles.lineJoin},setLineJoin:function(a){this._lineDrawingStyles.lineJoin!==a&&(this.markOldSelfPaint(),this._lineDrawingStyles.lineJoin=a,this.invalidateShape());
return this},setLineStyles:function(a){this.markOldSelfPaint();this._lineDrawingStyles=a;this.invalidateShape();return this},getLineStyles:function(){return this._lineDrawingStyles},getFill:function(){return this._fill},setFill:function(a){this.getFill()!==a&&(this._fill=a,this.invalidatePaint());return this},getStroke:function(){return this._stroke},setStroke:function(a){this.getStroke()!==a&&(this.markOldSelfPaint(),this._stroke=a,this.invalidateShape());return this},isVisible:function(){return this._visible},
setVisible:function(a){a!==this._visible&&(this._visible&&this.markOldSelfPaint(),(this._visible=a)&&this.invalidatePaint());return this},localToParentPoint:function(a){return this.transform.transformPosition2(a)},localToParentBounds:function(a){return this.transform.transformBounds2(a)},parentToLocalPoint:function(a){return this.transform.inversePosition2(a)},parentToLocalBounds:function(a){return this.transform.inverseBounds2(a)},localToGlobalPoint:function(a){for (var b=this;null!==b;)a=b.transform.transformPosition2(a),
b=b.parent;return a},localToGlobalBounds:function(a){for (var b=this;null!==b;)a=b.transform.transformBounds2(a),b=b.parent;return a},globalToLocalPoint:function(a){for (var b=this,c=[];null!==b;)c.push(b.transform),b=b.parent;for (b=c.length-1;0<=b;b--)a=c[b].inversePosition2(a);return a},globalToLocalBounds:function(a){for (var b=this,c=[];null!==b;)c.push(b.transform),b=b.parent;for (b=c.length-1;0<=b;b--)a=c[b].inverseBounds2(a);return a},set stroke(a){this.setStroke(a)},get stroke(){return this.getStroke()},
set fill(a){this.setFill(a)},get fill(){return this.getFill()},set shape(a){this.setShape(a)},get shape(){return this.getShape()},set lineWidth(a){this.setLineWidth(a)},get lineWidth(){return this.getLineWidth()},set lineCap(a){this.setLineCap(a)},get lineCap(){return this.getLineCap()},set lineJoin(a){this.setLineJoin(a)},get lineJoin(){return this.getLineJoin()},set layerType(a){this.setLayerType(a)},get layerType(){return this.getLayerType()},set visible(a){this.setVisible(a)},get visible(){return this.isVisible()},
set matrix(a){this.setMatrix(a)},get matrix(){return this.getMatrix()},set translation(a){this.setTranslation(a)},get translation(){return this.getTranslation()},set rotation(a){this.setRotation(a)},get rotation(){return this.getRotation()},set scale(a){this.setScale(a)},get scale(){return this.getScale()},set x(a){this.setX(a)},get x(){return this.getX()},set y(a){this.setY(a)},get y(){return this.getY()},set left(a){this.setLeft(a)},get left(){return this.getLeft()},set right(a){this.setRight(a)},
get right(){return this.getRight()},set top(a){this.setTop(a)},get top(){return this.getTop()},set bottom(a){this.setBottom(a)},get bottom(){return this.getBottom()},set centerX(a){this.setCenterX(a)},get centerX(){return this.getCenterX()},set centerY(a){this.setCenterY(a)},get centerY(){return this.getCenterY()},get width(){return this.getWidth()},get height(){return this.getHeight()},mutate:function(a){var b=this;_.each("stroke fill shape lineWidth lineCap lineJoin layerType visible translation x y rotation scale left right top bottom centerX centerY".split(" "),
function(c){void 0!==a[c]&&(b[c]=a[c])})}}})();phet=phet||{};scenery=scenery||{};
(function(){function c(a,b){a.enterState(b);if (a._visible){a.renderSelf(b);var d=a.children;if (b.childRestrictedBounds&&1<d.length){var f=a.globalToLocalBounds(b.childRestrictedBounds);f.containsBounds(a.parentToLocalBounds(a._bounds))||(d=a.getChildrenWithinBounds(f))}_.each(d,function(a){c(a,b)})}a.exitState(b)}scenery.Scene=function(a){this.root=new scenery.Node;this.root._isRoot=!0;this.root.scene=this;this.layers=[];this.inputListeners=[];this.uiLayer=new scenery.DOMLayer({scene:this,
main:a});this.dirtyLayerPath=null;this.main=a;this.sceneBounds=new phet.math.Bounds2(0,0,a.width(),a.height());this.root.setLayerType(scenery.CanvasLayer);var b={userSelect:"none",touchCallout:"none",touchAction:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"};_.each(["-webkit-","-moz-","-ms-","-o-",""],function(d){_.each(b,function(b,c){a.css(d+c,b)})})};var b=scenery.Scene;b.prototype={constructor:b,renderScene:function(){phet.assert(null===this.root.parent);phet.assert(this.root.isLayerRoot());
this.root.validateBounds();this.refreshLayers();var a=new scenery.RenderState(this);c(this.root,a);a.finish();_.each(this.layers,function(a){a.resetDirtyRegions()})},updateScene:function(a){phet.assert(null===this.root.parent);phet.assert(this.root.isLayerRoot());this.root.validateBounds();this.root.validatePaint();this.refreshLayers();var b=this;_.each(this.layers,function(d){d.isDirty()&&(d.getDirtyBounds(),d.getDirtyBounds().intersection(b.sceneBounds).isEmpty()||b.updateLayer(d,a))})},updateLayer:function(a,
b){var d=new scenery.RenderState(this);a.getDirtyBounds();var f=a.getDirtyBounds().intersection(this.sceneBounds);a.prepareDirtyRegions();d.pushClipShape(scenery.Shape.bounds(f));d.childRestrictedBounds=f;d.switchToLayer(a);d.multiLayerRender=!1;a.startNode===a.endNode?(f=a.startNode,_.each(f.getAncestors(),function(a){a.enterState(d)}),c(f,d),d.finish()):this.partialUpdateLayer(d,a,b);a.resetDirtyRegions()},partialUpdateLayer:function(a,b){function d(g,h,s,r){if (!s&&!r)c(g,a);else{g.enterState(a);
if (g._visible){s||g.renderSelf(a);s=!s;var q,t=!1;a.childRestrictedBounds&&1<g.children.length&&(q=g.globalToLocalBounds(a.childRestrictedBounds),t=!q.containsBounds(g.parentToLocalBounds(g._bounds)));for (var j=0;j<g.children.length;j++){var m=g.children[j];if (!t||q.intersectsBounds(m._bounds))if (s){if (r&&n[h]===m){n[h]._layerAfterRender===b&&d(m,h+1,!1,n.length!==h);break}c(m,a)}else f[h]===m&&(f[h]._layerBeforeRender===b&&d(m,h+1,f.length!==h,!1),s=!0)}}g.exitState(a)}}var f=b.startNode.getPathToRoot(),
n=b.endNode.getPathToRoot(),g=Math.min(f.length,n.length),h;for (h=0;h<g&&f[h]===n[h];h++){if (!f[h]._visible)return;2<h&&f[h-2].enterState(a)}d(f[h-1],h,f.length!==h,n.length!==h);a.finish()},renderToCanvas:function(a,b,d){b.clearRect(0,0,a.width,a.height);_.each(this.layers,function(c){c.renderToCanvas(a,b,d)})},clearLayers:function(){this.main.empty();this.layers=[];this.uiLayer.recreate()},createLayer:function(a,b){var d=new a(b);this.layers.push(d);return d},resize:function(a,b){this.main.width(a);
this.main.height(b);this.sceneBounds=new phet.math.Bounds2(0,0,a,b);this.rebuildLayers()},rebuildLayers:function(){function a(a,b,e){c.endNode=a;b=d.createLayer(b,n);e?a._layerBeforeRender=b:a._layerAfterRender=b;b.startNode=a;c.nextLayer=b;b.previousLayer=c;c=b}function b(d,g){var h=null!==d._layerType;h||(d._layerBeforeRender=null,d._layerAfterRender=null);h&&a(d,d._layerType,!0);d._layerReference=c;_.each(d.children,function(a){b(a,g)});h&&a(d,g,!1)}phet.assert(null===this.root.parent);phet.assert(this.root.isLayerRoot());
var d=this,c=null,n={main:this.main,scene:this};this.clearLayers();var g=this.root._layerType,h=d.createLayer(g,n);this.root._layerBeforeRender=h;this.root._layerAfterRender=null;h.startNode=this.root;c=h;this.root._layerReference=h;_.each(this.root.children,function(a){b(a,g)});c.endNode=this.root;this.reindexLayers()},reindexLayers:function(){var a=1;_.each(this.layers,function(b){a=b.reindex(a)});a=this.uiLayer.reindex(a)},clearAllLayers:function(){_.each(this.layers,function(a){a.prepareBounds(phet.math.Bounds2.EVERYTHING)})},
getUILayer:function(){return this.uiLayer},layersDirtyUnder:function(a){if (this.dirtyLayerPath){a=a.getPathToRoot();for (var b=Math.min(a.length,this.dirtyLayerPath.length),d=0;d<b;d++)if (a[d]!==this.dirtyLayerPath[d]){this.dirtyLayerPath=_.first(this.dirtyLayerPath,d);break}}else this.dirtyLayerPath=a.getPathToRoot()},refreshLayers:function(){this.dirtyLayerPath&&(this.rebuildLayers(),this.dirtyLayerPath=null)},addInputListener:function(a){phet.assert(!_.contains(this.inputListeners,a));this.inputListeners.push(a)},
removeInputListener:function(a){a=_.indexOf(this.inputListeners,a);phet.assert(-1!==a);this.inputListeners.splice(a,1)},getInputListeners:function(){return this.inputListeners.slice(0)},initializeStandaloneEvents:function(){var a=this.main[0];this.initializeEvents({preventDefault:!0,listenerTarget:a,pointFromEvent:function(b){var d=a.getBoundingClientRect();return new phet.math.Vector2(b.clientX-d.left,b.clientY-d.top)}})},initializeFullscreenEvents:function(){this.initializeEvents({preventDefault:!0,
listenerTarget:document,pointFromEvent:function(a){return new phet.math.Vector2(a.pageX,a.pageY)}})},initializeEvents:function(a){function b(a,c){for (var f=0;f<a.changedTouches.length;f++){var e=a.changedTouches.item(f);c(e.identifier,d(e))}}var d=a.pointFromEvent,c=a.listenerTarget,n=a.preventDefault,g=new scenery.Input(this);$(c).on("mousedown",function(a){var b=a.originalEvent;n&&a.preventDefault();g.mouseDown(d(b),b)});$(c).on("mouseup",function(a){var b=a.originalEvent;n&&a.preventDefault();
g.mouseUp(d(b),b)});$(c).on("mousemove",function(a){var b=a.originalEvent;n&&a.preventDefault();g.mouseMove(d(b),b)});$(c).on("mouseover",function(a){var b=a.originalEvent;n&&a.preventDefault();g.mouseOver(d(b),b)});$(c).on("mouseout",function(a){var b=a.originalEvent;n&&a.preventDefault();g.mouseOut(d(b),b)});$(c).on("touchstart",function(a){var d=a.originalEvent;n&&a.preventDefault();b(d,function(a,b){g.touchStart(a,b,d)})});$(c).on("touchend",function(a){var d=a.originalEvent;n&&a.preventDefault();
b(d,function(a,b){g.touchEnd(a,b,d)})});$(c).on("touchmove",function(a){var d=a.originalEvent;n&&a.preventDefault();b(d,function(a,b){g.touchMove(a,b,d)})});$(c).on("touchcancel",function(a){var d=a.originalEvent;n&&a.preventDefault();b(d,function(a,b){g.touchCancel(a,b,d)})})},resizeOnWindowResize:function(){var a=this,b=function(){a.resize(window.innerWidth,window.innerHeight)};$(window).resize(b);b()}}})();phet=phet||{};scenery=scenery||{};
(function(){scenery.Input=function(b){this.scene=b;this.mouse=new a;this.fingers=[this.mouse]};var c=scenery.Input;c.prototype={constructor:c,addFinger:function(a){this.fingers.push(a)},removeFinger:function(a){for (var b=this.fingers.length-1;0<=b;b--)this.fingers[b]===a&&this.fingers.splice(b,1)},findTouchById:function(a){return _.find(this.fingers,function(b){return b.id===a})},mouseDown:function(a,b){this.mouse.down(a,b);this.downEvent(this.mouse,b)},mouseUp:function(a,b){this.mouse.up(a,
b);this.upEvent(this.mouse,b)},mouseMove:function(a,b){this.mouse.move(a,b);this.moveEvent(this.mouse,b)},mouseOver:function(a,b){this.mouse.over(a,b)},mouseOut:function(a,b){this.mouse.out(a,b)},touchStart:function(a,b,c){a=new e(a,b,c);this.addFinger(a);this.downEvent(a,c)},touchEnd:function(a,b,c){a=this.findTouchById(a);a.end(b,c);this.removeFinger(a);this.upEvent(a,c)},touchMove:function(a,b,c){a=this.findTouchById(a);a.move(b,c);this.moveEvent(a,c)},touchCancel:function(a,b,c){a=this.findTouchById(a);
a.cancel(b,c);this.removeFinger(a);this.cancelEvent(a,c)},upEvent:function(a,b){var c=this.scene.root.nodeUnderPoint(a.point),c=null!==c?c.getPathToRoot():[];this.dispatchEvent(c,"up",a,b);a.path=c},downEvent:function(a,b){var c=this.scene.root.nodeUnderPoint(a.point),c=null!==c?c.getPathToRoot():[];this.dispatchEvent(c,"down",a,b);a.path=c},moveEvent:function(a,b){var c=this.scene.root.nodeUnderPoint(a.point),c=null!==c?c.getPathToRoot():[],e=a.path||[],h;for (h=0;h<Math.min(c.length,e.length)&&c[h]===
e[h];h++);e.length>h&&this.dispatchEvent(e.slice(h),"exit",a,b);c.length>h&&this.dispatchEvent(c.slice(h),"enter",a,b);this.dispatchEvent(c,"move",a,b);a.path=c},cancelEvent:function(a,b){var c=this.scene.root.nodeUnderPoint(a.point),c=null!==c?c.getPathToRoot():[];this.dispatchEvent(c,"cancel",a,b);a.path=c},dispatchEvent:function(a,b,c,e){this.dispatchToFinger(b,c,e);this.dispatchToTargets(a,b,c,e);this.dispatchToScene(b,c,e)},dispatchToFinger:function(a,b,c){for (var e=b.listeners.slice(0),h=0;h<
e.length;h++){var k=e[h];if (k[a]&&k[a](b,c))break}},dispatchToTargets:function(a,b,c,e){for (var h=a.length-1;0<=h;h--)for (var k=a[h].getInputListeners(),p=0;p<k.length;p++){var s=k[p];if (s[b]&&s[b](c,e))return}},dispatchToScene:function(a,b,c){for (var e=this.scene.getInputListeners(),h=0;h<e.length;h++){var k=e[h];if (k[a]&&k[a](b,c))break}}};c.Finger=function(){this.listeners=[]};var b=c.Finger;b.prototype={constructor:b,addListener:function(a){phet.assert(!_.contains(this.listeners,a));this.listeners.push(a)},
removeListener:function(a){a=_.indexOf(this.listeners,a);phet.assert(-1!==a);this.listeners.splice(a,1)}};c.Mouse=function(){b.call(this);this.point=null;this.rightDown=this.middleDown=this.leftDown=!1;this.isMouse=!0;this.path=null};var a=c.Mouse;a.prototype=_.extend({},b.prototype,{constructor:a,down:function(a,b){this.point=a;switch(b.button){case 0:this.leftDown=!0;break;case 1:this.middleDown=!0;break;case 2:this.rightDown=!0}},up:function(a,b){this.point=a;switch(b.button){case 0:this.leftDown=
!1;break;case 1:this.middleDown=!1;break;case 2:this.rightDown=!1}},move:function(a){this.point=a},over:function(a){this.point=a},out:function(){this.point=null}});c.Touch=function(a,c){b.call(this);this.id=a;this.point=c;this.isTouch=!0;this.path=null};var e=c.Touch;e.prototype=_.extend({},b.prototype,{constructor:e,move:function(a){this.point=a},end:function(a){this.point=a},cancel:function(a){this.point=a}});c.Key=function(a){b.call(this);this.key=a;this.isKey=!0;this.path=null};c=c.Key;c.prototype=
_.extend({},b.prototype,{constructor:c})})();phet=phet||{};scenery=scenery||{};
(function(){scenery.RenderState=function(b){this.transform=new phet.math.Transform3;this.layer=null;this.scene=b;this.clipShapes=[];this.multiLayerRender=!0;this.childRestrictedBounds=null};var c=scenery.RenderState;c.prototype={constructor:c,pushClipShape:function(b){this.clipShapes.push(this.transform.transformShape(b));this.layer&&this.layer.pushClipShape(b)},popClipShape:function(){this.clipShapes.pop();this.layer&&this.layer.popClipShape()},switchToLayer:function(b){if (!this.layer||this.multiLayerRender)this.layer&&
this.layer.cooldown(),this.layer=b,b.initialize(this)},finish:function(){this.layer&&this.layer.cooldown()},isCanvasState:function(){return this.layer.isCanvasLayer},isDOMState:function(){return this.layer.isDOMLayer},applyTransformationMatrix:function(b){this.transform.append(b);this.layer.applyTransformationMatrix(b)}}})();phet=phet||{};scenery=scenery||{};
(function(){var c=phet.math.Bounds2;scenery.CanvasLayer=function(a){var b=a.main,d=document.createElement("canvas");d.width=b.width();d.height=b.height();$(d).css("position","absolute");b.append(d);this.canvas=d;this.context=phet.canvas.initCanvas(d);this.scene=a.scene;this.isCanvasLayer=!0;this.dirtyBounds=c.EVERYTHING;this.resetStyles();this.previousLayer=this.nextLayer=this.endNode=this.startNode=null};var b=scenery.CanvasLayer;b.prototype={constructor:b,initialize:function(a){this.context.setTransform(1,
0,0,1,0,0);this.context.save();var b=this.context;_.each(a.clipShapes,function(a){b.beginPath();a.writeToContext(b);b.clip()});a.transform.getMatrix().canvasSetTransform(this.context);this.resetStyles()},cooldown:function(){this.context.restore()},isDirty:function(){return!this.dirtyBounds.isEmpty()},applyTransformationMatrix:function(a){a.canvasAppendTransform(this.context)},resetStyles:function(){this.strokeStyle=this.fillStyle=null;this.lineWidth=1;this.lineCap="butt";this.lineJoin="miter";this.miterLimit=
10;this.font="10px sans-serif";this.textAlign="start";this.textBaseline="alphabetic";this.direction="inherit"},reindex:function(a){$(this.canvas).css("z-index",a);this.zIndex=a;return a+1},recreate:function(){this.main.append(this.canvas)},pushClipShape:function(a){this.context.save();this.context.beginPath();a.writeToContext(this.context);this.context.clip()},popClipShape:function(){this.context.restore()},markDirtyRegion:function(a){this.dirtyBounds=this.dirtyBounds.union(a.dilated(1).roundedOut())},
resetDirtyRegions:function(){this.dirtyBounds=c.NOTHING},prepareBounds:function(a){a=a.intersection(new phet.math.Bounds2(0,0,this.canvas.width,this.canvas.height));a.isEmpty()||(this.context.save(),this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(a.x(),a.y(),a.width(),a.height()),this.context.restore())},prepareDirtyRegions:function(){this.prepareBounds(this.dirtyBounds)},getDirtyBounds:function(){return this.dirtyBounds},setFillStyle:function(a){this.fillStyle!==a&&(this.fillStyle=
a,this.context.fillStyle=a)},setStrokeStyle:function(a){this.strokeStyle!==a&&(this.strokeStyle=a,this.context.strokeStyle=a)},setLineWidth:function(a){this.lineWidth!==a&&(this.lineWidth=a,this.context.lineWidth=a)},setLineCap:function(a){this.lineCap!==a&&(this.lineCap=a,this.context.lineCap=a)},setLineJoin:function(a){this.lineJoin!==a&&(this.lineJoin=a,this.context.lineJoin=a)},setFont:function(a){this.font!==a&&(this.font=a,this.context.font=a)},setTextAlign:function(a){this.textAlign!==a&&(this.textAlign=
a,this.context.textAlign=a)},setTextBaseline:function(a){this.textBaseline!==a&&(this.textBaseline=a,this.context.textBaseline=a)},setDirection:function(a){this.direction!==a&&(this.direction=a,this.context.direction=a)},renderToCanvas:function(a,b){b.drawImage(this.canvas,0,0)}}})();phet=phet||{};scenery=scenery||{};
(function(){var c=phet.math.Bounds2;scenery.DOMLayer=function(a){var b=a.main;this.main=b;this.div=document.createElement("div");$(this.div).width(b.width());$(this.div).height(b.height());$(this.div).css("position","absolute");b.append(this.div);this.scene=a.scene;this.dirtyBounds=c.NOTHING;this.isDOMLayer=!0;this.previousLayer=this.nextLayer=null};var b=scenery.DOMLayer;b.prototype={constructor:b,initialize:function(){},cooldown:function(){},recreate:function(){this.main.append(this.div)},
isDirty:function(){return!1},applyTransformationMatrix:function(){},getContainer:function(){return this.div},reindex:function(a){$(this.div).css("z-index",a);this.zIndex=a;return a+1},pushClipShape:function(){},popClipShape:function(){},markDirtyRegion:function(){},resetDirtyRegions:function(){this.dirtyBounds=c.NOTHING},prepareBounds:function(){},prepareDirtyRegions:function(){this.prepareBounds(this.dirtyBounds)},getDirtyBounds:function(){return this.dirtyBounds},renderToCanvas:function(a,b,d){a=
"<svg xmlns='http://www.w3.org/2000/svg' width='"+this.main.width()+"' height='"+this.main.height()+"'><foreignObject width='100%' height='100%'>"+$(this.div).html()+"</foreignObject></svg>";var c=window.URL||window.webkitURL||window,n=new Image;a=new Blob([a],{type:"image/svg+xml;charset=utf-8"});var g=c.createObjectURL(a);d.increment();n.onload=function(){b.drawImage(n,0,0);c.revokeObjectURL(g);d.decrement()};n.src=g}}})();phet=phet||{};scenery=scenery||{};
(function(){scenery.Text=function(b,a){this.fontStyles=new c.FontStyles;a=a||{};void 0===a.fill&&(a.fill="#000000");void 0!==b&&(a.text=b);scenery.Node.call(this,a)};var c=scenery.Text;c.prototype=Object.create(scenery.Node.prototype);c.prototype.constructor=c;c.prototype.setText=function(b){this._text=b;this.invalidateText();return this};c.prototype.getText=function(){return this._text};c.prototype.invalidateText=function(){this.invalidateSelf(scenery.canvasTextBoundsAccurate(this._text,
this.fontStyles))};c.prototype.renderSelf=function(b){if (b.isCanvasState()){b=b.layer;var a=b.context;this.hasFill()&&(b.setFillStyle(this.getFill()),b.setFont(this.fontStyles.font),b.setTextAlign(this.fontStyles.textAlign),b.setTextBaseline(this.fontStyles.textBaseline),b.setDirection(this.fontStyles.direction),a.fillText(this._text,0,0))}};c.prototype.setFont=function(b){this.fontStyles.font=b;this.invalidateText();return this};c.prototype.getFont=function(){return this.fontStyles.font};c.prototype.setTextAlign=
function(b){this.fontStyles.textAlign=b;this.invalidateText();return this};c.prototype.getTextAlign=function(){return this.fontStyles.textAlign};c.prototype.setTextBaseline=function(b){this.fontStyles.textBaseline=b;this.invalidateText();return this};c.prototype.getTextBaseline=function(){return this.fontStyles.textBaseline};c.prototype.setDirection=function(b){this.fontStyles.direction=b;this.invalidateText();return this};c.prototype.getDirection=function(){return this.fontStyles.direction};c.prototype.mutate=
function(b){var a=this;_.each(["text","font","textAlign","textBaseline","direction"],function(c){void 0!==b[c]&&(a[c]=b[c])});scenery.Node.prototype.mutate.call(this,b)};Object.defineProperty(c.prototype,"text",{set:c.prototype.setText,get:c.prototype.getText});Object.defineProperty(c.prototype,"font",{set:c.prototype.setFont,get:c.prototype.getFont});Object.defineProperty(c.prototype,"textAlign",{set:c.prototype.setTextAlign,get:c.prototype.getTextAlign});Object.defineProperty(c.prototype,"textBaseline",
{set:c.prototype.setTextBaseline,get:c.prototype.getTextBaseline});Object.defineProperty(c.prototype,"direction",{set:c.prototype.setDirection,get:c.prototype.getDirection});c.FontStyles=function(b){void 0===b&&(b={});this.font=void 0!==b.font?b.font:"10px sans-serif";this.textAlign=void 0!==b.textAlign?b.textAlign:"start";this.textBaseline=void 0!==b.textBaseline?b.textBaseline:"alphabetic";this.direction=void 0!==b.direction?b.direction:"ltr"}})();phet=phet||{};scenery=scenery||{};
(function(){scenery.DOM=function(b,a){this._interactive=!1;this._element=b;scenery.Node.call(this,a);this.invalidateDOM()};var c=scenery.DOM;c.prototype=Object.create(scenery.Node.prototype);c.prototype.constructor=c;c.prototype.invalidateDOM=function(){this.invalidateSelf(new phet.math.Bounds2(0,0,$(this._element).width(),$(this._element).height()))};c.prototype.renderSelf=function(b){var a=b.transform.getMatrix().cssTransform();$(this._element).css({"-webkit-transform":a+" translateZ(0)",
"-moz-transform":a+" translateZ(0)","-ms-transform":a,"-o-transform":a,transform:a,"transform-origin":"top left","-ms-transform-origin":"top left",position:"absolute",left:0,top:0});b=(b.isDOMState()&&!this._interactive?b.layer:b.scene.getUILayer()).getContainer();this._element.parentNode!==b&&$(b).append(this._element);this.invalidateDOM()};c.prototype.setElement=function(b){this._element=b;this.invalidateDOM();return this};c.prototype.getElement=function(){return this._element};c.prototype.setInteractive=
function(b){this._interactive=b;this.invalidatePaint();return this};c.prototype.isInteractive=function(){return this._interactive};c.prototype.mutate=function(b){var a=this;_.each(["element","interactive"],function(c){void 0!==b[c]&&(a[c]=b[c])});scenery.Node.prototype.mutate.call(this,b)};Object.defineProperty(c.prototype,"element",{set:c.prototype.setElement,get:c.prototype.getElement});Object.defineProperty(c.prototype,"interactive",{set:c.prototype.setInteractive,get:c.prototype.isInteractive})})();
phet=phet||{};scenery=scenery||{};(function(){scenery.Image=function(b,a){scenery.Node.call(this,a);this.image=b;this.invalidateSelf(new phet.math.Bounds2(0,0,b.width,b.height))};var c=scenery.Image;c.prototype=Object.create(scenery.Node.prototype);c.prototype.constructor=c;c.prototype.renderSelf=function(b){b.isCanvasState()&&b.layer.context.drawImage(this.image,0,0)}})();phet=phet||{};scenery=scenery||{};scenery=scenery||{};
(function(){function c(a){console.log("context."+a+";")}function b(a,b){c(a+" = "+JSON.stringify(b))}function a(a,b){void 0===b||0===b.length?c(a+"()"):c(a+"( "+_.reduce(b,function(a,b){return 0<a.length?a+", "+JSON.stringify(b):JSON.stringify(b)},"")+" )")}scenery.DebugContext=function(a){this._context=a};var e=scenery.DebugContext;e.prototype={constructor:e,get canvas(){c("canvas");return this._context.canvas},get width(){c("width");return this._context.width},get height(){c("height");return this._context.height},
commit:function(){a("commit");this._context.commit()},save:function(){a("save");this._context.save()},restore:function(){a("restore");this._context.restore()},get currentTransform(){c("currentTransform");return this._context.currentTransform},set currentTransform(a){b("currentTransform",a);this._context.currentTransform=a},scale:function(b,c){a("scale",[b,c]);this._context.scale(b,c)},rotate:function(b){a("rotate",[b]);this._context.rotate(b)},translate:function(b,c){a("translate",[b,c]);this._context.translate(b,
c)},transform:function(b,c,e,g,h,k){a("transform",[b,c,e,g,h,k]);this._context.transform(b,c,e,g,h,k)},setTransform:function(b,c,e,g,h,k){a("setTransform",[b,c,e,g,h,k]);this._context.setTransform(b,c,e,g,h,k)},resetTransform:function(){a("resetTransform");this._context.resetTransform()},get globalAlpha(){c("globalAlpha");return this._context.globalAlpha},set globalAlpha(a){b("globalAlpha",a);this._context.globalAlpha=a},get globalCompositeOperation(){c("globalCompositeOperation");return this._context.globalCompositeOperation},
set globalCompositeOperation(a){b("globalCompositeOperation",a);this._context.globalCompositeOperation=a},get imageSmoothingEnabled(){c("imageSmoothingEnabled");return this._context.imageSmoothingEnabled},set imageSmoothingEnabled(a){b("imageSmoothingEnabled",a);this._context.imageSmoothingEnabled=a},get strokeStyle(){c("strokeStyle");return this._context.strokeStyle},set strokeStyle(a){b("strokeStyle",a);this._context.strokeStyle=a},get fillStyle(){c("fillStyle");return this._context.fillStyle},
set fillStyle(a){b("fillStyle",a);this._context.fillStyle=a},createLinearGradient:function(b,c,e,g){a("createLinearGradient",[b,c,e,g]);return this._context.createLinearGradient(b,c,e,g)},createRadialGradient:function(b,c,e,g,h,k){a("createRadialGradient",[b,c,e,g,h,k]);return this._context.createRadialGradient(b,c,e,g,h,k)},createPattern:function(b,c){a("createPattern",[b,c]);return this._context.createPattern(b,c)},get shadowOffsetX(){c("shadowOffsetX");return this._context.shadowOffsetX},set shadowOffsetX(a){b("shadowOffsetX",
a);this._context.shadowOffsetX=a},get shadowOffsetY(){c("shadowOffsetY");return this._context.shadowOffsetY},set shadowOffsetY(a){b("shadowOffsetY",a);this._context.shadowOffsetY=a},get shadowBlur(){c("shadowBlur");return this._context.shadowBlur},set shadowBlur(a){b("shadowBlur",a);this._context.shadowBlur=a},get shadowColor(){c("shadowColor");return this._context.shadowColor},set shadowColor(a){b("shadowColor",a);this._context.shadowColor=a},clearRect:function(b,c,e,g){a("clearRect",[b,c,e,g]);
this._context.clearRect(b,c,e,g)},fillRect:function(b,c,e,g){a("fillRect",[b,c,e,g]);this._context.fillRect(b,c,e,g)},strokeRect:function(b,c,e,g){a("strokeRect",[b,c,e,g]);this._context.strokeRect(b,c,e,g)},get fillRule(){c("fillRule");return this._context.fillRule},set fillRule(a){b("fillRule",a);this._context.fillRule=a},beginPath:function(){a("beginPath");this._context.beginPath()},fill:function(b){a("fill",b?[b]:void 0);this._context.fill(b)},stroke:function(b){a("stroke",b?[b]:void 0);this._context.stroke(b)},
drawSystemFocusRing:function(b,c){a("drawSystemFocusRing",c?[b,c]:[b]);this._context.drawSystemFocusRing(b,c)},drawCustomFocusRing:function(b,c){a("drawCustomFocusRing",c?[b,c]:[b]);return this._context.drawCustomFocusRing(b,c)},scrollPathIntoView:function(b){a("scrollPathIntoView",b?[b]:void 0);this._context.scrollPathIntoView(b)},clip:function(b){a("clip",b?[b]:void 0);this._context.clip(b)},resetClip:function(){a("resetClip");this._context.resetClip()},isPointInPath:function(b,c,e){a("isPointInPath",
e?[b,c,e]:[b,c]);return this._context.isPointInPath(b,c,e)},fillText:function(b,c,e,g){a("fillText",void 0!==g?[b,c,e,g]:[b,c,e]);this._context.fillText(b,c,e,g)},strokeText:function(b,c,e,g){a("strokeText",void 0!==g?[b,c,e,g]:[b,c,e]);this._context.strokeText(b,c,e,g)},measureText:function(b){a("measureText",[b]);return this._context.measureText(b)},drawImage:function(b,c,e,g,h,k,p,s,r){a("drawImage",void 0!==g?void 0!==k?[b,c,e,g,h,k,p,s,r]:[b,c,e,g,h]:[b,c,e]);this._context.drawImage(b,c,e,g,
h,k,p,s,r)},addHitRegion:function(b){a("addHitRegion",[b]);this._context.addHitRegion(b)},removeHitRegion:function(b){a("removeHitRegion",[b]);this._context.removeHitRegion(b)},createImageData:function(b,c){a("createImageData",void 0!==c?[b,c]:[b]);return this._context.createImageData(b,c)},createImageDataHD:function(b,c){a("createImageDataHD",[b,c]);return this._context.createImageDataHD(b,c)},getImageData:function(b,c,e,g){a("getImageData",[b,c,e,g]);return this._context.getImageData(b,c,e,g)},
getImageDataHD:function(b,c,e,g){a("getImageDataHD",[b,c,e,g]);return this._context.getImageDataHD(b,c,e,g)},putImageData:function(b,c,e,g,h,k,p){a("putImageData",void 0!==g?[b,c,e,g,h,k,p]:[b,c,e]);this._context.putImageData(b,c,e,g,h,k,p)},putImageDataHD:function(b,c,e,g,h,k,p){a("putImageDataHD",void 0!==g?[b,c,e,g,h,k,p]:[b,c,e]);this._context.putImageDataHD(b,c,e,g,h,k,p)},get lineWidth(){c("lineWidth");return this._context.lineWidth},set lineWidth(a){b("lineWidth",a);this._context.lineWidth=
a},get lineCap(){c("lineCap");return this._context.lineCap},set lineCap(a){b("lineCap",a);this._context.lineCap=a},get lineJoin(){c("lineJoin");return this._context.lineJoin},set lineJoin(a){b("lineJoin",a);this._context.lineJoin=a},get miterLimit(){c("miterLimit");return this._context.miterLimit},set miterLimit(a){b("miterLimit",a);this._context.miterLimit=a},setLineDash:function(b){a("setLineDash",[b]);this._context.setLineDash(b)},getLineDash:function(){a("getLineDash");return this._context.getLineDash()},
get lineDashOffset(){c("lineDashOffset");return this._context.lineDashOffset},set lineDashOffset(a){b("lineDashOffset",a);this._context.lineDashOffset=a},get font(){c("font");return this._context.font},set font(a){b("font",a);this._context.font=a},get textAlign(){c("textAlign");return this._context.textAlign},set textAlign(a){b("textAlign",a);this._context.textAlign=a},get textBaseline(){c("textBaseline");return this._context.textBaseline},set textBaseline(a){b("textBaseline",a);this._context.textBaseline=
a},get direction(){c("direction");return this._context.direction},set direction(a){b("direction",a);this._context.direction=a},closePath:function(){a("closePath");this._context.closePath()},moveTo:function(b,c){a("moveTo",[b,c]);this._context.moveTo(b,c)},lineTo:function(b,c){a("lineTo",[b,c]);this._context.lineTo(b,c)},quadraticCurveTo:function(b,c,e,g){a("quadraticCurveTo",[b,c,e,g]);this._context.quadraticCurveTo(b,c,e,g)},bezierCurveTo:function(b,c,e,g,h,k){a("bezierCurveTo",[b,c,e,g,h,k]);this._context.bezierCurveTo(b,
c,e,g,h,k)},arcTo:function(b,c,e,g,h,k,p){a("arcTo",void 0!==k?[b,c,e,g,h,k,p]:[b,c,e,g,h]);this._context.arcTo(b,c,e,g,h,k,p)},rect:function(b,c,e,g){a("rect",[b,c,e,g]);this._context.rect(b,c,e,g)},arc:function(b,c,e,g,h,k){a("arc",[b,c,e,g,h,k]);this._context.arc(b,c,e,g,h,k)},ellipse:function(b,c,e,g,h,k,p,s){a("ellipse",[b,c,e,g,h,k,p,s]);this._context.ellipse(b,c,e,g,h,k,p,s)}}})();

//@ sourceMappingURL=scenery-min.js.map
