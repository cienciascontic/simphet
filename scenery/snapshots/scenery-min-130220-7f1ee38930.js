'use strict';var phetDebug=!1,phet=phet||{};phet.assert=function(d,b){if(!d)throw Error("Assertion failed: "+b);};phet.debugAssert=function(d,b){if(phetDebug&&!d())throw Error("Assertion failed: "+b);};phet.util=phet.util||{};
(function(){phet.util.remove=function(d,b){d.splice(d.indexOf(b),1)};phet.util.isArray=function(d){return"[object Array]"===Object.prototype.toString.call(d)};phet.util.foreach=function(d,b){for(var a=0;a<d.length;a++)b.call(void 0,d[a])};phet.util.map=function(d,b){var a=[];phet.util.foreach(d,function(c){a.push(b.call(void 0,c))});return a};phet.util.rangeInclusive=function(d,b){for(var a=Array(b-d+1),c=d;c<=b;c++)a[c]=c;return a};phet.util.mkString=function(d,b){var a="";b=void 0===b?", ":b;var c=
!0;phet.util.foreach(d,function(e){c||(a+=b);c=!1;a=void 0===e?a+"undefined":a+e.toString()});return a};phet.util.pairs=function(d){for(var b=[],a=d.length,c=0;c<a-1;c++)for(var e=d[c],f=c+1;f<a;f++)b.push([e,d[f]]);return b};phet.util.partition=function(d,b){for(var a=[],c=[],e=0;e<d.length;e++){var f=d[e];b.call(void 0,f)?a.push(f):c.push(f)}return[a,c]};phet.util.filter=function(d,b){for(var a=[],c=0;c<d.length;c++){var e=d[c];b.call(void 0,e)&&a.push(e)}return a};phet.util.unique=function(d,b){b||
(b=function(a,c){return a===c});for(var a=[],c=0;c<d.length;c++){for(var e=!0,f=d[c],k=0;k<a.length;k++)if(b(f,a[k])){e=!1;break}e&&a.push(f)}return a};phet.util.first=function(d,b){for(var a=0;a<d.length;a++)if(b(d[a]))return d[a]};phet.util.firstOrNull=function(d,b){var a=phet.util.first(d,b);return void 0===a?null:a};phet.util.subtract=function(d,b){return phet.util.filter(d,function(a){return-1===b.indexOf(a)})};phet.util.count=function(d,b){for(var a=0,c=0;c<d.length;c++)b(d[c])&&a++;return a}})();
(function(){phet.Object=phet.Object||{};phet.Object.create=Object.create||function(a){function e(){}if(1<arguments.length)throw Error("Object.create implementation only accepts the first parameter.");e.prototype=a;return new e};phet.Float32Array=window.Float32Array||Array;for(var d=0,b=["ms","moz","webkit","o"],a=0;a<b.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[b[a]+"RequestAnimationFrame"],phet.cancelAnimationFrame=window[b[a]+"CancelAnimationFrame"]||window[b[a]+
"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var e=(new Date).getTime(),b=Math.max(0,16-(e-d)),k=window.setTimeout(function(){a(e+b)},b);d=e+b;return k});phet.cancelAnimationFrame||(phet.cancelAnimationFrame=function(a){clearTimeout(a)})})();phet=phet||{};phet.model=phet.model||{};
(function(){phet.model.Property=function(b){this.observers=[];this.initialValue=this.value=b};var d=phet.model.Property;d.prototype={constructor:d,addObserver:function(b,a){this.observers.push(b);a&&b.call(void 0,this.value,this.value)},removeObserver:function(b){this.observers.splice(this.observers.indexOf(b),1)},notifyObservers:function(b,a){for(var c in this.observers)this.observers.hasOwnProperty(c)&&this.observers[c].call(void 0,b,a)},toString:function(){return this.value.toString()},get:function(){return this.value},
set:function(b){var a=this.value;if(null===b?null!==a:b!==a||b.equals&&b.equals(a))this.value=b,this.notifyObservers(a,this.value)},getInitialValue:function(){return this.initialValue}}})();phet=phet||{};phet.model=phet.model||{};
(function(){phet.model.Notifier=function(){this.listeners=[]};var d=phet.model.Notifier;d.prototype={constructor:d,addListener:function(a){this.listeners.push(a)},addUpdateListener:function(a,c){this.listeners.push(a);c&&a()},removeListener:function(a){this.listeners.splice(this.listeners.indexOf(a),1)},updateListeners:function(a){for(var c=0;c<this.listeners.length;c++)this.listeners[c](a)}};phet.model.CompositeNotifier=function(a){function c(a){e.updateListeners(a)}d.call(this);this.notifiers=a;
for(var e=this,b=0;b<a.length;b++)a[b].addListener(c)};var b=phet.model.CompositeNotifier;b.prototype=phet.Object.create(d.prototype);b.prototype.constructor=b})();phet=phet||{};phet.math=phet.math||{};phet.math.clamp=function(d,b,a){return d<b?b:d>a?a:d};phet.math.toRadians=function(d){return Math.PI*d/180};phet=phet||{};phet.math=phet.math||{};
(function(){phet.math.Vector2=function(a,c){this.x=a||0;this.y=c||0};var d=phet.math.Vector2;d.createPolar=function(a,c){return(new d(Math.cos(c),Math.sin(c))).timesScalar(a)};phet.math.Vector2.prototype={constructor:phet.math.Vector2,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.dot(this)},dot:function(a){return this.x*a.x+this.y*a.y},crossScalar:function(a){return this.magnitude()*a.magnitude()*Math.sin(this.getAngle()-a.getAngle())},normalized:function(){var a=
this.magnitude();if(0===a)throw Error("Cannot normalize a zero-magnitude vector");return new d(this.x/a,this.y/a)},timesScalar:function(a){return new d(this.x*a,this.y*a)},times:function(a){phet.assert(void 0===a.dimension);return this.timesScalar(a)},componentTimes:function(a){return new d(this.x*a.x,this.y*a.y)},plus:function(a){return new d(this.x+a.x,this.y+a.y)},plusScalar:function(a){return new d(this.x+a,this.y+a)},minus:function(a){return new d(this.x-a.x,this.y-a.y)},minusScalar:function(a){return new d(this.x-
a,this.y-a)},dividedScalar:function(a){return new d(this.x/a,this.y/a)},negated:function(){return new d(-this.x,-this.y)},angle:function(){return Math.atan2(this.x,this.y)},perpendicular:function(){return new d(this.y,-this.x)},angleBetween:function(a){return Math.acos(phet.math.clamp(this.normalized().dot(a.normalized()),-1,1))},rotated:function(a){return d.createPolar(this.magnitude(),this.getAngle+a)},toString:function(){return"Vector2("+this.x+", "+this.y+")"},toVector3:function(){return new phet.math.Vector3(this.x,
this.y)},set:function(a,c){this.x=a;this.y=c},setX:function(a){this.x=a},setY:function(a){this.y=a},copy:function(a){this.x=a.x;this.y=a.y},add:function(a){this.x+=a.x;this.y+=a.y},addScalar:function(a){this.x+=a;this.y+=a},subtract:function(a){this.x-=a.x;this.y-=a.y},subtractScalar:function(a){this.x-=a;this.y-=a},componentMultiply:function(a){this.x*=a.x;this.y*=a.y},divideScalar:function(a){this.x/=a;this.y/=a},negate:function(){this.x=-this.x;this.y=-this.y},equals:function(a,c){c||(c=0);return Math.abs(this.x-
a.x)+Math.abs(this.y-a.y)<=c},isVector2:!0,dimension:2};d.Immutable=function(a,c){this.x=a||0;this.y=c||0};var b=d.Immutable;b.prototype=new phet.math.Vector2;b.prototype.constructor=b;b.mutableOverrideHelper=function(a){b.prototype[a]=function(){throw Error("Cannot call mutable method '"+a+"' on immutable Vector2");}};b.mutableOverrideHelper("set");b.mutableOverrideHelper("setX");b.mutableOverrideHelper("setY");b.mutableOverrideHelper("copy");b.mutableOverrideHelper("add");b.mutableOverrideHelper("addScalar");
b.mutableOverrideHelper("subtract");b.mutableOverrideHelper("subtractScalar");b.mutableOverrideHelper("componentMultiply");b.mutableOverrideHelper("divideScalar");b.mutableOverrideHelper("negate");d.ZERO=new b(0,0);d.X_UNIT=new b(1,0);d.Y_UNIT=new b(0,1)})();phet=phet||{};phet.math=phet.math||{};
(function(){phet.math.Vector3=function(a,c,e){this.x=a||0;this.y=c||0;this.z=e||0};var d=phet.math.Vector3;phet.math.Vector3.prototype={constructor:phet.math.Vector3,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.dot(this)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},cross:function(a){return new d(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,this.x*a.y-this.y*a.x)},normalized:function(){var a=this.magnitude();if(0===a)throw Error("Cannot normalize a zero-magnitude vector");
return new d(this.x/a,this.y/a,this.z/a)},timesScalar:function(a){return new d(this.x*a,this.y*a,this.z*a)},times:function(a){phet.assert(void 0===a.dimension);return this.timesScalar(a)},componentTimes:function(a){return new d(this.x*a.x,this.y*a.y,this.z*a.z)},plus:function(a){return new d(this.x+a.x,this.y+a.y,this.z+a.z)},plusScalar:function(a){return new d(this.x+a,this.y+a,this.z+a)},minus:function(a){return new d(this.x-a.x,this.y-a.y,this.z-a.z)},minusScalar:function(a){return new d(this.x-
a,this.y-a,this.z-a)},dividedScalar:function(a){return new d(this.x/a,this.y/a,this.z/a)},negated:function(){return new d(-this.x,-this.y,-this.z)},angleBetween:function(a){return Math.acos(phet.math.clamp(this.normalized().dot(a.normalized()),-1,1))},toString:function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"},toVector2:function(){return new phet.math.Vector2(this.x,this.y)},toVector4:function(){return new phet.math.Vector4(this.x,this.y,this.z)},set:function(a,c,e){this.x=a;this.y=c;
this.z=e},setX:function(a){this.x=a},setY:function(a){this.y=a},setZ:function(a){this.z=a},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a},subtract:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z},subtractScalar:function(a){this.x-=a;this.y-=a;this.z-=a},componentMultiply:function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z},divideScalar:function(a){this.x/=a;this.y/=a;this.z/=a},negate:function(){this.x=
-this.x;this.y=-this.y;this.z=-this.z},equals:function(a,c){c||(c=0);return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)<=c},isVector3:!0,dimension:3};d.Immutable=function(a,c,e){this.x=a||0;this.y=c||0;this.z=e||0};var b=d.Immutable;b.prototype=new phet.math.Vector3;b.prototype.constructor=b;b.mutableOverrideHelper=function(a){b.prototype[a]=function(){throw Error("Cannot call mutable method '"+a+"' on immutable Vector3");}};b.mutableOverrideHelper("set");b.mutableOverrideHelper("setX");
b.mutableOverrideHelper("setY");b.mutableOverrideHelper("setZ");b.mutableOverrideHelper("copy");b.mutableOverrideHelper("add");b.mutableOverrideHelper("addScalar");b.mutableOverrideHelper("subtract");b.mutableOverrideHelper("subtractScalar");b.mutableOverrideHelper("componentMultiply");b.mutableOverrideHelper("divideScalar");b.mutableOverrideHelper("negate");d.ZERO=new b(0,0,0);d.X_UNIT=new b(1,0,0);d.Y_UNIT=new b(0,1,0);d.Z_UNIT=new b(0,0,1)})();phet=phet||{};phet.math=phet.math||{};
(function(){phet.math.Vector4=function(a,c,e,b){this.x=a||0;this.y=c||0;this.z=e||0;this.w=void 0!==b?b:1};var d=phet.math.Vector4;phet.math.Vector4.prototype={constructor:phet.math.Vector4,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){this.dot(this)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},normalized:function(){var a=this.magnitude();if(0===a)throw Error("Cannot normalize a zero-magnitude vector");return new d(this.x/a,this.y/
a,this.z/a,this.w/a)},timesScalar:function(a){return new d(this.x*a,this.y*a,this.z*a,this.w*a)},times:function(a){phet.assert(void 0===a.dimension);return this.timesScalar(a)},componentTimes:function(a){return new d(this.x*a.x,this.y*a.y,this.z*a.z,this.w*a.w)},plus:function(a){return new d(this.x+a.x,this.y+a.y,this.z+a.z,this.w+a.w)},plusScalar:function(a){return new d(this.x+a,this.y+a,this.z+a,this.w+a)},minus:function(a){return new d(this.x-a.x,this.y-a.y,this.z-a.z,this.w-a.w)},minusScalar:function(a){return new d(this.x-
a,this.y-a,this.z-a,this.w-a)},dividedScalar:function(a){return new d(this.x/a,this.y/a,this.z/a,this.w/a)},negated:function(){return new d(-this.x,-this.y,-this.z,-this.w)},angleBetween:function(a){return Math.acos(phet.math.clamp(this.normalized().dot(a.normalized()),-1,1))},toString:function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},toVector3:function(){return new phet.math.Vector3(this.x,this.y,this.z)},set:function(a,c,e,b){this.x=a;this.y=c;this.z=e;this.w=b},setX:function(a){this.x=
a},setY:function(a){this.y=a},setZ:function(a){this.z=a},setW:function(a){this.w=a},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a},subtract:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w},subtractScalar:function(a){this.x-=a;this.y-=a;this.z-=a;this.w-=a},componentMultiply:function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;this.w*=a.w},divideScalar:function(a){this.x/=
a;this.y/=a;this.z/=a;this.w/=a},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w},equals:function(a,c){c||(c=0);return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)+Math.abs(this.w-a.w)<=c},isVector4:!0,dimension:4};d.Immutable=function(a,c,e,b){this.x=a||0;this.y=c||0;this.z=e||0;this.w=void 0!==b?b:1};var b=d.Immutable;b.prototype=new phet.math.Vector4;b.prototype.constructor=b;b.mutableOverrideHelper=function(a){b.prototype[a]=function(){throw Error("Cannot call mutable method '"+
a+"' on immutable Vector4");}};b.mutableOverrideHelper("set");b.mutableOverrideHelper("setX");b.mutableOverrideHelper("setY");b.mutableOverrideHelper("setZ");b.mutableOverrideHelper("setW");b.mutableOverrideHelper("copy");b.mutableOverrideHelper("add");b.mutableOverrideHelper("addScalar");b.mutableOverrideHelper("subtract");b.mutableOverrideHelper("subtractScalar");b.mutableOverrideHelper("componentMultiply");b.mutableOverrideHelper("divideScalar");b.mutableOverrideHelper("negate");d.ZERO=new b(0,
0,0,0);d.X_UNIT=new b(1,0,0,0);d.Y_UNIT=new b(0,1,0,0);d.Z_UNIT=new b(0,0,1,0);d.W_UNIT=new b(0,0,0,1)})();phet=phet||{};phet.math=phet.math||{};
(function(){phet.math.Matrix3=function(a,e,b,d,g,h,m,n,p,q){this.entries=Array(9);this.rowMajor(void 0===a?1:a,e||0,b||0,d||0,void 0===g?1:g,h||0,m||0,n||0,void 0===p?1:p,q)};phet.math.Matrix3.Types={OTHER:0,IDENTITY:1,TRANSLATION_2D:2,SCALING:3,AFFINE:4};var d=phet.math.Matrix3,b=phet.math.Vector3,a=d.Types;d.identity=function(){return new d(1,0,0,0,1,0,0,0,1,a.IDENTITY)};d.translation=function(c,e){return new d(1,0,c,0,1,e,0,0,1,a.TRANSLATION_2D)};d.translationFromVector=function(a){return d.translation(a.x,
a.y)};d.scaling=function(c,e){return new d(c,0,0,0,void 0===e?c:e,0,0,0,1,a.SCALING)};d.rotationAxisAngle=function(c,e){var b=Math.cos(e),k=Math.sin(e),g=1-b;return new d(c.x*c.x*g+b,c.x*c.y*g-c.z*k,c.x*c.z*g+c.y*k,c.y*c.x*g+c.z*k,c.y*c.y*g+b,c.y*c.z*g-c.x*k,c.z*c.x*g-c.y*k,c.z*c.y*g+c.x*k,c.z*c.z*g+b,a.OTHER)};d.rotationX=function(c){var e=Math.cos(c);c=Math.sin(c);return new d(1,0,0,0,e,-c,0,c,e,a.OTHER)};d.rotationY=function(c){var e=Math.cos(c);c=Math.sin(c);return new d(e,0,c,0,1,0,-c,0,e,a.OTHER)};
d.rotationZ=function(c){var e=Math.cos(c);c=Math.sin(c);return new d(e,-c,0,c,e,0,0,0,1,a.AFFINE)};d.rotation2=d.rotationZ;d.fromSVGMatrix=function(c){return new d(c.a,c.c,c.e,c.b,c.d,c.f,0,0,1,a.AFFINE)};d.rotateAToB=function(a,e){var f,k,g=a.cross(e);f=a.dot(e);if(0.9999<(0>f?-f:f)){var h,m,g=new b(0<a.x?a.x:-a.x,0<a.y?a.y:-a.y,0<a.z?a.z:-a.z),g=g.x<g.y?g.x<g.z?b.X_UNIT:b.Z_UNIT:g.y<g.z?b.Y_UNIT:b.Z_UNIT;f=g.minus(a);g=g.minus(e);k=2/f.dot(f);h=2/g.dot(g);m=k*h*f.dot(g);return d.IDENTITY.plus(d.rowMajor(-k*
f.x*f.x-h*g.x*g.x+m*g.x*f.x,-k*f.x*f.y-h*g.x*g.y+m*g.x*f.y,-k*f.x*f.z-h*g.x*g.z+m*g.x*f.z,-k*f.y*f.x-h*g.y*g.x+m*g.y*f.x,-k*f.y*f.y-h*g.y*g.y+m*g.y*f.y,-k*f.y*f.z-h*g.y*g.z+m*g.y*f.z,-k*f.z*f.x-h*g.z*g.x+m*g.z*f.x,-k*f.z*f.y-h*g.z*g.y+m*g.z*f.y,-k*f.z*f.z-h*g.z*g.z+m*g.z*f.z))}var n,p,q;k=1/(1+f);h=k*g.x;m=k*g.z;n=h*g.y;p=h*g.z;q=m*g.y;return d.rowMajor(f+h*g.x,n-g.z,p+g.y,n+g.z,f+k*g.y*g.y,q-g.x,p-g.y,q+g.x,f+m*g.z)};d.prototype={constructor:d,rowMajor:function(c,e,b,d,g,h,m,n,p,q){this.entries[0]=
c;this.entries[1]=d;this.entries[2]=m;this.entries[3]=e;this.entries[4]=g;this.entries[5]=n;this.entries[6]=b;this.entries[7]=h;this.entries[8]=p;this.type=void 0===q?0===m&&0===n&&1===p?a.AFFINE:a.OTHER:q},columnMajor:function(a,e,b,d,g,h,m,n,p,q){this.rowMajor(a,d,m,e,g,n,b,h,p,q)},m00:function(){return this.entries[0]},m01:function(){return this.entries[3]},m02:function(){return this.entries[6]},m10:function(){return this.entries[1]},m11:function(){return this.entries[4]},m12:function(){return this.entries[7]},
m20:function(){return this.entries[2]},m21:function(){return this.entries[5]},m22:function(){return this.entries[8]},plus:function(a){return new d(this.m00()+a.m00(),this.m01()+a.m01(),this.m02()+a.m02(),this.m10()+a.m10(),this.m11()+a.m11(),this.m12()+a.m12(),this.m20()+a.m20(),this.m21()+a.m21(),this.m22()+a.m22())},minus:function(a){return new d(this.m00()-a.m00(),this.m01()-a.m01(),this.m02()-a.m02(),this.m10()-a.m10(),this.m11()-a.m11(),this.m12()-a.m12(),this.m20()-a.m20(),this.m21()-a.m21(),
this.m22()-a.m22())},transposed:function(){return new d(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===a.IDENTITY||this.type===a.SCALING?this.type:void 0)},negated:function(){return new d(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},inverted:function(){var a=this.determinant();if(0!==a)return new d((-this.m12()*this.m21()+this.m11()*this.m22())/a,(this.m02()*this.m21()-
this.m01()*this.m22())/a,(-this.m02()*this.m11()+this.m01()*this.m12())/a,(this.m12()*this.m20()-this.m10()*this.m22())/a,(-this.m02()*this.m20()+this.m00()*this.m22())/a,(this.m02()*this.m10()-this.m00()*this.m12())/a,(-this.m11()*this.m20()+this.m10()*this.m21())/a,(this.m01()*this.m20()-this.m00()*this.m21())/a,(-this.m01()*this.m10()+this.m00()*this.m11())/a,this.type);throw Error("Matrix could not be inverted, determinant === 0");},timesMatrix:function(c){if(this.type===a.IDENTITY||c.type===
a.IDENTITY)return this.type===a.IDENTITY?c:this;if(this.type===c.type){if(this.type===a.TRANSLATION_2D)return new d(1,0,this.m02()+c.m02(),0,1,this.m12()+c.m12(),0,0,1,a.TRANSLATION_2D);if(this.type===a.SCALING)return new d(this.m00()*c.m00(),0,0,0,this.m11()*c.m11(),0,0,0,1,a.SCALING)}return this.type!==a.OTHER&&c.type!==a.OTHER?new d(this.m00()*c.m00()+this.m01()*c.m10(),this.m00()*c.m01()+this.m01()*c.m11(),this.m00()*c.m02()+this.m01()*c.m12()+this.m02(),this.m10()*c.m00()+this.m11()*c.m10(),
this.m10()*c.m01()+this.m11()*c.m11(),this.m10()*c.m02()+this.m11()*c.m12()+this.m12(),0,0,1,a.AFFINE):new d(this.m00()*c.m00()+this.m01()*c.m10()+this.m02()*c.m20(),this.m00()*c.m01()+this.m01()*c.m11()+this.m02()*c.m21(),this.m00()*c.m02()+this.m01()*c.m12()+this.m02()*c.m22(),this.m10()*c.m00()+this.m11()*c.m10()+this.m12()*c.m20(),this.m10()*c.m01()+this.m11()*c.m11()+this.m12()*c.m21(),this.m10()*c.m02()+this.m11()*c.m12()+this.m12()*c.m22(),this.m20()*c.m00()+this.m21()*c.m10()+this.m22()*c.m20(),
this.m20()*c.m01()+this.m21()*c.m11()+this.m22()*c.m21(),this.m20()*c.m02()+this.m21()*c.m12()+this.m22()*c.m22())},timesVector2:function(a){var e=this.m00()*a.x+this.m01()*a.y+this.m02();a=this.m10()*a.x+this.m11()*a.y+this.m12();return new phet.math.Vector2(e,a)},timesVector3:function(a){var e=this.m00()*a.x+this.m01()*a.y+this.m02()*a.z,b=this.m10()*a.x+this.m11()*a.y+this.m12()*a.z;a=this.m20()*a.x+this.m21()*a.y+this.m22()*a.z;return new phet.math.Vector3(e,b,a)},timesTransposeVector2:function(a){var e=
this.m00()*a.x+this.m10()*a.y;a=this.m01()*a.x+this.m11()*a.y;return new phet.math.Vector2(e,a)},timesRelativeVector2:function(a){var e=this.m00()*a.x+this.m10()*a.y;a=this.m01()*a.y+this.m11()*a.y;return new phet.math.Vector2(e,a)},determinant:function(){return this.m00()*this.m11()*this.m22()+this.m01()*this.m12()*this.m20()+this.m02()*this.m10()*this.m21()-this.m02()*this.m11()*this.m20()-this.m01()*this.m10()*this.m22()-this.m00()*this.m12()*this.m21()},isAffine:function(){return this.type===
a.AFFINE||0===this.m20()&&0===this.m21()&&1===this.m22()},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()},toMatrix4:function(){return new phet.math.Matrix4(this.m00(),this.m01(),this.m02(),0,this.m10(),this.m11(),this.m12(),0,this.m20(),this.m21(),this.m22(),0,0,0,0,1)},translation:function(){return new phet.math.Vector2(this.m02(),this.m12())},scaling:function(){return new phet.math.Vector3(this.m00(),
this.m11(),this.m22())},rotation:function(){var a=this.timesVector2(phet.math.Vector2.X_UNIT).minus(this.timesVector2(phet.math.Vector2.ZERO));return Math.atan2(a.y,a.x)},makeImmutable:function(){this.rowMajor=function(){throw Error("Cannot modify immutable matrix");}},toSVGMatrix:function(){var a=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();a.a=this.m00();a.b=this.m10();a.c=this.m01();a.d=this.m11();a.e=this.m02();a.f=this.m12();return a},canvasSetTransform:function(a){a.setTransform(this.entries[0],
this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},canvasAppendTransform:function(a){a.transform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},cssTransform:function(){return"matrix("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+")"},svgTransform:function(){switch(this.type){case a.IDENTITY:return"";
case a.TRANSLATION_2D:return"translate("+this.entries[6].toFixed(20)+","+this.entries[7]+")";case a.SCALING:return"scale("+this.entries[0].toFixed(20)+(this.entries[0]===this.entries[4]?"":","+this.entries[4].toFixed(20))+")";default:return"matrix("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+")"}},cssTransformStyles:function(){var a=this.cssTransform();return{"-webkit-transform":a+
" translateZ(0)","-moz-transform":a+" translateZ(0)","-ms-transform":a,"-o-transform":a,transform:a,"transform-origin":"top left","-ms-transform-origin":"top left"}}};d.IDENTITY=new d(1,0,0,0,1,0,0,0,1,a.IDENTITY);d.IDENTITY.makeImmutable()})();phet=phet||{};phet.math=phet.math||{};
(function(){var d=phet.Float32Array;phet.math.Matrix4=function(a,e,b,k,g,h,m,n,p,q,t,s,u,j,r,l,v){this.entries=new d(16);this.rowMajor(void 0===a?1:a,e||0,b||0,k||0,g||0,void 0===h?1:h,m||0,n||0,p||0,q||0,void 0===t?1:t,s||0,u||0,j||0,r||0,void 0===l?1:l,v)};phet.math.Matrix4.Types={OTHER:0,IDENTITY:1,TRANSLATION_3D:2,SCALING:3};var b=phet.math.Matrix4,a=b.Types;b.identity=function(){return new b(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,a.IDENTITY)};b.translation=function(c,e,f){return new b(1,0,0,c,0,1,0,
e,0,0,1,f,0,0,0,1,a.TRANSLATION_3D)};b.translationFromVector=function(a){return b.translation(a.x,a.y,a.z)};b.scaling=function(c,e,f){return new b(c,0,0,0,0,void 0===e?c:e,0,0,0,0,void 0===f?c:f,0,0,0,0,1,a.SCALING)};b.rotationAxisAngle=function(c,e){var f=Math.cos(e),d=Math.sin(e),g=1-f;return new b(c.x*c.x*g+f,c.x*c.y*g-c.z*d,c.x*c.z*g+c.y*d,0,c.y*c.x*g+c.z*d,c.y*c.y*g+f,c.y*c.z*g-c.x*d,0,c.z*c.x*g-c.y*d,c.z*c.y*g+c.x*d,c.z*c.z*g+f,0,0,0,0,1,a.OTHER)};b.rotationX=function(c){var e=Math.cos(c);c=
Math.sin(c);return new b(1,0,0,0,0,e,-c,0,0,c,e,0,0,0,0,1,a.OTHER)};b.rotationY=function(c){var e=Math.cos(c);c=Math.sin(c);return new b(e,0,c,0,0,1,0,0,-c,0,e,0,0,0,0,1,a.OTHER)};b.rotationZ=function(c){var e=Math.cos(c);c=Math.sin(c);return new b(e,-c,0,0,c,e,0,0,0,0,1,0,0,0,0,1,a.OTHER)};b.gluPerspective=function(a,e,f,d){a=Math.cos(a)/Math.sin(a);return new b(a/e,0,0,0,0,a,0,0,0,0,(d+f)/(f-d),2*d*f/(f-d),0,0,-1,0)};b.prototype={constructor:b,rowMajor:function(c,e,b,d,g,h,m,n,p,q,t,s,u,j,r,l,v){this.entries[0]=
c;this.entries[1]=g;this.entries[2]=p;this.entries[3]=u;this.entries[4]=e;this.entries[5]=h;this.entries[6]=q;this.entries[7]=j;this.entries[8]=b;this.entries[9]=m;this.entries[10]=t;this.entries[11]=r;this.entries[12]=d;this.entries[13]=n;this.entries[14]=s;this.entries[15]=l;this.type=void 0===v?a.OTHER:v},columnMajor:function(a,e,b,d,g,h,m,n,p,q,t,s,u,j,r,l,v){this.rowMajor(a,g,p,u,e,h,q,j,b,m,t,r,d,n,s,l,v)},m00:function(){return this.entries[0]},m01:function(){return this.entries[4]},m02:function(){return this.entries[8]},
m03:function(){return this.entries[12]},m10:function(){return this.entries[1]},m11:function(){return this.entries[5]},m12:function(){return this.entries[9]},m13:function(){return this.entries[13]},m20:function(){return this.entries[2]},m21:function(){return this.entries[6]},m22:function(){return this.entries[10]},m23:function(){return this.entries[14]},m30:function(){return this.entries[3]},m31:function(){return this.entries[7]},m32:function(){return this.entries[11]},m33:function(){return this.entries[15]},
plus:function(a){return new b(this.m00()+a.m00(),this.m01()+a.m01(),this.m02()+a.m02(),this.m03()+a.m03(),this.m10()+a.m10(),this.m11()+a.m11(),this.m12()+a.m12(),this.m13()+a.m13(),this.m20()+a.m20(),this.m21()+a.m21(),this.m22()+a.m22(),this.m23()+a.m23(),this.m30()+a.m30(),this.m31()+a.m31(),this.m32()+a.m32(),this.m33()+a.m33())},minus:function(a){return new b(this.m00()-a.m00(),this.m01()-a.m01(),this.m02()-a.m02(),this.m03()-a.m03(),this.m10()-a.m10(),this.m11()-a.m11(),this.m12()-a.m12(),this.m13()-
a.m13(),this.m20()-a.m20(),this.m21()-a.m21(),this.m22()-a.m22(),this.m23()-a.m23(),this.m30()-a.m30(),this.m31()-a.m31(),this.m32()-a.m32(),this.m33()-a.m33())},transposed:function(){return new b(this.m00(),this.m10(),this.m20(),this.m30(),this.m01(),this.m11(),this.m21(),this.m31(),this.m02(),this.m12(),this.m22(),this.m32(),this.m03(),this.m13(),this.m23(),this.m33())},negated:function(){return new b(-this.m00(),-this.m01(),-this.m02(),-this.m03(),-this.m10(),-this.m11(),-this.m12(),-this.m13(),
-this.m20(),-this.m21(),-this.m22(),-this.m23(),-this.m30(),-this.m31(),-this.m32(),-this.m33())},inverted:function(){var a=this.determinant();if(0!==a)return new b((-this.m31()*this.m22()*this.m13()+this.m21()*this.m32()*this.m13()+this.m31()*this.m12()*this.m23()-this.m11()*this.m32()*this.m23()-this.m21()*this.m12()*this.m33()+this.m11()*this.m22()*this.m33())/a,(this.m31()*this.m22()*this.m03()-this.m21()*this.m32()*this.m03()-this.m31()*this.m02()*this.m23()+this.m01()*this.m32()*this.m23()+
this.m21()*this.m02()*this.m33()-this.m01()*this.m22()*this.m33())/a,(-this.m31()*this.m12()*this.m03()+this.m11()*this.m32()*this.m03()+this.m31()*this.m02()*this.m13()-this.m01()*this.m32()*this.m13()-this.m11()*this.m02()*this.m33()+this.m01()*this.m12()*this.m33())/a,(this.m21()*this.m12()*this.m03()-this.m11()*this.m22()*this.m03()-this.m21()*this.m02()*this.m13()+this.m01()*this.m22()*this.m13()+this.m11()*this.m02()*this.m23()-this.m01()*this.m12()*this.m23())/a,(this.m30()*this.m22()*this.m13()-
this.m20()*this.m32()*this.m13()-this.m30()*this.m12()*this.m23()+this.m10()*this.m32()*this.m23()+this.m20()*this.m12()*this.m33()-this.m10()*this.m22()*this.m33())/a,(-this.m30()*this.m22()*this.m03()+this.m20()*this.m32()*this.m03()+this.m30()*this.m02()*this.m23()-this.m00()*this.m32()*this.m23()-this.m20()*this.m02()*this.m33()+this.m00()*this.m22()*this.m33())/a,(this.m30()*this.m12()*this.m03()-this.m10()*this.m32()*this.m03()-this.m30()*this.m02()*this.m13()+this.m00()*this.m32()*this.m13()+
this.m10()*this.m02()*this.m33()-this.m00()*this.m12()*this.m33())/a,(-this.m20()*this.m12()*this.m03()+this.m10()*this.m22()*this.m03()+this.m20()*this.m02()*this.m13()-this.m00()*this.m22()*this.m13()-this.m10()*this.m02()*this.m23()+this.m00()*this.m12()*this.m23())/a,(-this.m30()*this.m21()*this.m13()+this.m20()*this.m31()*this.m13()+this.m30()*this.m11()*this.m23()-this.m10()*this.m31()*this.m23()-this.m20()*this.m11()*this.m33()+this.m10()*this.m21()*this.m33())/a,(this.m30()*this.m21()*this.m03()-
this.m20()*this.m31()*this.m03()-this.m30()*this.m01()*this.m23()+this.m00()*this.m31()*this.m23()+this.m20()*this.m01()*this.m33()-this.m00()*this.m21()*this.m33())/a,(-this.m30()*this.m11()*this.m03()+this.m10()*this.m31()*this.m03()+this.m30()*this.m01()*this.m13()-this.m00()*this.m31()*this.m13()-this.m10()*this.m01()*this.m33()+this.m00()*this.m11()*this.m33())/a,(this.m20()*this.m11()*this.m03()-this.m10()*this.m21()*this.m03()-this.m20()*this.m01()*this.m13()+this.m00()*this.m21()*this.m13()+
this.m10()*this.m01()*this.m23()-this.m00()*this.m11()*this.m23())/a,(this.m30()*this.m21()*this.m12()-this.m20()*this.m31()*this.m12()-this.m30()*this.m11()*this.m22()+this.m10()*this.m31()*this.m22()+this.m20()*this.m11()*this.m32()-this.m10()*this.m21()*this.m32())/a,(-this.m30()*this.m21()*this.m02()+this.m20()*this.m31()*this.m02()+this.m30()*this.m01()*this.m22()-this.m00()*this.m31()*this.m22()-this.m20()*this.m01()*this.m32()+this.m00()*this.m21()*this.m32())/a,(this.m30()*this.m11()*this.m02()-
this.m10()*this.m31()*this.m02()-this.m30()*this.m01()*this.m12()+this.m00()*this.m31()*this.m12()+this.m10()*this.m01()*this.m32()-this.m00()*this.m11()*this.m32())/a,(-this.m20()*this.m11()*this.m02()+this.m10()*this.m21()*this.m02()+this.m20()*this.m01()*this.m12()-this.m00()*this.m21()*this.m12()-this.m10()*this.m01()*this.m22()+this.m00()*this.m11()*this.m22())/a);throw Error("Matrix could not be inverted, determinant === 0");},timesMatrix:function(c){var e=a.OTHER;this.type===a.TRANSLATION_3D&&
c.type===a.TRANSLATION_3D&&(e=a.TRANSLATION_3D);this.type===a.SCALING&&c.type===a.SCALING&&(e=a.SCALING);this.type===a.IDENTITY&&(e=c.type);c.type===a.IDENTITY&&(e=this.type);return new b(this.m00()*c.m00()+this.m01()*c.m10()+this.m02()*c.m20()+this.m03()*c.m30(),this.m00()*c.m01()+this.m01()*c.m11()+this.m02()*c.m21()+this.m03()*c.m31(),this.m00()*c.m02()+this.m01()*c.m12()+this.m02()*c.m22()+this.m03()*c.m32(),this.m00()*c.m03()+this.m01()*c.m13()+this.m02()*c.m23()+this.m03()*c.m33(),this.m10()*
c.m00()+this.m11()*c.m10()+this.m12()*c.m20()+this.m13()*c.m30(),this.m10()*c.m01()+this.m11()*c.m11()+this.m12()*c.m21()+this.m13()*c.m31(),this.m10()*c.m02()+this.m11()*c.m12()+this.m12()*c.m22()+this.m13()*c.m32(),this.m10()*c.m03()+this.m11()*c.m13()+this.m12()*c.m23()+this.m13()*c.m33(),this.m20()*c.m00()+this.m21()*c.m10()+this.m22()*c.m20()+this.m23()*c.m30(),this.m20()*c.m01()+this.m21()*c.m11()+this.m22()*c.m21()+this.m23()*c.m31(),this.m20()*c.m02()+this.m21()*c.m12()+this.m22()*c.m22()+
this.m23()*c.m32(),this.m20()*c.m03()+this.m21()*c.m13()+this.m22()*c.m23()+this.m23()*c.m33(),this.m30()*c.m00()+this.m31()*c.m10()+this.m32()*c.m20()+this.m33()*c.m30(),this.m30()*c.m01()+this.m31()*c.m11()+this.m32()*c.m21()+this.m33()*c.m31(),this.m30()*c.m02()+this.m31()*c.m12()+this.m32()*c.m22()+this.m33()*c.m32(),this.m30()*c.m03()+this.m31()*c.m13()+this.m32()*c.m23()+this.m33()*c.m33(),e)},timesVector4:function(a){var e=this.m00()*a.x+this.m01()*a.y+this.m02()*a.z+this.m03()*a.w,b=this.m10()*
a.x+this.m11()*a.y+this.m12()*a.z+this.m13()*a.w,d=this.m20()*a.x+this.m21()*a.y+this.m22()*a.z+this.m23()*a.w;a=this.m30()*a.x+this.m31()*a.y+this.m32()*a.z+this.m33()*a.w;return new phet.math.Vector4(e,b,d,a)},timesVector3:function(a){return this.timesVector4(a.toVector4()).toVector3()},timesTransposeVector4:function(a){var e=this.m00()*a.x+this.m10()*a.y+this.m20()*a.z+this.m30()*a.w,b=this.m01()*a.x+this.m11()*a.y+this.m21()*a.z+this.m31()*a.w,d=this.m02()*a.x+this.m12()*a.y+this.m22()*a.z+this.m32()*
a.w;a=this.m03()*a.x+this.m13()*a.y+this.m23()*a.z+this.m33()*a.w;return new phet.math.Vector4(e,b,d,a)},timesTransposeVector3:function(a){return this.timesTransposeVector4(a.toVector4()).toVector3()},timesRelativeVector3:function(a){var e=this.m00()*a.x+this.m10()*a.y+this.m20()*a.z,b=this.m01()*a.y+this.m11()*a.y+this.m21()*a.z;a=this.m02()*a.z+this.m12()*a.y+this.m22()*a.z;return new phet.math.Vector3(e,b,a)},determinant:function(){return this.m03()*this.m12()*this.m21()*this.m30()-this.m02()*
this.m13()*this.m21()*this.m30()-this.m03()*this.m11()*this.m22()*this.m30()+this.m01()*this.m13()*this.m22()*this.m30()+this.m02()*this.m11()*this.m23()*this.m30()-this.m01()*this.m12()*this.m23()*this.m30()-this.m03()*this.m12()*this.m20()*this.m31()+this.m02()*this.m13()*this.m20()*this.m31()+this.m03()*this.m10()*this.m22()*this.m31()-this.m00()*this.m13()*this.m22()*this.m31()-this.m02()*this.m10()*this.m23()*this.m31()+this.m00()*this.m12()*this.m23()*this.m31()+this.m03()*this.m11()*this.m20()*
this.m32()-this.m01()*this.m13()*this.m20()*this.m32()-this.m03()*this.m10()*this.m21()*this.m32()+this.m00()*this.m13()*this.m21()*this.m32()+this.m01()*this.m10()*this.m23()*this.m32()-this.m00()*this.m11()*this.m23()*this.m32()-this.m02()*this.m11()*this.m20()*this.m33()+this.m01()*this.m12()*this.m20()*this.m33()+this.m02()*this.m10()*this.m21()*this.m33()-this.m00()*this.m12()*this.m21()*this.m33()-this.m01()*this.m10()*this.m22()*this.m33()+this.m00()*this.m11()*this.m22()*this.m33()},toString:function(){return this.m00()+
" "+this.m01()+" "+this.m02()+" "+this.m03()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+" "+this.m13()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()+" "+this.m23()+"\n"+this.m30()+" "+this.m31()+" "+this.m32()+" "+this.m33()},translation:function(){return new phet.math.Vector3(this.m03(),this.m13(),this.m23())},scaling:function(){return new phet.math.Vector3(this.m00(),this.m11(),this.m22())},makeImmutable:function(){this.rowMajor=function(){throw Error("Cannot modify immutable matrix");}}};b.IDENTITY=
new b;b.IDENTITY.makeImmutable()})();phet=phet||{};phet.math=phet.math||{};(function(){phet.math.Ray2=function(b,a){this.pos=b;this.dir=a;phet.debugAssert(function(){return 0.01>Math.abs(a.magnitude()-1)})};var d=phet.math.Ray2;d.prototype={constructor:d,shifted:function(b){return new d(this.pointAtDistance(b),this.dir)},pointAtDistance:function(b){return this.pos.plus(this.dir.timesScalar(b))},toString:function(){return this.pos.toString()+" => "+this.dir.toString()}}})();phet=phet||{};
phet.math=phet.math||{};(function(){phet.math.Ray3=function(b,a){this.pos=b;this.dir=a};var d=phet.math.Ray3;d.prototype={constructor:d,shifted:function(b){return new d(this.pointAtDistance(b),this.dir)},pointAtDistance:function(b){return this.pos.plus(this.dir.timesScalar(b))},toString:function(){return this.pos.toString()+" => "+this.dir.toString()}}})();phet=phet||{};phet.math=phet.math||{};
(function(){var d=phet.math.Matrix3,b=phet.math.Vector2;phet.math.Transform3=function(a){this.set(void 0===a?d.IDENTITY:a)};var a=phet.math.Transform3;a.prototype={constructor:a,set:function(a){phet.assert(a instanceof phet.math.Matrix3);this.matrix=a;this.inverseTransposed=this.matrixTransposed=this.inverse=null},prepend:function(a){this.set(a.timesMatrix(this.matrix))},append:function(a){this.set(this.matrix.timesMatrix(a))},prependTransform:function(a){this.prepend(a.matrix)},appendTransform:function(a){this.append(a.matrix)},
applyToCanvasContext:function(a){a.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m02(),this.matrix.m12())},getMatrix:function(){return this.matrix},getInverse:function(){null===this.inverse&&(this.inverse=this.matrix.inverted());return this.inverse},getMatrixTransposed:function(){null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed());return this.matrixTransposed},getInverseTransposed:function(){null===this.inverseTransposed&&
(this.inverseTransposed=this.getInverse().transposed());return this.inverseTransposed},isIdentity:function(){return this.matrix.type===d.Types.IDENTITY},transformPosition2:function(a){return this.matrix.timesVector2(a)},transformDelta2:function(a){return this.matrix.timesRelativeVector2(a)},transformNormal2:function(a){return this.getInverse().timesTransposeVector2(a)},transformDeltaX:function(a){return this.transformDelta2(new b(a,0)).x},transformDeltaY:function(a){return this.transformDelta2(new b(0,
a)).y},transformBounds2:function(a){return a.transformed(this.matrix)},transformShape:function(a){return a.transformed(this.matrix)},inversePosition2:function(a){return this.getInverse().timesVector2(a)},inverseDelta2:function(a){return this.inversePosition2(a).minus(this.inversePosition2(b.ZERO))},inverseNormal2:function(a){return this.matrix.timesTransposeVector2(a)},inverseDeltaX:function(a){return this.inverseDelta2(new b(a,0)).x},inverseDeltaY:function(a){return this.inverseDelta2(new b(0,a)).y},
inverseBounds2:function(a){return a.transformed(this.getInverse())},inverseShape:function(a){return a.transformed(this.getInverse())}}})();phet=phet||{};phet.math=phet.math||{};
(function(){var d=phet.math.Matrix4,b=phet.math.Vector3;phet.math.Transform4=function(a){this.set(void 0===a?d.IDENTITY:a)};var a=phet.math.Transform4;a.prototype={constructor:a,set:function(a){this.matrix=a;this.inverseTransposed=this.matrixTransposed=this.inverse=null},getMatrix:function(){return this.matrix},getInverse:function(){null===this.inverse&&(this.inverse=this.matrix.inverted());return this.inverse},getMatrixTransposed:function(){null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed());
return this.matrixTransposed},getInverseTransposed:function(){null===this.inverseTransposed&&(this.inverseTransposed=this.getInverse().transposed());return this.inverseTransposed},prepend:function(a){this.set(a.timesMatrix(this.matrix))},append:function(a){this.set(this.matrix.timesMatrix(a))},prependTransform:function(a){this.prepend(a.matrix)},appendTransform:function(a){this.append(a.matrix)},isIdentity:function(){return this.matrix.type===d.Types.IDENTITY},applyToCanvasContext:function(a){a.setTransform(this.matrix.m00(),
this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m03(),this.matrix.m13())},transformPosition3:function(a){return this.matrix.timesVector3(a)},transformDelta3:function(a){return this.matrix.timesRelativeVector3(a)},transformNormal3:function(a){return this.getInverse().timesTransposeVector3(a)},transformDeltaX:function(a){return this.transformDelta3(new b(a,0,0)).x},transformDeltaY:function(a){return this.transformDelta3(new b(0,a,0)).y},transformDeltaZ:function(a){return this.transformDelta3(new b(0,
0,a)).z},transformRay:function(a){return new phet.math.Ray3(this.transformPosition3(a.pos),this.transformPosition3(a.pos.plus(a.dir)).minus(this.transformPosition3(a.pos)))},inversePosition3:function(a){return this.getInverse().timesVector3(a)},inverseDelta3:function(a){return this.inversePosition3(a).minus(this.inversePosition3(b.ZERO))},inverseNormal3:function(a){return this.matrix.timesTransposeVector3(a)},inverseDeltaX:function(a){return this.inverseDelta3(new b(a,0,0)).x},inverseDeltaY:function(a){return this.inverseDelta3(new b(0,
a,0)).y},inverseDeltaZ:function(a){return this.inverseDelta3(new b(0,0,a)).z},inverseRay:function(a){return new phet.math.Ray3(this.inversePosition3(a.pos),this.inversePosition3(a.pos.plus(a.dir)).minus(this.inversePosition3(a.pos)))}}})();phet=phet||{};phet.math=phet.math||{};
(function(){function d(a,c,e){if(0===a.length)e.call(void 0,c);else for(var b=0;b<a.length;b++){var k=a[b],g=a.slice(0);g.splice(b,1);var h=c.slice(0);h.push(k);d(g,h,e)}}phet.math.Permutation=function(a){this.indices=a};var b=phet.math.Permutation;b.identity=function(a){phet.assert(0<=a);for(var c=Array(a),e=0;e<a;e++)c[e]=e;return new b(c)};b.permutations=function(a){var c=[];b.forEachPermutation(phet.util.rangeInclusive(0,a-1),function(a){c.push(new b(a))});return c};b.forEachPermutation=function(a,
c){d(a,[],c)};phet.math.Permutation.prototype={constructor:b,size:function(){return this.indices.length},apply:function(a){if(phet.util.isArray(a)){if(a.length!==this.size())throw Error("Permutation length "+this.size()+" not equal to list length "+a.length);for(var c=Array(a.length),e=0;e<a.length;e++)c[e]=a[this.indices[e]];return c}return this.indices[a]},inverted:function(){for(var a=Array(this.size()),c=0;c<this.size();c++)a[this.indices[c]]=c;return new b(a)},withIndicesPermuted:function(a){var c=
[],e=this;b.forEachPermutation(a,function(f){for(var d=e.indices,g=d.slice(0),h=0;h<a.length;h++)g[a[h]]=d[f[h]];c.push(new b(g))});return c},toString:function(){return"P["+phet.util.mkString(this.indices,", ")+"]"}};b.testMe=function(a){var c=new b([1,4,3,2,0]);a.log(c.toString());c=c.inverted();a.log(c.toString());a.log(c.withIndicesPermuted([0,3,4]).toString());a.log(b.permutations(4).toString())}})();phet=phet||{};phet.math=phet.math||{};
(function(){var d=phet.Float32Array;phet.math.Matrix=function(a,c,e,b){this.m=a;this.n=c;this.size=a*=c;if(b)this.entries=e;else if(e||(e=0),this.entries=new d(a),phet.util.isArray(e)){phet.assert(e.length===a);for(b=0;b<a;b++)this.entries[b]=e[b]}else for(b=0;b<a;b++)this.entries[b]=e};var b=phet.math.Matrix;b.hypot=function(a,c){var e;Math.abs(a)>Math.abs(c)?(e=c/a,e=Math.abs(a)*Math.sqrt(1+e*e)):0!==c?(e=a/c,e=Math.abs(c)*Math.sqrt(1+e*e)):e=0;return e};b.prototype={constructor:b,copy:function(){for(var a=
new b(this.m,this.n),c=0;c<this.size;c++)a.entries[c]=this.entries[c];return a},getArray:function(){return this.entries},getArrayCopy:function(){return new d(this.entries)},getRowDimension:function(){return this.m},getColumnDimension:function(){return this.n},index:function(a,c){return a*this.n+c},get:function(a,c){return this.entries[this.index(a,c)]},set:function(a,c,e){this.entries[this.index(a,c)]=e},getMatrix:function(a,c,e,f){for(var d=new b(c-a+1,f-e+1),g=a;g<=c;g++)for(var h=e;h<=f;h++)d.entries[d.index(g-
a,h-e)]=this.entries[this.index(g,h)];return d},getArrayRowMatrix:function(a,c,e){for(var f=new b(a.length,e-c+1),d=0;d<a.length;d++)for(var g=c;g<=e;g++)f.entries[f.index(d,g-c)]=this.entries[this.index(a[d],g)];return f},transpose:function(){for(var a=new b(this.n,this.m),c=0;c<this.m;c++)for(var e=0;e<this.n;e++)a.entries[a.index(e,c)]=this.entries[this.index(c,e)];return a},norm1:function(){for(var a=0,c=0;c<this.n;c++){for(var e=0,b=0;b<this.m;b++)e+=Math.abs(this.entries[this.index(b,c)]);a=
Math.max(a,e)}return a},norm2:function(){return(new phet.math.SingularValueDecomposition(this)).norm2()},normInf:function(){for(var a=0,c=0;c<this.m;c++){for(var e=0,b=0;b<this.n;b++)e+=Math.abs(this.entries[this.index(c,b)]);a=Math.max(a,e)}return a},normF:function(){for(var a=0,c=0;c<this.m;c++)for(var e=0;e<this.n;e++)a=b.hypot(a,this.entries[this.index(c,e)]);return a},uminus:function(){for(var a=new b(this.m,this.n),c=0;c<this.m;c++)for(var e=0;e<this.n;e++)a.entries[a.index(c,e)]=-this.entries[this.index(c,
e)];return a},plus:function(a){this.checkMatrixDimensions(a);for(var c=new b(this.m,this.n),e=0;e<this.m;e++)for(var f=0;f<this.n;f++){var d=c.index(e,f);c.entries[d]=this.entries[d]+a.entries[d]}return c},plusEquals:function(a){this.checkMatrixDimensions(a);for(var c=new b(this.m,this.n),e=0;e<this.m;e++)for(var f=0;f<this.n;f++){var d=c.index(e,f);this.entries[d]+=a.entries[d]}return this},minus:function(a){this.checkMatrixDimensions(a);for(var c=new b(this.m,this.n),e=0;e<this.m;e++)for(var f=
0;f<this.n;f++){var d=this.index(e,f);c.entries[d]=this.entries[d]-a.entries[d]}return c},minusEquals:function(a){this.checkMatrixDimensions(a);for(var c=0;c<this.m;c++)for(var e=0;e<this.n;e++){var b=this.index(c,e);this.entries[b]-=a.entries[b]}return this},arrayTimes:function(a){this.checkMatrixDimensions(a);for(var c=new b(this.m,this.n),e=0;e<this.m;e++)for(var f=0;f<this.n;f++){var d=c.index(e,f);c.entries[d]=this.entries[d]*a.entries[d]}return c},arrayTimesEquals:function(a){this.checkMatrixDimensions(a);
for(var c=0;c<this.m;c++)for(var e=0;e<this.n;e++){var b=this.index(c,e);this.entries[b]*=a.entries[b]}return this},arrayRightDivide:function(a){this.checkMatrixDimensions(a);for(var c=new b(this.m,this.n),e=0;e<this.m;e++)for(var f=0;f<this.n;f++){var d=this.index(e,f);c.entries[d]=this.entries[d]/a.entries[d]}return c},arrayRightDivideEquals:function(a){this.checkMatrixDimensions(a);for(var c=0;c<this.m;c++)for(var e=0;e<this.n;e++){var b=this.index(c,e);this.entries[b]/=a.entries[b]}return this},
arrayLeftDivide:function(a){this.checkMatrixDimensions(a);for(var c=new b(this.m,this.n),e=0;e<this.m;e++)for(var f=0;f<this.n;f++){var d=this.index(e,f);c.entries[d]=a.entries[d]/this.entries[d]}return c},arrayLeftDivideEquals:function(a){this.checkMatrixDimensions(a);for(var c=0;c<this.m;c++)for(var e=0;e<this.n;e++){var b=this.index(c,e);this.entries[b]=a.entries[b]/this.entries[b]}return this},times:function(a){var c,e,f,k,g;if(a.isMatrix){if(a.m!==this.n)throw Error("Matrix inner dimensions must agree.");
c=new b(this.m,a.n);var h=new d(this.n);for(f=0;f<a.n;f++){for(k=0;k<this.n;k++)h[k]=a.entries[a.index(k,f)];for(e=0;e<this.m;e++){for(k=g=0;k<this.n;k++)g+=this.entries[this.index(e,k)]*h[k];c.entries[c.index(e,f)]=g}}}else{g=a;c=new b(this.m,this.n);for(e=0;e<this.m;e++)for(f=0;f<this.n;f++)c.entries[c.index(e,f)]=g*this.entries[this.index(e,f)]}return c},timesEquals:function(a){for(var c=0;c<this.m;c++)for(var e=0;e<this.n;e++){var b=this.index(c,e);this.entries[b]*=a}return this},solve:function(a){return this.m===
this.n?(new phet.math.LUDecomposition(this)).solve(a):(new phet.math.QRDecomposition(this)).solve(a)},solveTranspose:function(a){return this.transpose().solve(a.transpose())},inverse:function(){return this.solve(b.identity(this.m,this.m))},det:function(){return(new phet.math.LUDecomposition(this)).det()},rank:function(){return(new phet.math.SingularValueDecomposition(this)).rank()},cond:function(){return(new phet.math.SingularValueDecomposition(this)).cond()},trace:function(){for(var a=0,c=0;c<Math.min(this.m,
this.n);c++)a+=this.entries[this.index(c,c)];return a},checkMatrixDimensions:function(a){if(a.m!==this.m||a.n!==this.n)throw Error("Matrix dimensions must agree.");},toString:function(){var a;a=""+("dim: "+this.getRowDimension()+"x"+this.getColumnDimension()+"\n");for(var c=0;c<this.getRowDimension();c++){for(var e=0;e<this.getColumnDimension();e++)a+=this.get(c,e)+" ";a+="\n"}return a},extractVector2:function(a){phet.assert(2===this.m);return new phet.math.Vector2(this.get(0,a),this.get(1,a))},extractVector3:function(a){phet.assert(3===
this.m);return new phet.math.Vector3(this.get(0,a),this.get(1,a),this.get(2,a))},extractVector4:function(a){phet.assert(4===this.m);return new phet.math.Vector4(this.get(0,a),this.get(1,a),this.get(2,a),this.get(3,a))},isMatrix:!0};b.identity=function(a,c){for(var e=new b(a,c),f=0;f<a;f++)for(var d=0;d<c;d++)e.entries[e.index(f,d)]=f===d?1:0;return e};b.rowVector2=function(a){return new b(1,2,[a.x,a.y])};b.rowVector3=function(a){return new b(1,3,[a.x,a.y,a.z])};b.rowVector4=function(a){return new b(1,
4,[a.x,a.y,a.z,a.w])};b.rowVector=function(a){if(a.isVector2)return b.rowVector2(a);if(a.isVector3)return b.rowVector3(a);if(a.isVector4)return b.rowVector4(a);throw Error("undetected type of vector: "+a.toString());};b.columnVector2=function(a){return new b(2,1,[a.x,a.y])};b.columnVector3=function(a){return new b(3,1,[a.x,a.y,a.z])};b.columnVector4=function(a){return new b(4,1,[a.x,a.y,a.z,a.w])};b.columnVector=function(a){if(a.isVector2)return b.columnVector2(a);if(a.isVector3)return b.columnVector3(a);
if(a.isVector4)return b.columnVector4(a);throw Error("undetected type of vector: "+a.toString());};b.fromVectors2=function(a){for(var c=a.length,e=new d(2*c),f=0;f<c;f++){var k=a[f];e[f]=k.x;e[f+c]=k.y}return new b(2,c,e,!0)};b.fromVectors3=function(a){for(var c=a.length,e=new d(3*c),f=0;f<c;f++){var k=a[f];e[f]=k.x;e[f+c]=k.y;e[f+2*c]=k.z}return new b(3,c,e,!0)};b.fromVectors4=function(a){for(var c=a.length,e=new d(4*c),f=0;f<c;f++){var k=a[f];e[f]=k.x;e[f+c]=k.y;e[f+2*c]=k.z;e[f+3*c]=k.w}return new b(4,
c,e,!0)}})();phet=phet||{};phet.math=phet.math||{};
(function(){var d=phet.math.Matrix,b=phet.Float32Array;phet.math.LUDecomposition=function(a){var e,f,d;this.matrix=a;var g=this.LU=a.getArrayCopy(),h=this.m=a.getRowDimension(),m=this.n=a.getColumnDimension();this.piv=new Uint32Array(h);for(e=0;e<h;e++)this.piv[e]=e;this.pivsign=1;var n=new b(h);for(f=0;f<m;f++){for(e=0;e<h;e++)n[e]=g[a.index(e,f)];for(e=0;e<h;e++){var p=Math.min(e,f),q=0;for(d=0;d<p;d++)var t=a.index(e,d),q=q+g[t]*n[d];n[e]-=q;g[a.index(e,f)]=n[e]}p=f;for(e=f+1;e<h;e++)Math.abs(n[e])>
Math.abs(n[p])&&(p=e);if(p!==f){for(d=0;d<m;d++)e=a.index(p,d),q=a.index(f,d),t=g[e],g[e]=g[q],g[q]=t;d=this.piv[p];this.piv[p]=this.piv[f];this.piv[f]=d;this.pivsign=-this.pivsign}if(f<h&&0!==g[this.matrix.index(f,f)])for(e=f+1;e<h;e++)g[a.index(e,f)]/=g[a.index(f,f)]}};var a=phet.math.LUDecomposition;a.prototype={constructor:a,isNonsingular:function(){for(var a=0;a<this.n;a++){var e=this.matrix.index(a,a);if(0===this.LU[e])return!1}return!0},getL:function(){for(var a=new d(this.m,this.n),e=0;e<
this.m;e++)for(var b=0;b<this.n;b++)e>b?a.entries[a.index(e,b)]=this.LU[this.matrix.index(e,b)]:e===b?a.entries[a.index(e,b)]=1:a.entries[a.index(e,b)]=0;return a},getU:function(){for(var a=new d(this.n,this.n),e=0;e<this.n;e++)for(var b=0;b<this.n;b++)e<=b?a.entries[a.index(e,b)]=this.LU[this.matrix.index(e,b)]:a.entries[a.index(e,b)]=0;return a},getPivot:function(){for(var a=new Uint32Array(this.m),e=0;e<this.m;e++)a[e]=this.piv[e];return a},getDoublePivot:function(){for(var a=new b(this.m),e=0;e<
this.m;e++)a[e]=this.piv[e];return a},det:function(){if(this.m!==this.n)throw Error("Matrix must be square.");for(var a=this.pivsign,e=0;e<this.n;e++)a*=this.LU[this.matrix.index(e,e)];return a},solve:function(a){var e,b;if(a.getRowDimension()!==this.m)throw Error("Matrix row dimensions must agree.");if(!this.isNonsingular())throw Error("Matrix is singular.");var d=a.getColumnDimension(),g=a.getArrayRowMatrix(this.piv,0,d-1);for(b=0;b<this.n;b++)for(a=b+1;a<this.n;a++)for(e=0;e<d;e++)g.entries[g.index(a,
e)]-=g.entries[g.index(b,e)]*this.LU[this.matrix.index(a,b)];for(b=this.n-1;0<=b;b--){for(e=0;e<d;e++)g.entries[g.index(b,e)]/=this.LU[this.matrix.index(b,b)];for(a=0;a<b;a++)for(e=0;e<d;e++)g.entries[g.index(a,e)]-=g.entries[g.index(b,e)]*this.LU[this.matrix.index(a,b)]}return g}}})();phet=phet||{};phet.math=phet.math||{};
(function(){var d=phet.math.Matrix,b=phet.Float32Array;phet.math.QRDecomposition=function(a){this.matrix=a;var e=this.QR=a.getArrayCopy(),f=this.m=a.getRowDimension();a=this.n=a.getColumnDimension();this.Rdiag=new b(a);var k,g,h;for(h=0;h<a;h++){var m=0;for(k=h;k<f;k++)m=d.hypot(m,e[this.matrix.index(k,h)]);if(0!==m){0>e[this.matrix.index(h,h)]&&(m=-m);for(k=h;k<f;k++)e[this.matrix.index(k,h)]/=m;e[this.matrix.index(h,h)]+=1;for(g=h+1;g<a;g++){var n=0;for(k=h;k<f;k++)n+=e[this.matrix.index(k,h)]*
e[this.matrix.index(k,g)];n=-n/e[this.matrix.index(h,h)];for(k=h;k<f;k++)e[this.matrix.index(k,g)]+=n*e[this.matrix.index(k,h)]}}this.Rdiag[h]=-m}};var a=phet.math.QRDecomposition;a.prototype={constructor:a,isFullRank:function(){for(var a=0;a<this.n;a++)if(0===this.Rdiag[a])return!1;return!0},getH:function(){for(var a=new d(this.m,this.n),e=0;e<this.m;e++)for(var b=0;b<this.n;b++)e>=b?a.entries[a.index(e,b)]=this.QR[this.matrix.index(e,b)]:a.entries[a.index(e,b)]=0;return a},getR:function(){for(var a=
new d(this.n,this.n),e=0;e<this.n;e++)for(var b=0;b<this.n;b++)e<b?a.entries[a.index(e,b)]=this.QR[this.matrix.index(e,b)]:e===b?a.entries[a.index(e,b)]=this.Rdiag[e]:a.entries[a.index(e,b)]=0;return a},getQ:function(){var a,e,b,k=new d(this.m,this.n);for(b=this.n-1;0<=b;b--){for(a=0;a<this.m;a++)k.entries[k.index(a,b)]=0;k.entries[k.index(b,b)]=1;for(e=b;e<this.n;e++)if(0!==this.QR[this.matrix.index(b,b)]){var g=0;for(a=b;a<this.m;a++)g+=this.QR[this.matrix.index(a,b)]*k.entries[k.index(a,e)];g=
-g/this.QR[this.matrix.index(b,b)];for(a=b;a<this.m;a++)k.entries[k.index(a,e)]+=g*this.QR[this.matrix.index(a,b)]}}return k},solve:function(a){if(a.getRowDimension()!==this.m)throw Error("Matrix row dimensions must agree.");if(!this.isFullRank())throw Error("Matrix is rank deficient.");var e,b,k,g=a.getColumnDimension(),h=a.getArrayCopy();for(k=0;k<this.n;k++)for(b=0;b<g;b++){var m=0;for(e=k;e<this.m;e++)m+=this.QR[this.matrix.index(e,k)]*h[a.index(e,b)];m=-m/this.QR[this.matrix.index(k,k)];for(e=
k;e<this.m;e++)h[a.index(e,b)]+=m*this.QR[this.matrix.index(e,k)]}for(k=this.n-1;0<=k;k--){for(b=0;b<g;b++)h[a.index(k,b)]/=this.Rdiag[k];for(e=0;e<k;e++)for(b=0;b<g;b++)h[a.index(e,b)]-=h[a.index(k,b)]*this.QR[this.matrix.index(e,k)]}return(new d(h,this.n,g)).getMatrix(0,this.n-1,0,g-1)}}})();phet=phet||{};phet.math=phet.math||{};
(function(){var d=phet.math.Matrix,b=phet.Float32Array;phet.math.SingularValueDecomposition=function(a){this.matrix=a;var e=a.getArrayCopy();this.m=a.getRowDimension();this.n=a.getColumnDimension();a=this.m;var f=this.n,k=Math.min,g=Math.max,h=Math.pow,m=Math.abs,n=k(a,f),p=this.s=new b(k(a+1,f)),q=this.U=new b(a*n),t=this.V=new b(f*f),s=new b(f),u=new b(a),j,r,l,v,w,x,z=d.hypot,y=k(a-1,f);w=g(0,k(f-2,a));for(l=0;l<g(y,w);l++){if(l<y){p[l]=0;for(j=l;j<a;j++)p[l]=z(p[l],e[j*f+l]);if(0!==p[l]){0>e[l*
f+l]&&(p[l]=-p[l]);for(j=l;j<a;j++)e[j*f+l]/=p[l];e[l*f+l]+=1}p[l]=-p[l]}for(r=l+1;r<f;r++){if(l<y&&0!==p[l]){v=0;for(j=l;j<a;j++)v+=e[j*f+l]*e[j*f+r];v=-v/e[l*f+l];for(j=l;j<a;j++)e[j*f+r]+=v*e[j*f+l]}s[r]=e[l*f+r]}if(l<y)for(j=l;j<a;j++)q[j*n+l]=e[j*f+l];if(l<w){s[l]=0;for(j=l+1;j<f;j++)s[l]=z(s[l],s[j]);if(0!==s[l]){0>s[l+1]&&(s[l]=-s[l]);for(j=l+1;j<f;j++)s[j]/=s[l];s[l+1]+=1}s[l]=-s[l];if(l+1<a&&0!==s[l]){for(j=l+1;j<a;j++)u[j]=0;for(r=l+1;r<f;r++)for(j=l+1;j<a;j++)u[j]+=s[r]*e[j*f+r];for(r=
l+1;r<f;r++){v=-s[r]/s[l+1];for(j=l+1;j<a;j++)e[j*f+r]+=v*u[j]}}for(j=l+1;j<f;j++)t[j*f+l]=s[j]}}k=k(f,a+1);y<f&&(p[y]=e[y*f+y]);a<k&&(p[k-1]=0);w+1<k&&(s[w]=e[w*f+k-1]);s[k-1]=0;for(r=y;r<n;r++){for(j=0;j<a;j++)q[j*n+r]=0;q[r*n+r]=1}for(l=y-1;0<=l;l--)if(0!==p[l]){for(r=l+1;r<n;r++){v=0;for(j=l;j<a;j++)v+=q[j*n+l]*q[j*n+r];v=-v/q[l*n+l];for(j=l;j<a;j++)q[j*n+r]+=v*q[j*n+l]}for(j=l;j<a;j++)q[j*n+l]=-q[j*n+l];q[l*n+l]=1+q[l*n+l];for(j=0;j<l-1;j++)q[j*n+l]=0}else{for(j=0;j<a;j++)q[j*n+l]=0;q[l*n+l]=
1}for(l=f-1;0<=l;l--){if(l<w&&0!==s[l])for(r=l+1;r<n;r++){v=0;for(j=l+1;j<f;j++)v+=t[j*f+l]*t[j*f+r];v=-v/t[l+1*f+l];for(j=l+1;j<f;j++)t[j*f+r]+=v*t[j*f+l]}for(j=0;j<f;j++)t[j*f+l]=0;t[l*f+l]=1}e=k-1;y=h(2,-52);for(h=h(2,-966);0<k;){for(l=k-2;-1<=l&&-1!==l;l--)if(m(s[l])<=h+y*(m(p[l])+m(p[l+1]))){s[l]=0;break}if(l===k-2)v=4;else{for(j=k-1;j>=l&&j!==l;j--)if(v=(j!==k?m(s[j]):0)+(j!==l+1?m(s[j-1]):0),m(p[j])<=h+y*v){p[j]=0;break}j===l?v=3:j===k-1?v=1:(v=2,l=j)}l++;switch(v){case 1:w=s[k-2];s[k-2]=0;
for(r=k-2;r>=l;r--){v=z(p[r],w);u=p[r]/v;x=w/v;p[r]=v;r!==l&&(w=-x*s[r-1],s[r-1]*=u);for(j=0;j<f;j++)v=u*t[j*f+r]+x*t[j*f+k-1],t[j*f+k-1]=-x*t[j*f+r]+u*t[j*f+k-1],t[j*f+r]=v}break;case 2:w=s[l-1];s[l-1]=0;for(r=l;r<k;r++){v=z(p[r],w);u=p[r]/v;x=w/v;p[r]=v;w=-x*s[r];s[r]*=u;for(j=0;j<a;j++)v=u*q[j*n+r]+x*q[j*n+l-1],q[j*n+l-1]=-x*q[j*n+r]+u*q[j*n+l-1],q[j*n+r]=v}break;case 3:r=g(g(g(g(m(p[k-1]),m(p[k-2])),m(s[k-2])),m(p[l])),m(s[l]));j=p[k-1]/r;u=p[k-2]/r;w=s[k-2]/r;v=p[l]/r;r=s[l]/r;u=((u+j)*(u-j)+
w*w)/2;w=j*w*j*w;x=0;if(0!==u||0!==w)x=Math.sqrt(u*u+w),0>u&&(x=-x),x=w/(u+x);w=(v+j)*(v-j)+x;var A=v*r;for(r=l;r<k-1;r++){v=z(w,A);u=w/v;x=A/v;r!==l&&(s[r-1]=v);w=u*p[r]+x*s[r];s[r]=u*s[r]-x*p[r];A=x*p[r+1];p[r+1]*=u;for(j=0;j<f;j++)v=u*t[j*f+r]+x*t[j*f+r+1],t[j*f+r+1]=-x*t[j*f+r]+u*t[j*f+r+1],t[j*f+r]=v;v=z(w,A);u=w/v;x=A/v;p[r]=v;w=u*s[r]+x*p[r+1];p[r+1]=-x*s[r]+u*p[r+1];A=x*s[r+1];s[r+1]*=u;if(r<a-1)for(j=0;j<a;j++)v=u*q[j*n+r]+x*q[j*n+r+1],q[j*n+r+1]=-x*q[j*n+r]+u*q[j*n+r+1],q[j*n+r]=v}s[k-2]=
w;break;case 4:if(0>=p[l]){p[l]=0>p[l]?-p[l]:0;for(j=0;j<=e;j++)t[j*f+l]=-t[j*f+l]}for(;l<e&&!(p[l]>=p[l+1]);){v=p[l];p[l]=p[l+1];p[l+1]=v;if(l<f-1)for(j=0;j<f;j++)v=t[j*f+l+1],t[j*f+l+1]=t[j*f+l],t[j*f+l]=v;if(l<a-1)for(j=0;j<a;j++)v=q[j*n+l+1],q[j*n+l+1]=q[j*n+l],q[j*n+l]=v;l++}k--}}};var a=phet.math.SingularValueDecomposition;a.prototype={constructor:a,getU:function(){return new d(this.m,Math.min(this.m+1,this.n),this.U,!0)},getV:function(){return new d(this.n,this.n,this.V,!0)},getSingularValues:function(){return this.s},
getS:function(){for(var a=new d(this.n,this.n),e=0;e<this.n;e++){for(var b=0;b<this.n;b++)a.entries[a.index(e,b)]=0;a.entries[a.index(e,e)]=this.s[e]}return a},norm2:function(){return this.s[0]},cond:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},rank:function(){for(var a=Math.pow(2,-23),a=Math.max(this.m,this.n)*this.s[0]*a,e=0,b=0;b<this.s.length;b++)this.s[b]>a&&e++;return e}}})();phet=phet||{};phet.math=phet.math||{};
(function(){var d=phet.math.Matrix4;phet.math.StageCenteringCanvasTransform=function(a,b){this.canvasSizeProperty=a;this.stageSize=b;this.transform=new phet.model.Property(null);var e=this;a.addObserver(function(){e.updateTransform()},!0)};var b=phet.math.StageCenteringCanvasTransform;b.fieldOfViewYFactor=function(a,b){var e=a.width/b.width,f=a.height/b.height;return 0===e||0===f?1:f>e?f/e:1};b.compute=function(a,b){var e=a.width/b.width,f=a.height/b.height,e=e<f?e:f,e=0>=e?1:e;return d.translation(a.width/
2-e*b.width/2,a.height/2-e*b.height/2).timesMatrix(d.scaling(e))};b.prototype={constructor:b,fieldOfViewYFactor:function(){return b.fieldOfViewYFactor(this.canvasSizeProperty.get(),this.stageSize)},updateTransform:function(){var a=b.compute(this.canvasSizeProperty.get(),this.stageSize);this.transform.set(new phet.math.Transform4(a))}}})();phet=phet||{};phet.math=phet.math||{};
(function(){phet.math.Dimension2=function(b,a){this.width=b;this.height=a};var d=phet.math.Dimension2;d.prototype={constructor:d,toString:function(){return"["+this.width+"w, "+this.height+"h]"},equals:function(b){return this.width===b.width&&this.height===b.height}}})();phet=phet||{};phet.math=phet.math||{};
(function(){var d=phet.math.Vector2;phet.math.Bounds2=function(a,b,e,f){this.minX=a;this.minY=b;this.maxX=e;this.maxY=f};var b=phet.math.Bounds2;b.prototype={constructor:b,width:function(){return this.maxX-this.minX},height:function(){return this.maxY-this.minY},x:function(){return this.minX},y:function(){return this.minY},centerX:function(){return(this.maxX+this.minX)/2},centerY:function(){return(this.maxY+this.minY)/2},isEmpty:function(){return 0>=this.width()||0>=this.height()},union:function(a){return new b(Math.min(this.minX,
a.minX),Math.min(this.minY,a.minY),Math.max(this.maxX,a.maxX),Math.max(this.maxY,a.maxY))},intersection:function(a){return new b(Math.max(this.minX,a.minX),Math.max(this.minY,a.minY),Math.min(this.maxX,a.maxX),Math.min(this.maxY,a.maxY))},withPoint:function(a){return new b(Math.min(this.minX,a.x),Math.min(this.minY,a.y),Math.max(this.maxX,a.x),Math.max(this.maxY,a.y))},withMinX:function(a){return new b(a,this.minY,this.maxX,this.maxY)},withMinY:function(a){return new b(this.minX,a,this.maxX,this.maxY)},
withMaxX:function(a){return new b(this.minX,this.minY,a,this.maxY)},withMaxY:function(a){return new b(this.minX,this.minY,this.maxX,a)},roundedOut:function(){return new b(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundedIn:function(){return new b(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},containsPoint:function(a){return this.minX<=a.x&&a.x<=this.maxX&&this.minY<=a.y&&a.y<=this.maxY},containsBounds:function(a){return this.minX<=
a.minX&&this.maxX>=a.maxX&&this.minY<=a.minY&&this.maxY>=a.maxY},intersectsBounds:function(a){return!this.intersection(a).isEmpty()},transformed:function(a){if(this.isEmpty())return b.NOTHING;var c=b.NOTHING,c=c.withPoint(a.timesVector2(new d(this.minX,this.minY))),c=c.withPoint(a.timesVector2(new d(this.minX,this.maxY))),c=c.withPoint(a.timesVector2(new d(this.maxX,this.minY)));return c=c.withPoint(a.timesVector2(new d(this.maxX,this.maxY)))},dilated:function(a){return new b(this.minX-a,this.minY-
a,this.maxX+a,this.maxY+a)},shiftedX:function(a){return new b(this.minX+a,this.minY,this.maxX+a,this.maxY)},shiftedY:function(a){return new b(this.minX,this.minY+a,this.maxX,this.maxY+a)},shifted:function(a,c){"object"===typeof a&&(c=a.y,a=a.x);return new b(this.minX+a,this.minY+c,this.maxX+a,this.maxY+c)},eroded:function(a){return this.dilated(-a)},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+")]"},equals:function(a){return this.minX===a.minX&&this.minY===
a.minY&&this.maxX===a.maxX&&this.maxY===a.maxY}};b.EVERYTHING=new b(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);b.NOTHING=new b(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY)})();phet=phet||{};phet.ui=phet.ui||{};
(function(){phet.ui.Color=function(b,a,c,e){this.a=void 0===e?255:e;void 0===a||void 0===c?(this.r=b>>16&&255,this.g=b>>8&&255,this.b=b>>0&&255):(this.r=b,this.g=a,this.b=c)};var d=phet.ui.Color;d.BLACK=new d(0,0,0);d.BLUE=new d(0,0,255);d.CYAN=new d(0,255,255);d.DARK_GRAY=new d(64,64,64);d.GRAY=new d(128,128,128);d.GREEN=new d(0,255,0);d.LIGHT_GRAY=new d(192,192,192);d.MAGENTA=new d(255,0,255);d.ORANGE=new d(255,200,0);d.PINK=new d(255,175,175);d.RED=new d(255,0,0);d.WHITE=new d(255,255,255);d.YELLOW=
new d(255,255,0)})();phet=phet||{};phet.webgl=phet.webgl||{};
(function(){phet.webgl.getShaderFromDOM=function(d,b){var a=document.getElementById(b);if(!a)throw Error("shader DOM not found: for id="+b);for(var c="",e=a.firstChild;e;)3===e.nodeType&&(c+=e.textContent),e=e.nextSibling;if("x-shader/x-fragment"===a.type)a=d.createShader(d.FRAGMENT_SHADER);else if("x-shader/x-vertex"===a.type)a=d.createShader(d.VERTEX_SHADER);else throw Error("shader DOM type not recognized: "+a.type);d.shaderSource(a,c);d.compileShader(a);if(!d.getShaderParameter(a,d.COMPILE_STATUS))throw Error(d.getShaderInfoLog(a));
return a};phet.webgl.initWebGL=function(d){var b=null;try{b=d.getContext("webgl")||d.getContext("experimental-webgl")}catch(a){}if(!b)throw Error("Unable to initialize WebGL. Your browser may not support it.");return b}})();phet=phet||{};phet.webgl=phet.webgl||{};
(function(){phet.webgl.GLNode=function(){this.parent=null;this.children=[];this.visible=!0;this.transform=new phet.math.Transform4;this.wrappers=[]};var d=phet.webgl.GLNode,b=phet.math.Matrix4;d.RenderState=function(){this.transform=new phet.math.Transform4;this.textureCoordinateAttribute=this.normalAttribute=this.positionAttribute=this.inverseTransposeAttribute=this.transformAttribute=null};d.prototype={constructor:d,render:function(a){this.transform.isIdentity()||a.transform.append(this.transform.getMatrix());
this.preRender(a);this.renderSelf(a);this.renderChildren(a);this.postRender(a);this.transform.isIdentity()||a.transform.append(this.transform.getInverse())},renderSelf:function(){},renderChildren:function(a){for(var b=0;b<this.children.length;b++)this.children[b].render(a)},preRender:function(a){for(var b=0;b<this.wrappers.length;b++)this.wrappers[b].preRender(a)},postRender:function(a){for(var b=0;b<this.wrappers.length;b++)this.wrappers[b].postRender(a)},addChild:function(a){phet.assert(null!==
a&&void 0!==a);this.isChild(a)||(null!==a.parent&&a.parent.removeChild(a),a.parent=this,this.children.push(a))},removeChild:function(a){phet.assert(this.isChild(a));a.parent=null;this.children.splice(this.children.indexOf(a),1)},hasParent:function(){return null!==this.parent&&void 0!==this.parent},detach:function(){this.hasParent()&&this.parent.removeChild(this)},isChild:function(a){phet.assert(a.parent===this===(-1!==this.children.indexOf(a)));return a.parent===this},translate:function(a,c,e){this.transform.append(b.translation(a,
c,e))},scale:function(a,c,e){this.transform.append(b.scaling(a,c,e))},rotate:function(a,c){this.transform.append(b.rotationAxisAngle(a,c))}}})();phet=phet||{};phet.webgl=phet.webgl||{};
(function(){var d=phet.Float32Array;phet.webgl.Quad=function(a,b,e,f,d){phet.webgl.GLNode.call(this);this.gl=a;this.width=b||1;this.height=e||1;this.xOffset=f||1;this.yOffset=d||1;this.setupBuffers()};var b=phet.webgl.Quad;b.prototype=phet.Object.create(phet.webgl.GLNode.prototype);b.prototype.constructor=b;b.prototype.setupBuffers=function(){var a=this.gl;this.positionBuffer=a.createBuffer();this.normalBuffer=a.createBuffer();this.indexBuffer=a.createBuffer();this.textureBuffer=a.createBuffer();
var b=this.width,e=this.height,f=this.xOffset,k=this.yOffset,b=[f,k,0,f+b,k,0,f+b,k+e,0,f,k+e,0],e=[0,0,1,0,0,1,0,0,1,0,0,1],f=[0,1,2,0,2,3],k=[0,0,1,0,1,1,0,1];a.bindBuffer(a.ARRAY_BUFFER,this.normalBuffer);a.bufferData(a.ARRAY_BUFFER,new d(e),a.STATIC_DRAW);this.normalBuffer.itemSize=3;this.normalBuffer.numItems=e.length/3;a.bindBuffer(a.ARRAY_BUFFER,this.textureBuffer);a.bufferData(a.ARRAY_BUFFER,new d(k),a.STATIC_DRAW);this.textureBuffer.itemSize=2;this.textureBuffer.numItems=k.length/2;a.bindBuffer(a.ARRAY_BUFFER,
this.positionBuffer);a.bufferData(a.ARRAY_BUFFER,new d(b),a.STATIC_DRAW);this.positionBuffer.itemSize=3;this.positionBuffer.numItems=b.length/3;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(f),a.STREAM_DRAW);this.indexBuffer.itemSize=3;this.indexBuffer.numItems=f.length};b.prototype.renderSelf=function(a){var b=this.gl;b.bindBuffer(b.ARRAY_BUFFER,this.positionBuffer);b.vertexAttribPointer(a.positionAttribute,this.positionBuffer.itemSize,
b.FLOAT,!1,0,0);null!==a.textureCoordinateAttribute&&(b.bindBuffer(b.ARRAY_BUFFER,this.textureBuffer),b.vertexAttribPointer(a.textureCoordinateAttribute,this.textureBuffer.itemSize,b.FLOAT,!1,0,0));null!==a.normalAttribute&&(b.bindBuffer(b.ARRAY_BUFFER,this.normalBuffer),b.vertexAttribPointer(a.normalAttribute,this.normalBuffer.itemSize,b.FLOAT,!1,0,0));null!==a.transformAttribute&&b.uniformMatrix4fv(a.transformAttribute,!1,a.transform.getMatrix().entries);null!==a.inverseTransposeAttribute&&b.uniformMatrix4fv(a.inverseTransposeAttribute,
!1,a.transform.getInverseTransposed().entries);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.drawElements(b.TRIANGLES,this.indexBuffer.numItems,b.UNSIGNED_SHORT,0)}})();phet=phet||{};phet.webgl=phet.webgl||{};
(function(){var d=phet.Float32Array;phet.webgl.Sphere=function(a,b,e,f){phet.webgl.GLNode.call(this);this.gl=a;this.radius=b;this.latitudeStrips=e||10;this.longitudeStrips=f||10;this.setupBuffers()};var b=phet.webgl.Sphere;b.prototype=phet.Object.create(phet.webgl.GLNode.prototype);b.prototype.constructor=b;b.prototype.setupBuffers=function(){var a=this.gl;this.positionBuffer=a.createBuffer();this.normalBuffer=a.createBuffer();this.indexBuffer=a.createBuffer();this.textureBuffer=a.createBuffer();
for(var b=[],e=[],f=[],k=[],g=this.latitudeStrips+1,h=this.longitudeStrips,m,n=0;n<g;n++){var p=n/(g-1);m=(p-0.5)*Math.PI;var q=Math.cos(m),t=Math.sin(m);for(m=0;m<=h;m++){var s=m/h,u=2*s*Math.PI,j=Math.cos(u),r=Math.sin(u),u=r*q,r=r*t;b.push(u*this.radius);b.push(r*this.radius);b.push(j*this.radius);e.push(u);e.push(r);e.push(j);k.push(s);k.push(p)}if(0<n){p=(n-1)*(h+1);q=n*(h+1);for(m=1;m<=h;m++)f.push(p+m-1),f.push(q+m-1),f.push(q+m),f.push(p+m-1),f.push(q+m),f.push(p+m)}}a.bindBuffer(a.ARRAY_BUFFER,
this.normalBuffer);a.bufferData(a.ARRAY_BUFFER,new d(e),a.STATIC_DRAW);this.normalBuffer.itemSize=3;this.normalBuffer.numItems=e.length/3;a.bindBuffer(a.ARRAY_BUFFER,this.textureBuffer);a.bufferData(a.ARRAY_BUFFER,new d(k),a.STATIC_DRAW);this.textureBuffer.itemSize=2;this.textureBuffer.numItems=k.length/2;a.bindBuffer(a.ARRAY_BUFFER,this.positionBuffer);a.bufferData(a.ARRAY_BUFFER,new d(b),a.STATIC_DRAW);this.positionBuffer.itemSize=3;this.positionBuffer.numItems=b.length/3;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,
this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(f),a.STREAM_DRAW);this.indexBuffer.itemSize=3;this.indexBuffer.numItems=f.length};b.prototype.renderSelf=function(a){var b=this.gl;b.bindBuffer(b.ARRAY_BUFFER,this.positionBuffer);b.vertexAttribPointer(a.positionAttribute,this.positionBuffer.itemSize,b.FLOAT,!1,0,0);null!==a.textureCoordinateAttribute&&(b.bindBuffer(b.ARRAY_BUFFER,this.textureBuffer),b.vertexAttribPointer(a.textureCoordinateAttribute,this.textureBuffer.itemSize,
b.FLOAT,!1,0,0));null!==a.normalAttribute&&(b.bindBuffer(b.ARRAY_BUFFER,this.normalBuffer),b.vertexAttribPointer(a.normalAttribute,this.normalBuffer.itemSize,b.FLOAT,!1,0,0));null!==a.transformAttribute&&b.uniformMatrix4fv(a.transformAttribute,!1,a.transform.getMatrix().entries);null!==a.inverseTransposeAttribute&&b.uniformMatrix4fv(a.inverseTransposeAttribute,!1,a.transform.getInverseTransposed().entries);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.drawElements(b.TRIANGLES,this.indexBuffer.numItems,
b.UNSIGNED_SHORT,0)};b.prototype.intersect=function(a,b){b=void 0===b?1E-5:b;var e=new phet.math.Vector3,f=a.dir,d=a.pos,g=d.minus(e),h=f.dot(g),g=g.magnitudeSquared(),h=4*h*h-4*(g-this.radius*this.radius);if(h<b)return null;d=f.dot(e)-f.dot(d);h=Math.sqrt(h)/2;f=d-h;d+=h;if(d<b)return null;h=a.pointAtDistance(d);g=h.minus(e).normalized();if(f<b)return{distance:d,hitPoint:h,normal:g.negated(),fromOutside:!1};d=a.pointAtDistance(f);e=d.minus(e).normalized();return{distance:f,hitPoint:d,normal:e,fromOutside:!0}}})();
phet=phet||{};phet.webgl=phet.webgl||{};
(function(){var d=phet.Float32Array;phet.webgl.Cylinder=function(a,b,e,f,d){phet.webgl.GLNode.call(this);this.gl=a;this.radius=b;this.length=e;this.radialStrips=f||16;this.axisStrips=d||1;this.setupBuffers()};var b=phet.webgl.Cylinder;b.prototype=phet.Object.create(phet.webgl.GLNode.prototype);b.prototype.constructor=b;b.prototype.setupBuffers=function(){var a=this.gl;this.positionBuffer=a.createBuffer();this.normalBuffer=a.createBuffer();this.indexBuffer=a.createBuffer();this.textureBuffer=a.createBuffer();
for(var b=[],e=[],f=[],k=[],g=this.radialStrips+1,h=this.axisStrips+1,m=0;m<g;m++)for(var n=m/(g-1),p=2*n*Math.PI,q=Math.cos(p),p=Math.sin(p),t=0;t<h;t++){var s=t/(h-1),u=(s-0.5)*this.length;b.push(q*this.radius);b.push(p*this.radius);b.push(u);e.push(q);e.push(p);e.push(0);k.push(n);k.push(s);0<m&&0<t&&(s=(m-1)*h,u=m*h,f.push(s+t-1),f.push(u+t-1),f.push(u+t),f.push(s+t-1),f.push(u+t),f.push(s+t))}a.bindBuffer(a.ARRAY_BUFFER,this.normalBuffer);a.bufferData(a.ARRAY_BUFFER,new d(e),a.STATIC_DRAW);this.normalBuffer.itemSize=
3;this.normalBuffer.numItems=e.length/3;a.bindBuffer(a.ARRAY_BUFFER,this.textureBuffer);a.bufferData(a.ARRAY_BUFFER,new d(k),a.STATIC_DRAW);this.textureBuffer.itemSize=2;this.textureBuffer.numItems=k.length/2;a.bindBuffer(a.ARRAY_BUFFER,this.positionBuffer);a.bufferData(a.ARRAY_BUFFER,new d(b),a.STATIC_DRAW);this.positionBuffer.itemSize=3;this.positionBuffer.numItems=b.length/3;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(f),a.STREAM_DRAW);
this.indexBuffer.itemSize=3;this.indexBuffer.numItems=f.length};b.prototype.renderSelf=function(a){var b=this.gl;b.bindBuffer(b.ARRAY_BUFFER,this.positionBuffer);b.vertexAttribPointer(a.positionAttribute,this.positionBuffer.itemSize,b.FLOAT,!1,0,0);null!==a.textureCoordinateAttribute&&(b.bindBuffer(b.ARRAY_BUFFER,this.textureBuffer),b.vertexAttribPointer(a.textureCoordinateAttribute,this.textureBuffer.itemSize,b.FLOAT,!1,0,0));null!==a.normalAttribute&&(b.bindBuffer(b.ARRAY_BUFFER,this.normalBuffer),
b.vertexAttribPointer(a.normalAttribute,this.normalBuffer.itemSize,b.FLOAT,!1,0,0));null!==a.transformAttribute&&b.uniformMatrix4fv(a.transformAttribute,!1,a.transform.getMatrix().entries);null!==a.inverseTransposeAttribute&&b.uniformMatrix4fv(a.inverseTransposeAttribute,!1,a.transform.getInverseTransposed().entries);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.drawElements(b.TRIANGLES,this.indexBuffer.numItems,b.UNSIGNED_SHORT,0)}})();phet=phet||{};phet.canvas=phet.canvas||{};
(function(){phet.canvas.initCanvas=function(d){var b=null;try{b=d.getContext("2d")}catch(a){}if(!b)throw Error("Unable to initialize HTML5 canvas. Your browser may not support it.");return b};phet.canvas.backingStorePixelRatio=function(d){return d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1};phet.canvas.backingScale=function(d){return"devicePixelRatio"in window?(d=phet.canvas.backingStorePixelRatio(d),
window.devicePixelRatio/d):1}})();var scenery=scenery||{};
(function(){var d=!1,b=phet.math.Matrix3,a=phet.math.Transform3,c=phet.math.Bounds2,e=phet.math.Vector2;scenery.scanBounds=function(a,b,d){for(var h=_.map(_.range(b),function(){return!1}),m=_.map(_.range(b),function(){return!1}),n=0;n<b;n++)for(var p=0;p<b;p++){var q=4*(p*b+n);if(0!==a.data[q]||0!==a.data[q+1]||0!==a.data[q+2]||0!==a.data[q+3])h[n]=!0,m[p]=!0}a=_.indexOf(h,!0);h=_.lastIndexOf(h,!0);n=_.indexOf(m,!0);m=_.lastIndexOf(m,!0);p=b/16;return{minBounds:new c(1>a||a>=b-1?Number.POSITIVE_INFINITY:
d.inversePosition2(new e(a+1+p,0)).x,1>n||n>=b-1?Number.POSITIVE_INFINITY:d.inversePosition2(new e(0,n+1+p)).y,1>h||h>=b-1?Number.NEGATIVE_INFINITY:d.inversePosition2(new e(h-p,0)).x,1>m||m>=b-1?Number.NEGATIVE_INFINITY:d.inversePosition2(new e(0,m-p)).y),maxBounds:new c(1>a||a>=b-1?Number.NEGATIVE_INFINITY:d.inversePosition2(new e(a-1-p,0)).x,1>n||n>=b-1?Number.NEGATIVE_INFINITY:d.inversePosition2(new e(0,n-1-p)).y,1>h||h>=b-1?Number.POSITIVE_INFINITY:d.inversePosition2(new e(h+2+p,0)).x,1>m||m>=
b-1?Number.POSITIVE_INFINITY:d.inversePosition2(new e(0,m+2+p)).y)}};scenery.canvasAccurateBounds=function(f,k){function g(a){u.save();a.matrix.canvasSetTransform(u);f(u);u.restore();var b=u.getImageData(0,0,n,n);a=scenery.scanBounds(b,n,a);if(d){var e=document.createElement("canvas");e.width=n;e.height=n;phet.canvas.initCanvas(e).putImageData(b,0,0);$(e).css("border","1px solid black");$(window).ready(function(){$("#display").append(e)})}u.clearRect(0,0,n,n);return a}function h(e){var c=(n-4)/(e.maxX-
e.minX),f=(n-4)/(e.maxY-e.minY);return new a(b.translation(-c*e.minX+2,-f*e.minY+2).timesMatrix(b.scaling(c,f)))}var m=k&&k.precision?k.precision:0.001,n=k&&k.resolution?k.resolution:128,p=k&&k.initialScale?k.initialScale:0.0625,q=c.NOTHING,t=c.EVERYTHING,s=document.createElement("canvas");s.width=n;s.height=n;var u=phet.canvas.initCanvas(s);d&&$(window).ready(function(){var a=document.createElement("h2");$(a).text("Bounds Scan");$("#display").append(a)});s=new a;s.append(b.translation(n/2,n/2));
s.append(b.scaling(p));for(var p=g(s),q=q.union(p.minBounds),t=t.intersection(p.maxBounds),j,p=t.minY,s=t.maxY;isFinite(q.minX)&&isFinite(t.minX)&&Math.abs(q.minX-t.minX)>m;){j=g(h(new c(t.minX,p,q.minX,s)));if(q.minX<=j.minBounds.minX&&t.minX>=j.maxBounds.minX){d&&(console.log("warning, exiting infinite loop!"),console.log('transformed "min" minX: '+h(new c(t.minX,t.minY,q.minX,t.maxY)).transformPosition2(new e(q.minX,0))),console.log('transformed "max" minX: '+h(new c(t.minX,t.minY,q.minX,t.maxY)).transformPosition2(new e(t.minX,
0))));break}q=q.withMinX(Math.min(q.minX,j.minBounds.minX));t=t.withMinX(Math.max(t.minX,j.maxBounds.minX));p=Math.max(p,j.maxBounds.minY);s=Math.min(s,j.maxBounds.maxY)}p=t.minY;for(s=t.maxY;isFinite(q.maxX)&&isFinite(t.maxX)&&Math.abs(q.maxX-t.maxX)>m;){j=g(h(new c(q.maxX,p,t.maxX,s)));if(q.maxX>=j.minBounds.maxX&&t.maxX<=j.maxBounds.maxX){d&&console.log("warning, exiting infinite loop!");break}q=q.withMaxX(Math.max(q.maxX,j.minBounds.maxX));t=t.withMaxX(Math.min(t.maxX,j.maxBounds.maxX));p=Math.max(p,
j.maxBounds.minY);s=Math.min(s,j.maxBounds.maxY)}p=t.minX;for(s=t.maxX;isFinite(q.minY)&&isFinite(t.minY)&&Math.abs(q.minY-t.minY)>m;){j=g(h(new c(p,t.minY,s,q.minY)));if(q.minY<=j.minBounds.minY&&t.minY>=j.maxBounds.minY){d&&console.log("warning, exiting infinite loop!");break}q=q.withMinY(Math.min(q.minY,j.minBounds.minY));t=t.withMinY(Math.max(t.minY,j.maxBounds.minY));p=Math.max(p,j.maxBounds.minX);s=Math.min(s,j.maxBounds.maxX)}p=t.minX;for(s=t.maxX;isFinite(q.maxY)&&isFinite(t.maxY)&&Math.abs(q.maxY-
t.maxY)>m;){j=g(h(new c(p,q.maxY,s,t.maxY)));if(q.maxY>=j.minBounds.maxY&&t.maxY<=j.maxBounds.maxY){d&&console.log("warning, exiting infinite loop!");break}q=q.withMaxY(Math.max(q.maxY,j.minBounds.maxY));t=t.withMaxY(Math.min(t.maxY,j.maxBounds.maxY));p=Math.max(p,j.maxBounds.minX);s=Math.min(s,j.maxBounds.maxX)}d&&(console.log("minBounds: "+q),console.log("maxBounds: "+t));m=new c((q.minX+t.minX)/2,(q.minY+t.minY)/2,(q.maxX+t.maxX)/2,(q.maxY+t.maxY)/2);m.minBounds=q;m.maxBounds=t;m.isConsistent=
t.containsBounds(q);m.precision=Math.max(Math.abs(q.minX-t.minX),Math.abs(q.minY-t.minY),Math.abs(q.maxX-t.maxX),Math.abs(q.maxY-t.maxY));return m}})();scenery=scenery||{};
(function(){scenery.Trail=function(b){if(b instanceof scenery.Trail)this.nodes=b.nodes.slice(0),this.length=b.length,this.indices=b.indices.slice(0);else{this.nodes=[];this.length=0;this.indices=[];var a=this;b&&(b instanceof scenery.Node?a.addDescendant(b):_.each(b,function(b){a.addDescendant(b)}))}};var d=scenery.Trail;d.prototype={constructor:d,copy:function(){return new d(this)},get:function(b){return 0<=b?this.nodes[b]:this.nodes[this.nodes.length+b]},slice:function(b,a){return new d(this.nodes.slice(b,
a))},subtrailTo:function(b,a){return this.slice(0,_.indexOf(this.nodes,b)+(a?0:1))},isEmpty:function(){return 0===this.nodes.length},getTransform:function(){var b=new phet.math.Transform3;_.each(this.nodes,function(a){b.appendTransform(a.transform)});return b},addAncestor:function(b,a){var c=this.nodes[0];this.nodes.unshift(b);c&&this.indices.unshift(void 0===a?_.indexOf(b.children,c):a);this.length++;for(c=0;c<this.length;c++)this[c]=this.nodes[c]},removeAncestor:function(){this.nodes.shift();this.indices.length&&
this.indices.shift();this.length--;delete this[this.length];for(var b=0;b<this.length;b++)this[b]=this.nodes[b]},addDescendant:function(b,a){var c=this.lastNode();this.nodes.push(b);c&&this.indices.push(void 0===a?_.indexOf(c.children,b):a);this.length++;this[this.length-1]=b},removeDescendant:function(){this.nodes.pop();this.indices.length&&this.indices.pop();this.length--;delete this[this.length]},reindex:function(){this.indices=[];for(var b=1;b<this.length;b++)this.indices.push(_.indexOf(this.nodes[b-
1].children,this.nodes[b]))},equals:function(b){if(this.length!==b.length)return!1;for(var a=0;a<this.nodes.length;a++)if(this.nodes[a]!==b.nodes[a])return!1;return!0},isExtensionOf:function(b,a){if(this.length<=b.length-(a?1:0))return!1;for(var c=0;c<b.nodes.length;c++)if(this.nodes[c]!==b.nodes[c])return!1;return!0},nodeFromTop:function(b){return this.nodes[this.length-1-b]},lastNode:function(){return this.nodeFromTop(0)},rootNode:function(){return this.nodes[0]},previous:function(){if(1>=this.nodes.length)return null;
var b=this.nodeFromTop(0),a=this.nodeFromTop(1),c=_.indexOf(a.children,b),b=this.nodes.slice(0,this.nodes.length-1);if(0!==c)for(b.push(a.children[c-1]);0!==b[b.length-1].children.length;)a=b[b.length-1],b.push(a.children[a.children.length-1]);return new d(b)},next:function(){var b=this.nodes.slice(0),a=this.nodeFromTop(0);if(0<a.children.length)return b.push(a.children[0]),new d(b);for(a=this.nodes.length-1;0<a;){var c=this.nodes[a],e=this.nodes[a-1];b.pop();c=_.indexOf(e.children,c);if(c!==e.children.length-
1)return b.push(e.children[c+1]),new d(b);a--}return null},compare:function(b){phet.assert(!this.isEmpty(),"cannot compare with an empty trail");phet.assert(!b.isEmpty(),"cannot compare with an empty trail");phet.assert(this.nodes[0]===b.nodes[0],"for Trail comparison, trails must have the same root node");for(var a=Math.min(this.nodes.length,b.nodes.length),c=1;c<a;c++)if(this.nodes[c]!==b.nodes[c])return a=_.indexOf(this.nodes[c-1].children,this.nodes[c]),b=_.indexOf(b.nodes[c-1].children,b.nodes[c]),
phet.assert(a!==b),a<b?-1:1;return this.nodes.length<b.nodes.length?-1:this.nodes.length>b.nodes.length?1:0},getUniqueId:function(){return _.map(this.nodes,function(b){return b.getId()}).join("-")},toString:function(){this.reindex();return!this.length?"Empty Trail":"[Trail "+this.indices.join(".")+"]"}}})();scenery=scenery||{};
(function(){scenery.TrailPointer=function(b,a){phet.assert(b instanceof scenery.Trail,"trail is not a trail");this.trail=b;this.setBefore(a)};var d=scenery.TrailPointer;d.prototype={constructor:d,copy:function(){return new d(this.trail.copy(),this.isBefore)},setBefore:function(b){this.isBefore=b;this.isAfter=!b},getRenderSwappedPointer:function(){var b=this.isBefore?this.trail.previous():this.trail.next();return null===b?null:new d(b,!this.isBefore)},getRenderBeforePointer:function(){return this.isBefore?
this:this.getRenderSwappedPointer()},getRenderAfterPointer:function(){return this.isAfter?this:this.getRenderSwappedPointer()},compareRender:function(b){phet.assert(null!==b);var a=this.getRenderBeforePointer();b=b.getRenderBeforePointer();return null!==a&&null!==b?a.trail.compare(b.trail):a===b?0:null===a?1:-1},compareNested:function(b){phet.assert(b);var a=this.trail.compare(b.trail);return 0===a?this.isBefore===b.isBefore?0:this.isBefore?-1:1:this.trail.isExtensionOf(b.trail)?b.isBefore?1:-1:b.trail.isExtensionOf(this.trail)?
this.isBefore?-1:1:a},equalsRender:function(b){return 0===this.compareRender(b)},equalsNested:function(b){return 0===this.compareNested(b)},nestedForwards:function(){if(this.isBefore)0<this.trail.lastNode().children.length?this.trail.addDescendant(this.trail.lastNode().children[0],0):this.setBefore(!1);else{if(0===this.trail.indices.length)return null;var b=this.trail.indices[this.trail.indices.length-1];this.trail.removeDescendant();this.trail.lastNode().children.length>b+1&&(this.trail.addDescendant(this.trail.lastNode().children[b+
1],b+1),this.setBefore(!0))}},nestedBackwards:function(){if(this.isBefore){if(0===this.trail.indices.length)return null;var b=this.trail.indices[this.trail.indices.length-1];this.trail.removeDescendant();0<=b-1&&(this.trail.addDescendant(this.trail.lastNode().children[b-1],b-1),this.setBefore(!1))}else 0<this.trail.lastNode().children.length?(b=this.trail.lastNode().children,this.trail.addDescendant(b[b.length-1],b.length-1)):this.setBefore(!0)},eachNodeBetween:function(b,a){this.eachTrailBetween(b,
function(b){a(b.lastNode())})},eachTrailBetween:function(b,a){this.isBefore&&a(this.trail);this.depthFirstUntil(b,function(b){b.isBefore&&a(b.trail)},!0)},depthFirstUntil:function(b,a,c){phet.assert(this.compareNested(b)<=(c?-1:0),"TrailPointer.depthFirstUntil pointers out of order, possibly in both meanings of the phrase!");phet.assert(this.trail.rootNode()===b.trail.rootNode(),"TrailPointer.depthFirstUntil takes pointers with the same root");this.trail.reindex();b.trail.reindex();for(var e=this.copy(),
f=!0;!e.equalsNested(b);){var d=!1;f?(c||(d=a(e)),f=!1):d=a(e);d&&e.isBefore?e.setBefore(!1):e.nestedForwards()}c||a(e)},toString:function(){return"["+(this.isBefore?"before":"after")+" "+this.trail.toString().slice(1)}}})();scenery=scenery||{};
(function(){function d(a,b){return new e(a,b)}function b(a,b){phet.assert(void 0!==b);return a.start.plus(a.startTangent.perpendicular().negated().times(b/2))}function a(a,b){phet.assert(void 0!==b);return a.start.plus(a.startTangent.perpendicular().times(b/2))}function c(a,b,e,c){return d(((a.x*b.y-a.y*b.x)*(e.x-c.x)-(a.x-b.x)*(e.x*c.y-e.y*c.x))/((a.x-b.x)*(e.y-c.y)-(a.y-b.y)*(e.x-c.x)),((a.x*b.y-a.y*b.x)*(e.y-c.y)-(a.y-b.y)*(e.x*c.y-e.y*c.x))/((a.x-b.x)*(e.y-c.y)-(a.y-b.y)*(e.x-c.x)))}var e=phet.math.Vector2;
scenery.Shape=function(a,b){this.pieces=[];this.subpaths=[];this.bounds=phet.math.Bounds2.NOTHING;this._strokedShape=null;this._strokedShapeComputed=!1;this._strokedShapeStyles=null;var e=this;void 0!==a&&_.each(a,function(a){e.addPiece(a)});b&&this.addPiece(new h.Close)};var f=scenery.Shape;f.prototype={constructor:f,moveTo:function(a,b){if(void 0===b&&"object"===typeof a){var c=a instanceof e?a:new e(a.x,a.y);this.addPiece(new h.MoveTo(c))}else this.addPiece(new h.MoveTo(d(a,b)));return this},lineTo:function(a,
b){if(void 0===b&&"object"===typeof a){var c=a instanceof e?a:new e(a.x,a.y);this.addPiece(new h.LineTo(c))}else this.addPiece(new h.LineTo(d(a,b)));return this},quadraticCurveTo:function(a,b,c,f){void 0===c&&"object"===typeof a?(a=a instanceof e?a:new e(a.x,a.y),b=b instanceof e?b:new e(b.x,b.y),this.addPiece(new h.QuadraticCurveTo(a,b))):this.addPiece(new h.QuadraticCurveTo(d(a,b),d(c,f)));return this},rect:function(a,b,c,f){void 0===c&&"object"===typeof a&&"object"===typeof b?(a=a instanceof e?
a:new e(a.x,a.y),b=b instanceof e?b:new e(b.x,b.y),this.addPiece(new h.Rect(a,b))):this.addPiece(new h.Rect(d(a,b),d(a+c,b+f)));return this},close:function(){this.addPiece(new h.Close)},addPiece:function(a){this.pieces.push(a);a.applyPiece(this);this.invalidate()},writeToContext:function(a){_.each(this.pieces,function(b){b.writeToContext(a)})},getSVGPath:function(){return _.map(this.pieces,function(a){return a.getSVGPathFragment()}).join(" ")},transformed:function(a){return new f(_.flatten(_.map(this.pieces,
function(b){return b.transformed(a)}),!0))},computeBounds:function(a){return a?this.bounds.union(this.getStrokedShape(a).bounds):this.bounds},containsPoint:function(a){var b=0,e=new phet.math.Ray2(a,d(1,0));_.each(this.subpaths,function(a){a.isDrawable()&&(_.each(a.segments,function(a){b+=a.windingIntersection(e)}),a.hasClosingSegment()&&(b+=a.getClosingSegment().windingIntersection(e)))});return 0!==b},intersectsBounds:function(a){var b=!1;_.each(this.subpaths,function(e){e.isDrawable()&&(_.each(e.segments,
function(e){b=b&&e.intersectsBounds(a)}),e.hasClosingSegment()&&(b=b&&e.getClosingSegment().intersectsBounds(a)))});return b},invalidate:function(){this._strokedShapeComputed=!1},getStrokedShape:function(e){function d(a,b,f){var k=a.plus(b.perpendicular().negated().times(u/2));a=a.plus(f.perpendicular().negated().times(u/2));if(0<b.perpendicular().dot(f))switch(e.lineJoin){case "round":throw Error("stroked round lineJoin not implemented .. add arc/arcTo");case "miter":var g=b.angleBetween(f.negated());
1/Math.sin(g/2)<=e.miterLimit&&(b=c(k,k.plus(b),a,a.plus(f)),s.addPiece(new h.LineTo(b)));s.addPiece(new h.LineTo(a));break;case "bevel":s.addPiece(new h.LineTo(a))}else k.equals(a)||s.addPiece(new h.LineTo(a))}function g(a,b){switch(e.lineCap){case "butt":s.addPiece(new h.LineTo(a.plus(b.perpendicular().times(u/2))));break;case "round":throw Error("stroked round lineCap not implemented .. add arc/arcTo");case "square":var c=b.perpendicular().negated().times(u/2),f=b.perpendicular().times(u/2),d=
b.times(u/2);s.addPiece(new h.LineTo(a.plus(c).plus(d)));s.addPiece(new h.LineTo(a.plus(f).plus(d)));s.addPiece(new h.LineTo(a.plus(f)))}}void 0===e&&(e=new k);if(this._strokedShapeComputed&&this._strokedShapeStyles.equals(e))return this._strokedShape;var t=_.filter(this.subpaths,function(a){return a.isDrawable()}),s=new f,u=e.lineWidth;_.each(t,function(e){var c,f=e.segments,k=_.last(f).end.equals(_.first(f).start),n=k?null:new m.Line(f[f.length-1].end,f[0].start);s.addPiece(new h.MoveTo(b(_.first(f),
u)));for(c=0;c<f.length;c++)0<c&&d(f[c].start,f[c-1].endTangent,f[c].startTangent,!0),_.each(f[c].strokeLeft(u),function(a){s.addPiece(a)});e.closed?k?(d(_.last(f).end,_.last(f).endTangent,_.first(f).startTangent),s.addPiece(new h.Close),s.addPiece(new h.MoveTo(a(_.first(f),u))),d(_.last(f).end,_.first(f).startTangent.negated(),_.last(f).endTangent.negated())):(d(n.start,_.last(f).endTangent,n.startTangent),_.each(n.strokeLeft(u),function(a){s.addPiece(a)}),d(n.end,n.endTangent,_.first(f).startTangent),
s.addPiece(new h.Close),s.addPiece(new h.MoveTo(a(_.first(f),u))),d(n.end,_.first(f).startTangent.negated(),n.endTangent.negated()),_.each(n.strokeRight(u),function(a){s.addPiece(a)}),d(n.start,n.startTangent.negated(),_.last(f).endTangent.negated())):g(_.last(f).end,_.last(f).endTangent);for(c=f.length-1;0<=c;c--)c<f.length-1&&d(f[c].end,f[c+1].startTangent.negated(),f[c].endTangent.negated(),!1),_.each(f[c].strokeRight(u),function(a){s.addPiece(a)});e.closed||g(_.first(f).start,_.first(f).startTangent.negated());
s.addPiece(new h.Close)});this._strokedShape=s;this._strokedShapeComputed=!0;this._strokedShapeStyles=new k(e);return s},ensure:function(a){this.hasSubpaths()||(this.addSubpath(new g),this.getLastSubpath().addPoint(a))},addSubpath:function(a){this.subpaths.push(a)},hasSubpaths:function(){return 0<this.subpaths.length},getLastSubpath:function(){return _.last(this.subpaths)}};f.rectangle=function(a,b,e,c){return(new f).rect(a,b,e,c)};f.rect=f.rectangle;f.bounds=function(a){return(new f).rect(d(a.minX,
a.minY),d(a.maxX,a.maxY))};f.lineSegment=function(a,b){return(new f).moveTo(a).lineTo(b)};f.regularPolygon=function(a,b){var e=!0;return new f(_.map(_.range(a),function(c){c=2*Math.PI*c/a;return e?(e=!1,new h.MoveTo(d(b*Math.cos(c),b*Math.sin(c)))):new h.LineTo(d(b*Math.cos(c),b*Math.sin(c)))}),!0)};f.LineStyles=function(a){void 0===a&&(a={});this.lineWidth=void 0!==a.lineWidth?a.lineWidth:1;this.lineCap=void 0!==a.lineCap?a.lineCap:"butt";this.lineJoin=void 0!==a.lineJoin?a.lineJoin:"miter";this.miterLimit=
void 0!==a.miterLimit?a.miterLimit:10};var k=f.LineStyles;k.prototype={constructor:k,equals:function(a){return this.lineWidth===a.lineWidth&&this.lineCap===a.lineCap&&this.lineJoin===a.lineJoin&&this.miterLimit===a.miterLimit}};f.Subpath=function(){this.points=[];this.segments=[];this.closed=!1};var g=f.Subpath;g.prototype={addPoint:function(a){this.points.push(a)},addSegment:function(a){this.segments.push(a)},close:function(){this.closed=!0},getFirstPoint:function(){return _.first(this.points)},
getLastPoint:function(){return _.last(this.points)},isDrawable:function(){return 0<this.segments.length},isClosed:function(){return this.closed},hasClosingSegment:function(){return!this.getFirstPoint().equals(this.getLastPoint())},getClosingSegment:function(){phet.assert(this.isClosed());return new m.Line(this.getLastPoint(),this.getFirstPoint())}};f.Piece={};var h=f.Piece;h.Close=function(){};h.Close.prototype={constructor:h.Close,writeToContext:function(a){a.closePath()},getSVGPathFragment:function(){return"Z"},
transformed:function(){return[this]},applyPiece:function(a){if(a.hasSubpaths()){var b=a.getLastSubpath(),e=new g;b.close();a.addSubpath(e);e.addPoint(b.getFirstPoint())}}};h.MoveTo=function(a){this.point=a};h.MoveTo.prototype={constructor:h.MoveTo,writeToContext:function(a){a.moveTo(this.point.x,this.point.y)},getSVGPathFragment:function(){return"M "+this.point.x+" "+this.point.y},transformed:function(a){return[new h.MoveTo(a.timesVector2(this.point))]},applyPiece:function(a){var b=new g;b.addPoint(this.point);
a.addSubpath(b)}};h.LineTo=function(a){this.point=a};h.LineTo.prototype={constructor:h.LineTo,writeToContext:function(a){a.lineTo(this.point.x,this.point.y)},getSVGPathFragment:function(){return"L "+this.point.x+" "+this.point.y},transformed:function(a){return[new h.LineTo(a.timesVector2(this.point))]},applyPiece:function(a){if(a.hasSubpaths()){var b=a.getLastSubpath().getLastPoint(),e=this.point,c=new m.Line(b,e);a.getLastSubpath().addSegment(c);a.getLastSubpath().addPoint(e);a.bounds=a.bounds.withPoint(b).withPoint(e);
phet.assert(!isNaN(a.bounds.x()))}else a.ensure(this.point)}};h.QuadraticCurveTo=function(a,b){this.controlPoint=a;this.point=b};h.QuadraticCurveTo.prototype={constructor:h.QuadraticCurveTo,writeToContext:function(a){a.quadraticCurveTo(this.controlPoint.x,this.controlPoint.y,this.point.x,this.point.y)},getSVGPathFragment:function(){return"Q "+this.controlPoint.x+" "+this.controlPoint.y+" "+this.point.x+" "+this.point.y},transformed:function(a){return[new h.QuadraticCurveTo(a.timesVector2(this.controlPoint),
a.timesVector2(this.point))]},applyPiece:function(a){a.ensure(this.controlPoint);var b=a.getLastSubpath().getLastPoint(),b=new m.Quadratic(b,this.controlPoint,this.point);a.getLastSubpath().addSegment(b);a.getLastSubpath().addPoint(this.point);a.bounds=a.bounds.union(b.bounds)}};h.Rect=function(a,b){this.upperLeft=a;this.lowerRight=b;this.x=this.upperLeft.x;this.y=this.upperLeft.y;this.width=this.lowerRight.x-this.x;this.height=this.lowerRight.y-this.y};h.Rect.prototype={constructor:h.Rect,writeToContext:function(a){a.rect(this.x,
this.y,this.width,this.height)},getSVGPathFragment:function(){return"M "+this.upperLeft.x+" "+this.upperLeft.y+" L "+this.lowerRight.x+" "+this.upperLeft.y+" L "+this.lowerRight.x+" "+this.lowerRight.y+" L "+this.upperLeft.x+" "+this.lowerRight.y+" Z M "+this.upperLeft.x+" "+this.upperLeft.y},transformed:function(a){var b=a.timesVector2(d(this.x,this.y)),e=a.timesVector2(d(this.x+this.width,this.y)),c=a.timesVector2(d(this.x+this.width,this.y+this.height));a=a.timesVector2(d(this.x,this.y+this.height));
return[new h.MoveTo(b),new h.LineTo(e),new h.LineTo(c),new h.LineTo(a),new h.Close,new h.MoveTo(b)]},applyPiece:function(a){var b=new g;a.addSubpath(b);b.addPoint(d(this.x,this.y));b.addPoint(d(this.x+this.width,this.y));b.addPoint(d(this.x+this.width,this.y+this.height));b.addPoint(d(this.x,this.y+this.height));b.addSegment(new m.Line(b.points[0],b.points[1]));b.addSegment(new m.Line(b.points[1],b.points[2]));b.addSegment(new m.Line(b.points[2],b.points[3]));b.close();a.addSubpath(new g);a.getLastSubpath().addPoint(d(this.x,
this.y));a.bounds=a.bounds.withPoint(this.upperLeft).withPoint(this.lowerRight);phet.assert(!isNaN(a.bounds.x()))}};f.Segment={};var m=f.Segment;m.Line=function(a,b){this.start=a;this.end=b;this.endTangent=this.startTangent=b.minus(a).normalized();this.bounds=(new phet.math.Bounds2).withPoint(a).withPoint(b)};m.Line.prototype={constructor:m.Line,toPieces:function(){return[new h.LineTo(this.end)]},strokeLeft:function(a){return[new h.LineTo(this.end.plus(this.endTangent.perpendicular().negated().times(a/
2)))]},strokeRight:function(a){return[new h.LineTo(this.start.plus(this.startTangent.perpendicular().times(a/2)))]},intersectsBounds:function(){throw Error("Segment.Line.intersectsBounds unimplemented");},windingIntersection:function(a){var b=this.start,e=this.end,f=c(b,e,a.pos,a.pos.plus(a.dir));return!isFinite(f.x)||!isFinite(f.y)||b.x!==e.x&&(b.x>e.x?f.x>=b.x||f.x<e.x:f.x<=b.x||f.x>e.x)||b.y!==e.y&&(b.y>e.y?f.y>=b.y||f.y<e.y:f.y<=b.y||f.y>e.y)||0>f.minus(a.pos).dot(a.dir)?0:0>a.dir.perpendicular().dot(e.minus(b))?
1:-1}};m.Quadratic=function(a,b,e,c){this.start=a;this.control=b;this.end=e;if(!c){c=a.equals(b);var f=e.equals(b);phet.assert(!c||!f);this.startTangent=c?e.minus(a).normalized():b.minus(a).normalized();this.endTangent=f?e.minus(a).normalized():e.minus(b).normalized();this.bounds=new phet.math.Bounds2(Math.min(a.x,e.x),Math.min(a.y,e.y),Math.max(a.x,e.x),Math.max(a.y,e.y));c=2*(e.x-2*b.x+a.x);0!==c&&(c=-2*(b.x-a.x)/c,0<c&&1>c&&(this.bounds=this.bounds.withPoint(this.positionAt(c))));e=2*(e.y-2*b.y+
a.y);0!==e&&(c=-2*(b.y-a.y)/e,0<c&&1>c&&(this.bounds=this.bounds.withPoint(this.positionAt(c))))}};m.Quadratic.prototype={constructor:m.Quadratic,positionAt:function(a){var b=1-a;return this.start.times(b*b).plus(this.control.times(2*b*a)).plus(this.end.times(a*a))},derivativeAt:function(a){return this.control.minus(this.start).times(2*(1-a)).plus(this.end.minus(this.control).times(2*a))},offsetTo:function(a,b,e){for(var c=[this],f=0;5>f;f++)c=_.flatten(_.map(c,function(a){return a.subdivided(!0)}));
c=_.map(c,function(b){return b.approximateOffset(a)});e&&(c.reverse(),c=_.map(c,function(a){return a.reversed(!0)}));e=_.map(c,function(a){return new h.QuadraticCurveTo(a.control,a.end)});return b?[new h.MoveTo(c[0].start)].concat(e):e},subdivided:function(a){var b=this.start.plus(this.control).times(0.5),e=this.control.plus(this.end).times(0.5),c=b.plus(e).times(0.5);return[new m.Quadratic(this.start,b,c,a),new m.Quadratic(c,e,this.end,a)]},reversed:function(){return new m.Quadratic(this.end,this.control,
this.start)},approximateOffset:function(a){return new m.Quadratic(this.start.plus((this.start.equals(this.control)?this.end.minus(this.start):this.control.minus(this.start)).perpendicular().normalized().times(a)),this.control.plus(this.end.minus(this.start).perpendicular().normalized().times(a)),this.end.plus((this.end.equals(this.control)?this.end.minus(this.start):this.end.minus(this.control)).perpendicular().normalized().times(a)))},toPieces:function(){return[new h.QuadraticCurveTo(this.control,
this.end)]},strokeLeft:function(a){return this.offsetTo(-a/2,!1,!1)},strokeRight:function(a){return this.offsetTo(a/2,!1,!0)},intersectsBounds:function(){throw Error("Segment.Quadratic.intersectsBounds unimplemented");},windingIntersection:function(a){var b=phet.math.Matrix3.rotation2(-a.dir.angle());phet.assert(0.99<b.timesVector2(a.dir).x);var e=b.timesVector2(this.start),c=b.timesVector2(this.control),f=b.timesVector2(this.end),d=c.y*c.y-e.y*f.y;if(1E-8>d)return 0;b=(e.y-c.y+Math.sqrt(d))/(e.y-
2*c.y+f.y);e=(e.y-c.y-Math.sqrt(d))/(e.y-2*c.y+f.y);c=this.positionAt(b).minus(a.pos);f=this.positionAt(e).minus(a.pos);c=0<b&&0<c.dot(a.dir);f=0<e&&0<f.dot(a.dir);d=0;c&&(d+=0>a.dir.perpendicular().dot(this.derivativeAt(b))?1:-1);f&&(d+=0>a.dir.perpendicular().dot(this.derivativeAt(e))?1:-1);return d}};m.Cubic=function(a,b,e,c){this.start=a;this.control1=b;this.control2=e;this.end=c};m.Cubic.prototype={}})();scenery=scenery||{};
(function(){scenery.DefaultLayerStrategy={enter:function(d,b){var a=d.lastNode();if(a.hasSelf()){if(!b.getCurrentLayerType()||!b.getCurrentLayerType().supportsNode(a)){var a=a._supportedLayerTypes,c=b.bestPreferredLayerTypeFor(a);c?b.switchToType(d,c):b.switchToType(d,a[0])}b.markSelf()}},exit:function(){}};scenery.SeparateLayerStrategy=function(d){return{strategy:d,enter:function(b,a){a.switchToType(b,a.getCurrentLayerType());d.enter(b,a)},exit:function(b,a){a.switchToType(b,a.getCurrentLayerType());
d.exit(b,a)}}};scenery.LayerTypeStrategy=function(d,b){return{strategy:d,enter:function(a,c){c.pushPreferredLayerType(b);c.getCurrentLayerType().supports(b)||c.switchToType(a,b);d.enter(a,c)},exit:function(a,b){b.popPreferredLayerType();d.exit(a,b)}}}})();scenery=scenery||{};
(function(){var d=phet.math.Bounds2,b=1;scenery.Node=function(a){this._id=b++;this._visible=!0;this._cursor=this._clipShape=null;this.children=[];this.parents=[];this.transform=new phet.math.Transform3;this._inputListeners=[];this._eventListeners=[];this._includeStrokeInHitRegion=!1;this._childBounds=this._selfBounds=this._bounds=d.NOTHING;this._childBoundsDirty=this._selfBoundsDirty=this._boundsDirty=!0;this._oldPaintMarked=this._childPaintDirty=this._paintDirty=!1;a&&this.mutate(a)};var a=scenery.Node,
c=phet.math.Matrix3;a.prototype={constructor:a,enterState:function(a){this.transform.isIdentity()||a.applyTransformationMatrix(this.transform.getMatrix());this._clipShape&&a.pushClipShape(this._clipShape)},exitState:function(a){this._clipShape&&a.popClipShape();this.transform.isIdentity()||a.applyTransformationMatrix(this.transform.getInverse())},insertChild:function(a,b){phet.assert(null!==a&&void 0!==a&&!_.contains(this.children,a));a.parents.push(this);this.children.splice(b,0,a);a.invalidateBounds();
a.invalidatePaint();this.dispatchEvent("insertChild",{parent:this,child:a,index:b})},addChild:function(a){this.insertChild(a,this.children.length)},removeChild:function(a){phet.assert(this.isChild(a));a.markOldPaint();var b=_.indexOf(a.parents,this),c=_.indexOf(this.children,a);a.parents.splice(b,1);this.children.splice(c,1);this.invalidateBounds();this.dispatchEvent("removeChild",{parent:this,child:a,index:c})},setChildren:function(a){var b=this;this.children!==a&&(_.each(this.children.slice(0),
function(){b.removeChild(b)}),_.each(a,function(){b.addChild(b)}))},detach:function(){var a=this;_.each(this.parents.slice(0),function(b){b.removeChild(a)})},validateBounds:function(){var a=this;this._selfBoundsDirty&&(this._selfBoundsDirty=!1,this.markDirtyRegion(this._selfBounds));this._childBoundsDirty&&(_.each(this.children,function(a){a.validateBounds()}),this._childBounds=d.NOTHING,_.each(this.children,function(b){a._childBounds=a._childBounds.union(b._bounds)}),this._childBoundsDirty=!1);if(this._boundsDirty){var b=
this._bounds,c=this.localToParentBounds(this._selfBounds).union(a.localToParentBounds(this._childBounds));c.equals(b)||(this._bounds=c,_.each(this.parents,function(a){a.invalidateBounds()}));this._boundsDirty=!1}},validatePaint:function(){this._paintDirty&&(this.markDirtyRegion(this.parentToLocalBounds(this._bounds)),this._paintDirty=!1);if(this._childPaintDirty||this._oldPaintMarked)this._oldPaintMarked=this._childPaintDirty=!1,_.each(this.children,function(a){a.validatePaint()})},invalidateBounds:function(){this._boundsDirty=
!0;_.each(this.parents,function(a){a.invalidateChildBounds()})},invalidateChildBounds:function(){this._childBoundsDirty||(this._childBoundsDirty=!0,_.each(this.parents,function(a){a.invalidateChildBounds()}))},invalidatePaint:function(){this._paintDirty=!0;_.each(this.parents,function(a){a.invalidateChildPaint()})},invalidateChildPaint:function(){this._childPaintDirty||(this._childPaintDirty=!0,_.each(this.parents,function(a){a.invalidateChildPaint()}))},invalidateSelf:function(a){phet.assert(!isNaN(a.x()));
this.markOldSelfPaint();this._selfBounds.equals(a)||(this._selfBoundsDirty=!0,this.invalidateBounds(),this._selfBounds=a);this.invalidatePaint()},markDirtyRegion:function(a){this.dispatchEventWithTransform("dirtyBounds",{node:this,bounds:a})},markOldSelfPaint:function(){this.markOldPaint(!0)},markLayerRefreshNeeded:function(){this.dispatchEvent("layerRefresh",{node:this})},markOldPaint:function(a){function b(a){return a._oldPaintMarked?!0:_.some(a.parents,function(a){return b(a)})}b(this)||(a?this.markDirtyRegion(this._selfBounds):
(this.markDirtyRegion(this.parentToLocalBounds(this._bounds)),this._oldPaintMarked=!0))},isChild:function(a){var b=_.contains(this.children,a);a=_.contains(a.parents,this);phet.assert(b===a);return b},getSelfBounds:function(){return this._selfBounds},getBounds:function(){this.validateBounds();return this._bounds},trailUnderPoint:function(a){phet.assert(a,"trailUnderPointer requires a point");this.validateBounds();if(!this._bounds.containsPoint(a))return null;a=this.transform.inversePosition2(a);if(0<
this.children.length&&this._childBounds.containsPoint(a))for(var b=this.children.length-1;0<=b;b--){var c=this.children[b].trailUnderPoint(a);if(c)return c.addAncestor(this,b),c}return this._selfBounds.containsPoint(a)&&this.containsPointSelf(a)?new scenery.Trail(this):null},containsPoint:function(a){return null!==this.trailUnderPoint(a)},containsPointSelf:function(a){return this._selfBounds.containsPoint(a)},intersectsBoundsSelf:function(a){return this._selfBounds.intersectsBounds(a)},hasSelf:function(){return!1},
hasParent:function(){return 0!==this.parents.length},hasChildren:function(){return 0<this.children.length},walkDepthFirst:function(a){a(this);_.each(this.children,function(b){b.walkDepthFirst(a)})},getChildrenWithinBounds:function(a){return _.filter(this.children,function(b){return!b._bounds.intersection(a).isEmpty()})},getChildren:function(){return this.children.slice(0)},addInputListener:function(a){-1===_.indexOf(this._inputListeners,a)&&this._inputListeners.push(a)},removeInputListener:function(a){phet.assert(-1!==
_.indexOf(this._inputListeners,a));this._inputListeners.splice(_.indexOf(this._inputListeners,a),1)},getInputListeners:function(){return this._inputListeners.slice(0)},addEventListener:function(a){-1===_.indexOf(this._eventListeners,a)&&this._eventListeners.push(a)},removeEventListener:function(a){phet.assert(-1!==_.indexOf(this._eventListeners,a));this._eventListeners.splice(_.indexOf(this._eventListeners,a),1)},getEventListeners:function(){return this._eventListeners.slice(0)},dispatchEvent:function(a,
b){function c(h){d.addAncestor(h);b.trail=d;_.each(h.getEventListeners(),function(c){if(c[a])c[a](b)});_.each(h.parents,function(a){c(a)});d.removeAncestor()}var d=new scenery.Trail;c(this)},dispatchEventWithTransform:function(a,b){function c(m){d.addAncestor(m);h.push(new phet.math.Transform3(m.getMatrix().timesMatrix(h[h.length-1].getMatrix())));b.transform=h[h.length-1];b.trail=d;_.each(m.getEventListeners(),function(c){if(c[a])c[a](b)});_.each(m.parents,function(a){c(a)});h.pop();d.removeAncestor()}
var d=new scenery.Trail,h=[new phet.math.Transform3];c(this)},translate:function(a,b,d){"number"===typeof a?d?this.prependMatrix(c.translation(a,b)):this.appendMatrix(c.translation(a,b)):this.translate(a.x,a.y,b)},scaleBy:function(a,b,d){"number"===typeof a?void 0===b?this.appendMatrix(c.scaling(a,a)):d?this.prependMatrix(c.scaling(a,b)):this.appendMatrix(c.scaling(a,b)):this.scaleBy(a.x,a.y,b)},rotate:function(a,b){b?this.prependMatrix(c.rotation2(a)):this.appendMatrix(c.rotation2(a))},rotateAround:function(a,
b){var d=c.translation(-a.x,-a.y),d=c.rotation2(b).timesMatrix(d),d=c.translation(a.x,a.y).timesMatrix(d);this.prependMatrix(d)},getX:function(){return this.getTranslation().x},setX:function(a){this.setTranslation(a,this.getY());return this},getY:function(){return this.getTranslation().y},setY:function(a){this.setTranslation(this.getX(),a);return this},getScale:function(){return this.transform.getMatrix().scaling()},setScale:function(a,b){var c=this.getScale();"number"===typeof a?(void 0===b&&(b=
a),this.appendMatrix(phet.math.Matrix3.scaling(a/c.x,b/c.y))):this.appendMatrix(phet.math.Matrix3.scaling(a.x/c.x,a.y/c.y));return this},getRotation:function(){return this.transform.getMatrix().rotation()},setRotation:function(a){this.appendMatrix(phet.math.Matrix3.rotation2(a-this.getRotation()));return this},setTranslation:function(a,b){var c=this.getTranslation();"number"===typeof a?this.translate(a-c.x,b-c.y,!0):this.translate(a.x-c.x,a.y-c.y,!0);return this},getTranslation:function(){return this.transform.getMatrix().translation()},
notifyTransformChange:function(a,b){this.dispatchEventWithTransform("transform",{node:this,type:b,matrix:a})},appendMatrix:function(a){this.markOldPaint();this.transform.append(a);this.notifyTransformChange(a,"append");this.invalidateBounds();this.invalidatePaint()},prependMatrix:function(a){this.markOldPaint();this.transform.prepend(a);this.notifyTransformChange(a,"prepend");this.invalidateBounds();this.invalidatePaint()},setMatrix:function(a){this.markOldPaint();this.transform.set(a);this.notifyTransformChange(a,
"set");this.invalidateBounds();this.invalidatePaint()},getMatrix:function(){return this.transform.getMatrix()},getLeft:function(){return this.getBounds().minX},setLeft:function(a){this.translate(a-this.getLeft(),0,!0);return this},getRight:function(){return this.getBounds().maxX},setRight:function(a){this.translate(a-this.getRight(),0,!0);return this},getCenterX:function(){return this.getBounds().centerX()},setCenterX:function(a){this.translate(a-this.getCenterX(),0,!0);return this},getCenterY:function(){return this.getBounds().centerY()},
setCenterY:function(a){this.translate(0,a-this.getCenterY(),!0);return this},getTop:function(){return this.getBounds().minY},setTop:function(a){this.translate(0,a-this.getTop(),!0);return this},getBottom:function(){return this.getBounds().maxY},setBottom:function(a){this.translate(0,a-this.getBottom(),!0);return this},getWidth:function(){return this.getBounds().width()},getHeight:function(){return this.getBounds().height()},getId:function(){return this._id},isVisible:function(){return this._visible},
setVisible:function(a){a!==this._visible&&(this._visible&&this.markOldSelfPaint(),(this._visible=a)&&this.invalidatePaint());return this},setCursor:function(a){this._cursor="auto"===a?null:a},getCursor:function(){return this._cursor},getUniqueTrail:function(){for(var a=new scenery.Trail,b=this;b;)a.addAncestor(b),phet.assert(1>=b.parents.length),b=b.parents[0];return a},localToParentPoint:function(a){return this.transform.transformPosition2(a)},localToParentBounds:function(a){return this.transform.transformBounds2(a)},
parentToLocalPoint:function(a){return this.transform.inversePosition2(a)},parentToLocalBounds:function(a){return this.transform.inverseBounds2(a)},set cursor(a){this.setCursor(a)},get cursor(){return this.isCursor()},set visible(a){this.setVisible(a)},get visible(){return this.isVisible()},set matrix(a){this.setMatrix(a)},get matrix(){return this.getMatrix()},set translation(a){this.setTranslation(a)},get translation(){return this.getTranslation()},set rotation(a){this.setRotation(a)},get rotation(){return this.getRotation()},
set scale(a){this.setScale(a)},get scale(){return this.getScale()},set x(a){this.setX(a)},get x(){return this.getX()},set y(a){this.setY(a)},get y(){return this.getY()},set left(a){this.setLeft(a)},get left(){return this.getLeft()},set right(a){this.setRight(a)},get right(){return this.getRight()},set top(a){this.setTop(a)},get top(){return this.getTop()},set bottom(a){this.setBottom(a)},get bottom(){return this.getBottom()},set centerX(a){this.setCenterX(a)},get centerX(){return this.getCenterX()},
set centerY(a){this.setCenterY(a)},get centerY(){return this.getCenterY()},get width(){return this.getWidth()},get height(){return this.getHeight()},get id(){return this.getId()},mutate:function(a){var b=this;_.each(this._mutatorKeys,function(c){void 0!==a[c]&&(b[c]=a[c])})}};a.prototype._mutatorKeys="cursor visible translation x y rotation scale left right top bottom centerX centerY".split(" ");a.prototype._supportedLayerTypes=[];a.prototype.layerStrategy=scenery.DefaultLayerStrategy})();
scenery=scenery||{};
(function(){scenery.Scene=function(b,a){a=_.extend({allowSceneOverflow:!1,allowCSSHacks:!0,allowDevicePixelRatioScaling:!1,preferredSceneLayerType:scenery.LayerType.Canvas,width:b.width(),height:b.height()},a||{});this.backingScale=a.allowDevicePixelRatioScaling?phet.canvas.backingScale(document.createElement("canvas").getContext("2d")):1;scenery.Node.call(this,a);var c=this;this.layers=[];this.lastCursor=null;this.defaultCursor=b.css("cursor");this.$main=b;this.$main.width(a.width);this.$main.height(a.height);
this.sceneBounds=new phet.math.Bounds2(0,0,b.width(),b.height());this.preferredSceneLayerType=a.preferredSceneLayerType;var e=a;e.allowSceneOverflow&&b.css("overflow","hidden");if(e.allowCSSHacks){var d={userSelect:"none",touchCallout:"none",touchAction:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"};_.each(["-webkit-","-moz-","-ms-","-o-",""],function(a){_.each(d,function(e,c){b.css(a+c,e)})})}this.sceneEventListener={insertChild:function(){c.rebuildLayers()},removeChild:function(){c.rebuildLayers()},
dirtyBounds:function(a){var b=a.trail;c.layers.length&&_.each(c.affectedLayers(b),function(b){b.markDirtyRegion(a)})},transform:function(a){var b=a.trail;c.layers.length&&_.each(c.affectedLayers(b),function(b){b.transformChange(a)})},layerRefresh:function(){c.rebuildLayers()}};this.addEventListener(this.sceneEventListener)};var d=scenery.Scene;d.prototype=phet.Object.create(scenery.Node.prototype);d.prototype.constructor=d;d.prototype.updateScene=function(b){this.validateBounds();this.validatePaint();
if(this.layers.length){var a=this;_.each(this.layers,function(c){c.render(a,b)});this.updateCursor()}};d.prototype.renderScene=function(){this.updateScene()};d.prototype.rebuildLayers=function(){this.disposeLayers();var b=new scenery.LayerState;this.preferredSceneLayerType&&b.pushPreferredLayerType(this.preferredSceneLayerType);var b=b.buildLayers(new scenery.TrailPointer(new scenery.Trail(this),!0),new scenery.TrailPointer(new scenery.Trail(this),!1),null),a={$main:this.$main,scene:this};this.layers=
_.map(b,function(b){var e=b.type.createLayer(a);e.updateBoundaries(b);return e})};d.prototype.reindexLayers=function(){var b=1;_.each(this.layers,function(a){b=a.reindex(b)})};d.prototype.dispose=function(){this.disposeLayers()};d.prototype.disposeLayers=function(){var b=this;_.each(this.layers.slice(0),function(a){a.dispose();b.layers.splice(_.indexOf(b.layers,a),1)})};d.prototype.layerLookup=function(b){phet.assert(!(b.isEmpty()||b.nodes[0]!==this),"layerLookup root matches");if(0===this.layers.length)throw Error("no layers in the scene");
b=new scenery.TrailPointer(b,!0);for(var a=0;a<this.layers.length;a++){var c=this.layers[a];if(1!==b.compareNested(c.endPointer))return phet.assert(-1!==b.compareNested(c.startPointer),"node not contained in a layer"),c}throw Error("node not contained in a layer");};d.prototype.affectedLayers=function(b){var a=[];phet.assert(!(b.isEmpty()||b.nodes[0]!==this),"layerLookup root matches");if(0===this.layers.length)throw Error("no layers in the scene");var c=new scenery.TrailPointer(b,!0);b=new scenery.TrailPointer(b,
!1);for(var e=0;e<this.layers.length;e++){var d=this.layers[e],k=-1!==b.compareNested(d.startPointer),g=1!==c.compareNested(d.endPointer);k&&g&&a.push(d)}return a};d.prototype.renderToCanvas=function(b,a,c){var e=0,d=!1,k={increment:function(){e++},decrement:function(){e--;0===e&&(c&&d)&&c()}};a.clearRect(0,0,b.width,b.height);_.each(this.layers,function(e){e.renderToCanvas(b,a,k)});0===e?c&&c():d=!0};d.prototype.canvasDataURL=function(b){this.canvasSnapshot(function(a){b(a.toDataURL())})};d.prototype.canvasSnapshot=
function(b){var a=document.createElement("canvas");a.width=this.sceneBounds.width();a.height=this.sceneBounds.height();var c=phet.canvas.initCanvas(a);this.renderToCanvas(a,c,function(){b(a,c.getImageData(0,0,a.width,a.height))})};d.prototype.resize=function(b,a){this.$main.width(b);this.$main.height(a);this.sceneBounds=new phet.math.Bounds2(0,0,b,a);this.rebuildLayers()};d.prototype.updateCursor=function(){if(this.input&&this.input.mouse.point){var b=this.trailUnderPoint(this.input.mouse.point);
if(b)for(var a=b.length-1;0<=a;a--){var c=b.nodes[a].getCursor();if(c){this.setSceneCursor(c);return}}}this.setSceneCursor(this.defaultCursor)};d.prototype.setSceneCursor=function(b){b!==this.lastCursor&&(this.lastCursor=b,this.$main.css("cursor",b))};d.prototype.initializeStandaloneEvents=function(b){var a=this.$main[0];this.initializeEvents(_.extend({},b,{preventDefault:!0,listenerTarget:a,pointFromEvent:function(b){var e=a.getBoundingClientRect();return new phet.math.Vector2(b.clientX-e.left,b.clientY-
e.top)}}))};d.prototype.initializeFullscreenEvents=function(b){this.initializeEvents(_.extend({},b,{preventDefault:!0,listenerTarget:document,pointFromEvent:function(a){return new phet.math.Vector2(a.pageX,a.pageY)}}))};d.prototype.initializeEvents=function(b){function a(a,b){for(var e=0;e<a.changedTouches.length;e++){var d=a.changedTouches.item(e);b(d.identifier,c(d))}}if(this.input)throw Error("Attempt to attach events twice to the scene");var c=b.pointFromEvent,e=b.listenerTarget,d=b.preventDefault,
k=new scenery.Input(this);this.input=k;$(e).on("mousedown",function(a){var b=a.originalEvent;d&&a.preventDefault();k.mouseDown(c(b),b)});$(e).on("mouseup",function(a){var b=a.originalEvent;d&&a.preventDefault();k.mouseUp(c(b),b)});$(e).on("mousemove",function(a){var b=a.originalEvent;d&&a.preventDefault();k.mouseMove(c(b),b)});$(e).on("mouseover",function(a){var b=a.originalEvent;d&&a.preventDefault();k.mouseOver(c(b),b)});$(e).on("mouseout",function(a){var b=a.originalEvent;d&&a.preventDefault();
k.mouseOut(c(b),b)});$(e).on("touchstart",function(b){var e=b.originalEvent;d&&b.preventDefault();a(e,function(a,b){k.touchStart(a,b,e)})});$(e).on("touchend",function(b){var e=b.originalEvent;d&&b.preventDefault();a(e,function(a,b){k.touchEnd(a,b,e)})});$(e).on("touchmove",function(b){var e=b.originalEvent;d&&b.preventDefault();a(e,function(a,b){k.touchMove(a,b,e)})});$(e).on("touchcancel",function(b){var e=b.originalEvent;d&&b.preventDefault();a(e,function(a,b){k.touchCancel(a,b,e)})})};d.prototype.resizeOnWindowResize=
function(){var b=this,a=function(){b.resize(window.innerWidth,window.innerHeight)};$(window).resize(a);a()}})();scenery=scenery||{};
(function(){scenery.Input=function(a){this.scene=a;this.mouse=new c;this.fingers=[this.mouse]};var d=scenery.Input;d.prototype={constructor:d,addFinger:function(a){this.fingers.push(a)},removeFinger:function(a){for(var b=this.fingers.length-1;0<=b;b--)this.fingers[b]===a&&this.fingers.splice(b,1)},findTouchById:function(a){return _.find(this.fingers,function(b){return b.id===a})},mouseDown:function(a,b){this.mouse.down(a,b);this.downEvent(this.mouse,b)},mouseUp:function(a,b){this.mouse.up(a,b);this.upEvent(this.mouse,
b)},mouseMove:function(a,b){this.mouse.move(a,b);this.moveEvent(this.mouse,b)},mouseOver:function(a,b){this.mouse.over(a,b)},mouseOut:function(a,b){this.mouse.out(a,b)},touchStart:function(a,b,c){a=new e(a,b,c);this.addFinger(a);this.downEvent(a,c)},touchEnd:function(a,b,e){a=this.findTouchById(a);a.end(b,e);this.removeFinger(a);this.upEvent(a,e)},touchMove:function(a,b,e){a=this.findTouchById(a);a.move(b,e);this.moveEvent(a,e)},touchCancel:function(a,b,e){a=this.findTouchById(a);a.cancel(b,e);this.removeFinger(a);
this.cancelEvent(a,e)},upEvent:function(a,b){var e=this.scene.trailUnderPoint(a.point)||new scenery.Trail(this.scene);this.dispatchEvent(e,"up",a,b);a.trail=e},downEvent:function(a,b){var e=this.scene.trailUnderPoint(a.point)||new scenery.Trail(this.scene);this.dispatchEvent(e,"down",a,b);a.trail=e},moveEvent:function(a,b){var e=this.scene.trailUnderPoint(a.point)||new scenery.Trail(this.scene),c=a.trail||new scenery.Trail(this.scene),d;for(d=0;d<Math.min(e.length,c.length)&&e.nodes[d]===c.nodes[d];d++);
c.length>d&&this.dispatchEvent(c.slice(d),"exit",a,b);e.length>d&&this.dispatchEvent(e.slice(d),"enter",a,b);this.dispatchEvent(e,"move",a,b);a.trail=e},cancelEvent:function(a,b){var e=this.scene.trailUnderPoint(a.point);this.dispatchEvent(e,"cancel",a,b);a.trail=e},dispatchEvent:function(a,e,c,d){d=new b({trail:a,type:e,finger:c,domEvent:d,currentTarget:null,target:a.lastNode()});this.dispatchToFinger(e,c,d);this.dispatchToTargets(a,e,d)},dispatchToFinger:function(a,b,e){if(!e.aborted&&!e.handled){b=
b.listeners.slice(0);for(var c=0;c<b.length;c++){var d=b[c];if(d[a]&&(d[a](e)||e.aborted))break}}},dispatchToTargets:function(a,b,e){if(!e.aborted&&!e.handled)for(var c=a.length-1;0<=c;c--){var d=a.nodes[c];e.currentTarget=d;for(var d=d.getInputListeners(),n=0;n<d.length;n++){var p=d[n];if(p[b]&&(p[b](e)||e.aborted))return}if(e.handled)break}}};scenery.Event=function(a){this.aborted=this.handled=!1;_.extend(this,a)};var b=scenery.Event;b.prototype={constructor:b,handle:function(){this.handled=!0},
abort:function(){this.aborted=this.handled=!0}};scenery.Finger=function(){this.listeners=[]};var a=scenery.Finger;a.prototype={constructor:a,addInputListener:function(a){phet.assert(!_.contains(this.listeners,a));this.listeners.push(a)},removeInputListener:function(a){a=_.indexOf(this.listeners,a);phet.assert(-1!==a);this.listeners.splice(a,1)}};scenery.Mouse=function(){a.call(this);this.point=null;this.rightDown=this.middleDown=this.leftDown=!1;this.isMouse=!0;this.trail=null};var c=scenery.Mouse;
c.prototype=_.extend({},a.prototype,{constructor:c,down:function(a,b){this.point=a;switch(b.button){case 0:this.leftDown=!0;break;case 1:this.middleDown=!0;break;case 2:this.rightDown=!0}},up:function(a,b){this.point=a;switch(b.button){case 0:this.leftDown=!1;break;case 1:this.middleDown=!1;break;case 2:this.rightDown=!1}},move:function(a){this.point=a},over:function(a){this.point=a},out:function(){this.point=null}});scenery.Touch=function(b,e){a.call(this);this.id=b;this.point=e;this.isTouch=!0;
this.trail=null};var e=scenery.Touch;e.prototype=_.extend({},a.prototype,{constructor:e,move:function(a){this.point=a},end:function(a){this.point=a},cancel:function(a){this.point=a}});scenery.Key=function(b){a.call(this);this.key=b;this.isKey=!0;this.trail=null};d=scenery.Key;d.prototype=_.extend({},a.prototype,{constructor:d})})();scenery=scenery||{};
(function(){scenery.SimpleDragHandler=function(b){var a=this;this.options=b;this.dragging=!1;this.startTransformMatrix=this.lastDragPoint=this.node=this.transform=this.trail=this.finger=null;this.mouseButton=void 0;this.transformListener={transform:function(b){if(a.trail.isExtensionOf(b.trail,!0)){b=b.trail.getTransform().getMatrix();var e=a.transform.getMatrix();a.node.prependMatrix(b.inverted().timesMatrix(e));a.transform.set(b)}}};this.dragListener={up:function(b){phet.assert(b.finger===a.finger);
(!b.finger.isMouse||b.domEvent.button===a.mouseButton)&&a.endDrag(b)},cancel:function(b){phet.assert(b.finger===a.finger);a.endDrag(b);a.node.setMatrix(a.startTransformMatrix)},move:function(b){phet.assert(b.finger===a.finger);a.node.translate(a.transform.inverseDelta2(a.finger.point.minus(a.lastDragPoint)),!0);a.lastDragPoint=a.finger.point}}};var d=scenery.SimpleDragHandler;d.prototype={constructor:d,startDrag:function(b){b.finger.dragging=!0;b.finger.addInputListener(this.dragListener);b.trail.rootNode().addEventListener(this.transformListener);
this.dragging=!0;this.finger=b.finger;this.trail=b.trail.subtrailTo(b.currentTarget,!0);this.transform=this.trail.getTransform();this.node=b.currentTarget;this.lastDragPoint=b.finger.point;this.startTransformMatrix=b.currentTarget.getMatrix();this.mouseButton=b.domEvent.button;this.options.start&&this.options.start(b.finger,this.trail,b)},endDrag:function(b){this.finger.dragging=!1;this.finger.removeInputListener(this.dragListener);this.trail.rootNode().removeEventListener(this.transformListener);
this.dragging=!1;this.options.end&&this.options.end(b)},tryToSnag:function(b){!this.dragging&&!b.finger.dragging&&this.startDrag(b)},down:function(b){this.tryToSnag(b)},enter:function(b){this.options.allowTouchSnag&&!b.finger.isMouse&&this.tryToSnag(b)}}})();scenery=scenery||{};
(function(){scenery.RenderState=function(b){this.transform=new phet.math.Transform3;this.layer=null;this.scene=b;this.clipShapes=[];this.childRestrictedBounds=null};var d=scenery.RenderState;d.prototype={constructor:d,pushClipShape:function(b){this.clipShapes.push(this.transform.transformShape(b));this.layer&&this.layer.pushClipShape(b)},popClipShape:function(){this.clipShapes.pop();this.layer&&this.layer.popClipShape()},isCanvasState:function(){return this.layer.isCanvasLayer},isDOMState:function(){return this.layer.isDOMLayer},
applyTransformationMatrix:function(b){this.transform.append(b);this.layer.applyTransformationMatrix(b)}}})();scenery=scenery||{};
(function(){var d=phet.math.Bounds2;scenery.Layer=function(a){this.$main=a.$main;this.scene=a.scene;this.dirtyBounds=d.EVERYTHING;this.endSelfTrail=this.startSelfTrail=null};var b=scenery.Layer;b.prototype={constructor:b,getStartPointer:function(){return this.startPointer},getEndPointer:function(){return this.endPointer},toString:function(){return this.getName()+" "+(this.startPointer?this.startPointer.toString():"!")+" ("+(this.startSelfTrail?this.startSelfTrail.toString():"!")+") => "+(this.endPointer?
this.endPointer.toString():"!")+" ("+(this.endSelfTrail?this.endSelfTrail.toString():"!")+")"},updateBoundaries:function(a){this.startPointer=a.startPointer;this.endPointer=a.endPointer;this.startSelfTrail=a.startSelfTrail;this.endSelfTrail=a.endSelfTrail},render:function(){throw Error("Layer.render unimplemented");},applyTransformationMatrix:function(){throw Error("Layer.applyTransformationMatrix unimplemented");},reindex:function(){throw Error("unimplemented layer reindex");},pushClipShape:function(){throw Error("Layer.pushClipShape unimplemented");
},popClipShape:function(){throw Error("Layer.popClipShape unimplemented");},renderToCanvas:function(){throw Error("Layer.renderToCanvas unimplemented");},dispose:function(){throw Error("Layer.dispose unimplemented");},markDirtyRegion:function(){throw Error("Layer.markDirtyRegion unimplemented");},transformChange:function(){throw Error("Layer.transformChange unimplemented");},getName:function(){throw Error("Layer.getName unimplemented");}}})();scenery=scenery||{};
(function(){var d=phet.math.Bounds2;scenery.CanvasLayer=function(a){scenery.Layer.call(this,a);this.backingScale=a.scene.backingScale;var b=this.$main.width(),e=this.$main.height(),d=document.createElement("canvas");d.width=b*this.backingScale;d.height=e*this.backingScale;$(d).css("width",b);$(d).css("height",e);$(d).css("position","absolute");this.$main.append(d);this.canvas=d;this.context=phet.canvas.initCanvas(d);this.scene=a.scene;this.context.miterLimit=20;this.context.miterLimit=10;this.isCanvasLayer=
!0;this.resetStyles()};var b=scenery.CanvasLayer;b.prototype=_.extend({},scenery.Layer.prototype,{constructor:b,render:function(a,b){b=b||{};if(b.fullRender||!this.dirtyBounds.isEmpty()){var e=new scenery.RenderState(a);e.layer=this;this.context.setTransform(this.backingScale,0,0,this.backingScale,0,0);this.resetStyles();var f=b.fullRender?a.sceneBounds:this.dirtyBounds.intersection(a.sceneBounds);f.isEmpty()||(this.clearGlobalBounds(f),b.fullRender||e.pushClipShape(scenery.Shape.bounds(f)),this.recursiveRender(e,
b),b.fullRender||e.popClipShape());this.dirtyBounds=d.NOTHING}},recursiveRender:function(a){var b,e=this.getStartPointer(),d=this.getEndPointer(),k=e.trail.length-(e.isBefore?1:0);for(b=0;b<k;b++)e.trail.nodes[b].enterState(a);e.depthFirstUntil(d,function(b){var e=b.trail.lastNode();if(b.isBefore)if(e.enterState(a),e._visible)e.hasSelf()&&e.paintCanvas(a);else return!0;else e.exitState(a)},!1);for(b=d.trail.length-(d.isAfter?1:0)-1;0<=b;b--)d.trail.nodes[b].exitState(a)},dispose:function(){$(this.canvas).detach()},
applyTransformationMatrix:function(a){a.canvasAppendTransform(this.context)},resetStyles:function(){this.strokeStyle=this.fillStyle=null;this.lineWidth=1;this.lineCap="butt";this.lineJoin="miter";this.miterLimit=10;this.font="10px sans-serif";this.textAlign="start";this.textBaseline="alphabetic";this.direction="inherit"},reindex:function(a){$(this.canvas).css("z-index",a);this.zIndex=a;return a+1},pushClipShape:function(a){this.context.save();this.writeClipShape(a)},popClipShape:function(){this.context.restore()},
writeClipShape:function(a){this.context.beginPath();a.writeToContext(this.context);this.context.clip()},clearGlobalBounds:function(a){a.isEmpty()||(this.context.save(),this.context.setTransform(this.backingScale,0,0,this.backingScale,0,0),this.context.clearRect(a.x(),a.y(),a.width(),a.height()),this.context.restore())},setFillStyle:function(a){this.fillStyle!==a&&(this.fillStyle=a,this.context.fillStyle=a)},setStrokeStyle:function(a){this.strokeStyle!==a&&(this.strokeStyle=a,this.context.strokeStyle=
a)},setLineWidth:function(a){this.lineWidth!==a&&(this.lineWidth=a,this.context.lineWidth=a)},setLineCap:function(a){this.lineCap!==a&&(this.lineCap=a,this.context.lineCap=a)},setLineJoin:function(a){this.lineJoin!==a&&(this.lineJoin=a,this.context.lineJoin=a)},setFont:function(a){this.font!==a&&(this.font=a,this.context.font=a)},setTextAlign:function(a){this.textAlign!==a&&(this.textAlign=a,this.context.textAlign=a)},setTextBaseline:function(a){this.textBaseline!==a&&(this.textBaseline=a,this.context.textBaseline=
a)},setDirection:function(a){this.direction!==a&&(this.direction=a,this.context.direction=a)},getSVGString:function(){return'<image xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="'+this.canvas.toDataURL()+'" x="0" y="0" height="'+this.canvas.height+'px" width="'+this.canvas.width+'px"/>'},renderToCanvas:function(a,b){b.drawImage(this.canvas,0,0)},markDirtyRegion:function(a){a=a.transform.transformBounds2(a.bounds);this.dirtyBounds=this.dirtyBounds.union(a.dilated(1).roundedOut())},transformChange:function(){},
getName:function(){return"canvas"}})})();scenery=scenery||{};
(function(){scenery.DOMLayer=function(b){scenery.Layer.call(this,b);this.div=document.createElement("div");this.$div=$(this.div);this.$div.width(this.$main.width());this.$div.height(this.$main.height());this.$div.css("position","absolute");this.$main.append(this.div);this.scene=b.scene;this.isDOMLayer=!0};var d=scenery.DOMLayer;d.prototype=_.extend({},scenery.Layer.prototype,{constructor:d,updateBoundaries:function(b){scenery.Layer.prototype.updateBoundaries.call(this,b);var a=this;this.startPointer.eachTrailBetween(this.endPointer,
function(b){var e=b.lastNode();e.hasSelf()&&(e.addToDOMLayer(a),e.updateCSSTransform(b.getTransform()))})},render:function(){},dispose:function(){this.$div.detach()},markDirtyRegion:function(){},transformChange:function(b){var a=b.trail;this.startPointer.eachTrailBetween(this.endPointer,function(b){if(b.isExtensionOf(a,!0)){var e=b.lastNode();e.hasSelf()&&e.updateCSSTransform(b.getTransform())}})},applyTransformationMatrix:function(){},getContainer:function(){return this.div},reindex:function(b){this.$div.css("z-index",
b);this.zIndex=b;return b+1},pushClipShape:function(){},popClipShape:function(){},getSVGString:function(){this.$main.width();this.$main.height();$(this.div).html()},renderToCanvas:function(){},getName:function(){return"dom"}})})();scenery=scenery||{};
(function(){scenery.SVGLayer=function(b){var a=b.$main;this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg");this.g=document.createElementNS("http://www.w3.org/2000/svg","g");this.svg.appendChild(this.g);this.$svg=$(this.svg);this.svg.setAttribute("width",a.width());this.svg.setAttribute("height",a.height());this.svg.setAttribute("stroke-miterlimit",10);this.$svg.css("position","absolute");a.append(this.svg);this.scene=b.scene;this.isSVGLayer=!0;this.idFragmentMap={};this.idGroupMap=
{};this.temporaryDebugFlagSoWeDontUpdateBoundariesMoreThanOnce=!1;scenery.Layer.call(this,b)};var d=scenery.SVGLayer;d.prototype=_.extend({},scenery.Layer.prototype,{constructor:d,applyGroup:function(b,a){b.transform.isIdentity()?a.hasAttribute("transform")&&a.removeAttribute("transform"):a.setAttribute("transform",b.transform.getMatrix().svgTransform())},ensureGroupTree:function(b){if(!(b.getUniqueId()in this.idGroupMap))for(var a=new scenery.Trail(b.rootNode()),c=null;a.length<=b.length;){var e=
a.getUniqueId();if(!(e in this.idGroupMap)){var d=document.createElementNS("http://www.w3.org/2000/svg","g");this.applyGroup(a.lastNode(),d);this.idGroupMap[e]=d;c?this.idGroupMap[c].appendChild(d):this.g.appendChild(d)}a.addDescendant(b.nodes[a.length]);c=e}},updateBoundaries:function(b){if(this.temporaryDebugFlagSoWeDontUpdateBoundariesMoreThanOnce)throw Error("temporaryDebugFlagSoWeDontUpdateBoundariesMoreThanOnce!");this.temporaryDebugFlagSoWeDontUpdateBoundariesMoreThanOnce=!0;scenery.Layer.prototype.updateBoundaries.call(this,
b);var a=this;this.startPointer.eachTrailBetween(this.endPointer,function(b){var e=b.lastNode(),d=b.getUniqueId();a.ensureGroupTree(b);e.hasSelf()&&(b=e.createSVGFragment(),a.idFragmentMap[d]=b,a.idGroupMap[d].appendChild(b))})},render:function(){},dispose:function(){this.$svg.detach()},markDirtyRegion:function(){},transformChange:function(b){var a=b.node;b=this.idGroupMap[b.trail.getUniqueId()];this.applyGroup(a,b)},applyTransformationMatrix:function(){},getContainer:function(){return this.svg},
reindex:function(b){this.$svg.css("z-index",b);this.zIndex=b;return b+1},pushClipShape:function(){},popClipShape:function(){},getSVGString:function(){return $("<div>").append(this.$svg.clone()).html()},renderToCanvas:function(b,a,c){if(window.canvg)c.increment(),canvg(b,this.getSVGString(),{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,renderCallback:function(){c.decrement()}});else{var e=window.URL||window.webkitURL||window,d=new Image;b=this.getSVGString();console.log(b);
b=new Blob([b],{type:"image/svg+xml;charset=utf-8"});var k=e.createObjectURL(b);c.increment();d.onload=function(){a.drawImage(d,0,0);e.revokeObjectURL(k);c.decrement()};d.src=k;throw Error("this implementation hits Chrome bugs, won't work on IE9/10, etc. deprecated");}},getName:function(){return"svg"}})})();scenery=scenery||{};
(function(){scenery.LayerType=function(b,a){this.Constructor=b;this.name=a};var d=scenery.LayerType;d.prototype={constructor:d,supports:function(b){return this===b},supportsNode:function(b){var a=this;return _.some(b._supportedLayerTypes,function(b){return a.supports(b)})},createLayer:function(b){return new this.Constructor(b)}};d.Canvas=new scenery.LayerType(scenery.CanvasLayer,"canvas");d.DOM=new scenery.LayerType(scenery.DOMLayer,"dom");d.SVG=new scenery.LayerType(scenery.SVGLayer,"svg")})();
scenery=scenery||{};
(function(){scenery.LayerState=function(){this.preferredLayerTypes=[];this.resetInternalState()};var d=scenery.LayerState;d.prototype={constructor:d,buildLayers:function(b,a,c){this.resetInternalState();this.currentLayerStartPointer=b;c&&(this.nextLayerType=c);var e=this;b.depthFirstUntil(a,function(a){e.currentPointer=a;var b=a.trail.lastNode();a.isBefore?b.layerStrategy.enter(a.trail,e):b.layerStrategy.exit(a.trail,e)},!1);this.currentPointer=a;this.finishLayer(a);return this.layerChangeEntries},resetInternalState:function(){this.layerChangeEntries=
[];this.typeDirty=!0;this.lastSelfTrail=this.currentLayerStartPointer=this.nextLayerType=null},pushPreferredLayerType:function(b){this.preferredLayerTypes.push(b)},popPreferredLayerType:function(){this.preferredLayerTypes.pop()},switchToType:function(b,a){var c=null===this.nextLayerType;this.typeDirty=!0;this.nextLayerType=a;c||(this.currentLayerStartPointer=this.currentPointer.copy())},markSelf:function(){var b=this.currentPointer.trail;this.typeDirty&&this.layerChange(b);this.lastSelfTrail=b.copy()},
getCurrentLayerType:function(){return this.nextLayerType},finishLayer:function(b){if(this.layerChangeEntries.length){var a=this.layerChangeEntries[this.layerChangeEntries.length-1];a.endSelfTrail=this.lastSelfTrail;a.endPointer=b}},layerChange:function(b){this.typeDirty=!1;var a=this.currentLayerStartPointer.copy();a.nestedBackwards();this.finishLayer(a);this.layerChangeEntries.push({type:this.nextLayerType,startPointer:this.currentLayerStartPointer.copy(),startSelfTrail:b})},getPreferredLayerType:function(){return 0!==
this.preferredLayerTypes.length?this.preferredLayerTypes[this.preferredLayerTypes.length-1]:null},bestPreferredLayerTypeFor:function(b){for(var a=this.preferredLayerTypes.length-1;0<=a;a--){var c=this.preferredLayerTypes[a];if(_.some(b,function(a){return c.supports(a)}))return c}return null}}})();scenery=scenery||{};
(function(){scenery.Strokable=function(d){d=d.prototype;d.initializeStrokable=function(){this._stroke=null;this._lineDrawingStyles=new scenery.Shape.LineStyles};d.hasStroke=function(){return null!==this._stroke};d.getLineWidth=function(){return this._lineDrawingStyles.lineWidth};d.setLineWidth=function(b){this.getLineWidth()!==b&&(this.markOldSelfPaint(),this._lineDrawingStyles.lineWidth=b,this.invalidateStroke());return this};d.getLineCap=function(){return this._lineDrawingStyles.lineCap};d.setLineCap=
function(b){this._lineDrawingStyles.lineCap!==b&&(this.markOldSelfPaint(),this._lineDrawingStyles.lineCap=b,this.invalidateStroke());return this};d.getLineJoin=function(){return this._lineDrawingStyles.lineJoin};d.setLineJoin=function(b){this._lineDrawingStyles.lineJoin!==b&&(this.markOldSelfPaint(),this._lineDrawingStyles.lineJoin=b,this.invalidateStroke());return this};d.setLineStyles=function(b){this.markOldSelfPaint();this._lineDrawingStyles=b;this.invalidateStroke();return this};d.getLineStyles=
function(){return this._lineDrawingStyles};d.getStroke=function(){return this._stroke};d.setStroke=function(b){this.getStroke()!==b&&(this.markOldSelfPaint(),this._stroke=b,this.invalidateStroke());return this};d._mutatorKeys=["stroke","lineWidth","lineCap","lineJoin"].concat(d._mutatorKeys);Object.defineProperty(d,"stroke",{set:d.setStroke,get:d.getStroke});Object.defineProperty(d,"lineWidth",{set:d.setLineWidth,get:d.getLineWidth});Object.defineProperty(d,"lineCap",{set:d.setLineCap,get:d.getLineCap});
Object.defineProperty(d,"lineJoin",{set:d.setLineJoin,get:d.getLineJoin});d.invalidateStroke||(d.invalidateStroke=function(){})}})();scenery=scenery||{};
(function(){scenery.Fillable=function(d){d=d.prototype;d.initializeFillable=function(){this._fill=null};d.hasFill=function(){return null!==this._fill};d.getFill=function(){return this._fill};d.setFill=function(b){this.getFill()!==b&&(this._fill=b,this.invalidatePaint(),this.invalidateFill());return this};d._mutatorKeys=["fill"].concat(d._mutatorKeys);Object.defineProperty(d,"fill",{set:d.setFill,get:d.getFill});d.invalidateFill||(d.invalidateFill=function(){})}})();scenery=scenery||{};
(function(){scenery.Path=function(b){this._shape=null;b=b||{};this.initializeStrokable();scenery.Node.call(this,b)};var d=scenery.Path;d.prototype=phet.Object.create(scenery.Node.prototype);d.prototype.constructor=d;d.prototype.setShape=function(b){this._shape!==b&&(this._shape=b,this.invalidateShape());return this};d.prototype.getShape=function(){return this._shape};d.prototype.invalidateShape=function(){this.markOldSelfPaint();this.hasShape()&&(this.invalidateSelf(this._shape.computeBounds(this._stroke?
this._lineDrawingStyles:null)),this.invalidatePaint())};d.prototype.invalidateStroke=function(){this.invalidateShape()};d.prototype.hasShape=function(){return null!==this._shape};d.prototype.paintCanvas=function(b){if(this.hasShape()){b=b.layer;var a=b.context;a.beginPath();this._shape.writeToContext(a);this._fill&&(b.setFillStyle(this._fill),a.fill());this._stroke&&(b.setStrokeStyle(this._stroke),b.setLineWidth(this.getLineWidth()),b.setLineCap(this.getLineCap()),b.setLineJoin(this.getLineJoin()),
a.stroke())}};d.prototype.paintWebGL=function(){throw Error("Path.prototype.paintWebGL unimplemented");};d.prototype.createSVGFragment=function(){var b=document.createElementNS("http://www.w3.org/2000/svg","path");this.updateSVGFragment(b);return b};d.prototype.updateSVGFragment=function(b){this.hasShape()?b.setAttribute("d",this._shape.getSVGPath()):b.hasAttribute("d")&&b.removeAttribute("d");var a;a=""+("fill: "+(this._fill?this._fill:"none")+";");a+="stroke: "+(this._stroke?this._stroke:"none")+
";";this._stroke&&(a+="stroke-width: "+this.getLineWidth()+";",a+="stroke-linecap: "+this.getLineCap()+";",a+="stroke-linejoin: "+this.getLineJoin()+";");b.setAttribute("style",a)};d.prototype.hasSelf=function(){return!0};d.prototype.containsPointSelf=function(b){if(!this.hasShape())return!1;var a=this._shape.containsPoint(b);!a&&(this._includeStrokeInHitRegion&&this.hasStroke())&&(a=this._shape.getStrokedShape(this._lineDrawingStyles).containsPoint(b));return a};d.prototype.intersectsBoundsSelf=
function(b){return this.hasShape()?this._shape.intersectsBounds(b):!1};d.prototype._mutatorKeys=["shape"].concat(scenery.Node.prototype._mutatorKeys);d.prototype._supportedLayerTypes=[scenery.LayerType.Canvas,scenery.LayerType.SVG];Object.defineProperty(d.prototype,"shape",{set:d.prototype.setShape,get:d.prototype.getShape});scenery.Fillable(d);scenery.Strokable(d)})();scenery=scenery||{};
(function(){scenery.Font=function(b){this._font="10px sans-serif";this.$span=$(document.createElement("span"));var a=typeof b;"string"===a?this._font=b:"object"===a&&this.mutate(b)};var d=scenery.Font;d.prototype={constructor:d,getProperty:function(b){this.$span.css("font",this._font);return this.$span.css(b)},setProperty:function(b,a){this.$span.css("font",this._font);this.$span.css(b,a);this._font=this.$span.css("font");return this},getFont:function(){return this._font},setFont:function(b){this._font=
b;return this},getFamily:function(){return this.getProperty("font-family")},setFamily:function(b){return this.setProperty("font-family",b)},getWeight:function(){return this.getProperty("font-weight")},setWeight:function(b){return this.setProperty("font-weight",b)},getStretch:function(){return this.getProperty("font-stretch")},setStretch:function(b){return this.setProperty("font-stretch",b)},getStyle:function(){return this.getProperty("font-style")},setStyle:function(b){return this.setProperty("font-style",
b)},getSize:function(){return this.getProperty("font-size")},setSize:function(b){return this.setProperty("font-size",b)},getLineHeight:function(){return this.getProperty("line-height")},setLineHeight:function(b){return this.setProperty("line-height",b)},set font(b){this.setFont(b)},get font(){return this.getFont()},set weight(b){this.setWeight(b)},get weight(){return this.getWeight()},set family(b){this.setFamily(b)},get family(){return this.getFamily()},set stretch(b){this.setStretch(b)},get stretch(){return this.getStretch()},
set style(b){this.setStyle(b)},get style(){return this.getStyle()},set size(b){this.setSize(b)},get size(){return this.getSize()},set lineHeight(b){this.setLineHeight(b)},get lineHeight(){return this.getLineHeight()},mutate:function(b){var a=this;_.each(this._mutatorKeys,function(c){void 0!==b[c]&&(a[c]=b[c])})}};d.prototype._mutatorKeys="font weight family stretch style size lineHeight".split(" ")})();scenery=scenery||{};
(function(){function d(a,c,e){var d="get"+c;c="set"+c;b.prototype[d]=function(){return this._font[e]};b.prototype[c]=function(a){this._font[e]=a;this.invalidateText();return this};Object.defineProperty(b.prototype,a,{set:b.prototype[c],get:b.prototype[d]})}scenery.Text=function(a,b){this._text="";this._font=new scenery.Font;this._textAlign="start";this._textBaseline="alphabetic";this._direction="ltr";b=b||{};void 0===b.fill&&(b.fill="#000000");void 0!==a&&(b.text=a);scenery.Node.call(this,b)};var b=
scenery.Text;b.prototype=phet.Object.create(scenery.Node.prototype);b.prototype.constructor=b;b.prototype.setText=function(a){this._text=a;this.invalidateText();return this};b.prototype.getText=function(){return this._text};b.prototype.invalidateText=function(){this.invalidateSelf(this.accurateCanvasBounds())};b.prototype.paintCanvas=function(a){a=a.layer;var b=a.context;this.hasFill()&&(a.setFillStyle(this.getFill()),a.setFont(this._font.getFont()),a.setTextAlign(this._textAlign),a.setTextBaseline(this._textBaseline),
a.setDirection(this._direction),b.fillText(this._text,0,0))};b.prototype.paintWebGL=function(){throw Error("Text.prototype.paintWebGL unimplemented");};b.prototype.createSVGFragment=function(){var a=document.createElementNS("http://www.w3.org/2000/svg","text");this.updateSVGFragment(a);return a};b.prototype.updateSVGFragment=function(a){for(var b="rtl"===this._direction;a.hasChildNodes();)a.removeChild(a.lastChild);a.appendChild(document.createTextNode(this._text));a.setAttribute("fill",this._fill);
switch(this._textAlign){case "start":case "end":a.setAttribute("text-anchor",this._textAlign);break;case "left":a.setAttribute("text-anchor",b?"end":"start");break;case "right":a.setAttribute("text-anchor",!b?"end":"start");break;case "center":a.setAttribute("text-anchor","middle")}switch(this._textBaseline){case "alphabetic":case "ideographic":case "hanging":case "middle":a.setAttribute("dominant-baseline",this._textBaseline);break;default:throw Error("impossible to get the SVG approximate bounds for textBaseline: "+
this._textBaseline);}a.setAttribute("direction",this._direction);a.setAttribute("font-family",this._font.getFamily());a.setAttribute("font-size",this._font.getSize());a.setAttribute("font-style",this._font.getStyle());a.setAttribute("font-weight",this._font.getWeight());this._font.getStretch()&&a.setAttribute("font-stretch",this._font.getStretch())};b.prototype.accurateCanvasBounds=function(){var a=this;return scenery.canvasAccurateBounds(function(b){b.font=a.font;b.textAlign=a.textAlign;b.textBaseline=
a.textBaseline;b.direction=a.direction;b.fillText(a.text,0,0)})};b.prototype.approximateSVGBounds=function(){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("width","1024");a.setAttribute("height","1024");a.setAttribute("style","display: hidden;");var b=document.createElementNS("http://www.w3.org/2000/svg","text");this.updateSVGFragment(b);a.appendChild(b);document.body.appendChild(a);b=b.getBBox();b=new phet.math.Bounds2(b.x,b.y,b.x+b.width,b.y+b.height);document.body.removeChild(a);
return b};b.prototype.approximateDOMBounds=function(){phet.assert("alphabetic"===this._textBaseline);var a="rtl"===this.direction,b=document.createElement("div");$(b).css({position:"absolute",left:0,top:0,padding:"0 !important",margin:"0 !important",display:"hidden"});var e=document.createElement("span");$(e).css("font",this.getFont());e.appendChild(document.createTextNode(this.text));e.setAttribute("direction",this._direction);var d=document.createElement("div");$(d).css({"vertical-align":"baseline",
display:"inline-block",width:0,height:"1024px",margin:"0 !important",padding:"0 !important"});b.appendChild(e);b.appendChild(d);document.body.appendChild(b);e=e.getBoundingClientRect();d=b.getBoundingClientRect();d=(new phet.math.Bounds2(e.left,e.top-1024,e.right,e.bottom-1024)).shifted(-d.left,-d.top);document.body.removeChild(b);b=e.right-e.left;switch(this._textAlign){case "start":d=d.shiftedX(a?-b:0);break;case "end":d=d.shiftedX(!a?-b:0);break;case "right":d=d.shiftedX(-b);break;case "center":d=
d.shiftedX(-b/2)}return d};b.prototype.setFont=function(a){this._font=a instanceof scenery.Font?a:new scenery.Font(a);this.invalidateText();return this};b.prototype.getFont=function(){return this._font.getFont()};b.prototype.setTextAlign=function(a){this._textAlign=a;this.invalidateText();return this};b.prototype.getTextAlign=function(){return this._textAlign};b.prototype.setTextBaseline=function(a){this._textBaseline=a;this.invalidateText();return this};b.prototype.getTextBaseline=function(){return this._textBaseline};
b.prototype.setDirection=function(a){this._direction=a;this.invalidateText();return this};b.prototype.getDirection=function(){return this._direction};d("fontWeight","fontWeight","weight");d("fontFamily","fontFamily","family");d("fontStretch","fontStretch","stretch");d("fontStyle","fontStyle","style");d("fontSize","fontSize","size");d("lineHeight","LineHeight","lineHeight");b.prototype.hasSelf=function(){return!0};b.prototype._mutatorKeys="text font fontWeight fontFamily fontStretch fontStyle fontSize lineHeight textAlign textBaseline direction".split(" ").concat(scenery.Node.prototype._mutatorKeys);
b.prototype._supportedLayerTypes=[scenery.LayerType.Canvas,scenery.LayerType.SVG];Object.defineProperty(b.prototype,"font",{set:b.prototype.setFont,get:b.prototype.getFont});Object.defineProperty(b.prototype,"text",{set:b.prototype.setText,get:b.prototype.getText});Object.defineProperty(b.prototype,"textAlign",{set:b.prototype.setTextAlign,get:b.prototype.getTextAlign});Object.defineProperty(b.prototype,"textBaseline",{set:b.prototype.setTextBaseline,get:b.prototype.getTextBaseline});Object.defineProperty(b.prototype,
"direction",{set:b.prototype.setDirection,get:b.prototype.getDirection});scenery.Fillable(b)})();scenery=scenery||{};
(function(){scenery.DOM=function(b,a){b&&b.jquery&&(b=b[0]);this._element=b;this._$element=$(b);this._$element.css("position","absolute");this._$element.css("left",0);this._$element.css("top",0);a.element=b;var c=document.createElement("div");$(c).css({display:"hidden",padding:"0 !important",margin:"0 !important",position:"absolute",left:0,top:0});c.appendChild(b);document.body.appendChild(c);scenery.Node.call(this,a);document.body.removeChild(c);b.parentNode===c&&c.removeChild(b)};var d=scenery.DOM;
d.prototype=phet.Object.create(scenery.Node.prototype);d.prototype.constructor=d;d.prototype.invalidatePaint=function(b){scenery.Node.prototype.invalidatePaint.call(this,b)};d.prototype.invalidateDOM=function(){this.invalidateSelf(new phet.math.Bounds2(0,0,this._$element.width(),this._$element.height()))};d.prototype.addToDOMLayer=function(b){b.$div.append(this._element);this.invalidateDOM()};d.prototype.updateCSSTransform=function(b){this._$element.css(b.getMatrix().cssTransformStyles())};d.prototype.hasSelf=
function(){return!0};d.prototype.setElement=function(b){this._element=b;this.invalidateDOM();return this};d.prototype.getElement=function(){return this._element};d.prototype._mutatorKeys=["element"].concat(scenery.Node.prototype._mutatorKeys);d.prototype._supportedLayerTypes=[scenery.LayerType.DOM];Object.defineProperty(d.prototype,"element",{set:d.prototype.setElement,get:d.prototype.getElement})})();scenery=scenery||{};
(function(){scenery.Image=function(b,a){scenery.Node.call(this,a);this.image=b;this.invalidateSelf(new phet.math.Bounds2(0,0,b.width,b.height))};var d=scenery.Image;d.prototype=phet.Object.create(scenery.Node.prototype);d.prototype.constructor=d;d.prototype.paintCanvas=function(b){b.layer.context.drawImage(this.image,0,0)};d.prototype.paintWebGL=function(){throw Error("Image.prototype.paintWebGL unimplemented");};d.prototype.hasSelf=function(){return!0};d.prototype._supportedLayerTypes=[scenery.LayerType.Canvas]})();
scenery=scenery||{};
(function(){function d(a){console.log("context."+a+";")}function b(a,b){d(a+" = "+JSON.stringify(b))}function a(a,b){void 0===b||0===b.length?d(a+"()"):d(a+"( "+_.reduce(b,function(a,b){return 0<a.length?a+", "+JSON.stringify(b):JSON.stringify(b)},"")+" )")}scenery.DebugContext=function(a){this._context=a};var c=scenery.DebugContext;c.prototype={constructor:c,get canvas(){d("canvas");return this._context.canvas},get width(){d("width");return this._context.width},get height(){d("height");return this._context.height},
commit:function(){a("commit");this._context.commit()},save:function(){a("save");this._context.save()},restore:function(){a("restore");this._context.restore()},get currentTransform(){d("currentTransform");return this._context.currentTransform},set currentTransform(a){b("currentTransform",a);this._context.currentTransform=a},scale:function(b,c){a("scale",[b,c]);this._context.scale(b,c)},rotate:function(b){a("rotate",[b]);this._context.rotate(b)},translate:function(b,c){a("translate",[b,c]);this._context.translate(b,
c)},transform:function(b,c,d,g,h,m){a("transform",[b,c,d,g,h,m]);this._context.transform(b,c,d,g,h,m)},setTransform:function(b,c,d,g,h,m){a("setTransform",[b,c,d,g,h,m]);this._context.setTransform(b,c,d,g,h,m)},resetTransform:function(){a("resetTransform");this._context.resetTransform()},get globalAlpha(){d("globalAlpha");return this._context.globalAlpha},set globalAlpha(a){b("globalAlpha",a);this._context.globalAlpha=a},get globalCompositeOperation(){d("globalCompositeOperation");return this._context.globalCompositeOperation},
set globalCompositeOperation(a){b("globalCompositeOperation",a);this._context.globalCompositeOperation=a},get imageSmoothingEnabled(){d("imageSmoothingEnabled");return this._context.imageSmoothingEnabled},set imageSmoothingEnabled(a){b("imageSmoothingEnabled",a);this._context.imageSmoothingEnabled=a},get strokeStyle(){d("strokeStyle");return this._context.strokeStyle},set strokeStyle(a){b("strokeStyle",a);this._context.strokeStyle=a},get fillStyle(){d("fillStyle");return this._context.fillStyle},
set fillStyle(a){b("fillStyle",a);this._context.fillStyle=a},createLinearGradient:function(b,c,d,g){a("createLinearGradient",[b,c,d,g]);return this._context.createLinearGradient(b,c,d,g)},createRadialGradient:function(b,c,d,g,h,m){a("createRadialGradient",[b,c,d,g,h,m]);return this._context.createRadialGradient(b,c,d,g,h,m)},createPattern:function(b,c){a("createPattern",[b,c]);return this._context.createPattern(b,c)},get shadowOffsetX(){d("shadowOffsetX");return this._context.shadowOffsetX},set shadowOffsetX(a){b("shadowOffsetX",
a);this._context.shadowOffsetX=a},get shadowOffsetY(){d("shadowOffsetY");return this._context.shadowOffsetY},set shadowOffsetY(a){b("shadowOffsetY",a);this._context.shadowOffsetY=a},get shadowBlur(){d("shadowBlur");return this._context.shadowBlur},set shadowBlur(a){b("shadowBlur",a);this._context.shadowBlur=a},get shadowColor(){d("shadowColor");return this._context.shadowColor},set shadowColor(a){b("shadowColor",a);this._context.shadowColor=a},clearRect:function(b,c,d,g){a("clearRect",[b,c,d,g]);
this._context.clearRect(b,c,d,g)},fillRect:function(b,c,d,g){a("fillRect",[b,c,d,g]);this._context.fillRect(b,c,d,g)},strokeRect:function(b,c,d,g){a("strokeRect",[b,c,d,g]);this._context.strokeRect(b,c,d,g)},get fillRule(){d("fillRule");return this._context.fillRule},set fillRule(a){b("fillRule",a);this._context.fillRule=a},beginPath:function(){a("beginPath");this._context.beginPath()},fill:function(b){a("fill",b?[b]:void 0);this._context.fill(b)},stroke:function(b){a("stroke",b?[b]:void 0);this._context.stroke(b)},
drawSystemFocusRing:function(b,c){a("drawSystemFocusRing",c?[b,c]:[b]);this._context.drawSystemFocusRing(b,c)},drawCustomFocusRing:function(b,c){a("drawCustomFocusRing",c?[b,c]:[b]);return this._context.drawCustomFocusRing(b,c)},scrollPathIntoView:function(b){a("scrollPathIntoView",b?[b]:void 0);this._context.scrollPathIntoView(b)},clip:function(b){a("clip",b?[b]:void 0);this._context.clip(b)},resetClip:function(){a("resetClip");this._context.resetClip()},isPointInPath:function(b,c,d){a("isPointInPath",
d?[b,c,d]:[b,c]);return this._context.isPointInPath(b,c,d)},fillText:function(b,c,d,g){a("fillText",void 0!==g?[b,c,d,g]:[b,c,d]);this._context.fillText(b,c,d,g)},strokeText:function(b,c,d,g){a("strokeText",void 0!==g?[b,c,d,g]:[b,c,d]);this._context.strokeText(b,c,d,g)},measureText:function(b){a("measureText",[b]);return this._context.measureText(b)},drawImage:function(b,c,d,g,h,m,n,p,q){a("drawImage",void 0!==g?void 0!==m?[b,c,d,g,h,m,n,p,q]:[b,c,d,g,h]:[b,c,d]);this._context.drawImage(b,c,d,g,
h,m,n,p,q)},addHitRegion:function(b){a("addHitRegion",[b]);this._context.addHitRegion(b)},removeHitRegion:function(b){a("removeHitRegion",[b]);this._context.removeHitRegion(b)},createImageData:function(b,c){a("createImageData",void 0!==c?[b,c]:[b]);return this._context.createImageData(b,c)},createImageDataHD:function(b,c){a("createImageDataHD",[b,c]);return this._context.createImageDataHD(b,c)},getImageData:function(b,c,d,g){a("getImageData",[b,c,d,g]);return this._context.getImageData(b,c,d,g)},
getImageDataHD:function(b,c,d,g){a("getImageDataHD",[b,c,d,g]);return this._context.getImageDataHD(b,c,d,g)},putImageData:function(b,c,d,g,h,m,n){a("putImageData",void 0!==g?[b,c,d,g,h,m,n]:[b,c,d]);this._context.putImageData(b,c,d,g,h,m,n)},putImageDataHD:function(b,c,d,g,h,m,n){a("putImageDataHD",void 0!==g?[b,c,d,g,h,m,n]:[b,c,d]);this._context.putImageDataHD(b,c,d,g,h,m,n)},get lineWidth(){d("lineWidth");return this._context.lineWidth},set lineWidth(a){b("lineWidth",a);this._context.lineWidth=
a},get lineCap(){d("lineCap");return this._context.lineCap},set lineCap(a){b("lineCap",a);this._context.lineCap=a},get lineJoin(){d("lineJoin");return this._context.lineJoin},set lineJoin(a){b("lineJoin",a);this._context.lineJoin=a},get miterLimit(){d("miterLimit");return this._context.miterLimit},set miterLimit(a){b("miterLimit",a);this._context.miterLimit=a},setLineDash:function(b){a("setLineDash",[b]);this._context.setLineDash(b)},getLineDash:function(){a("getLineDash");return this._context.getLineDash()},
get lineDashOffset(){d("lineDashOffset");return this._context.lineDashOffset},set lineDashOffset(a){b("lineDashOffset",a);this._context.lineDashOffset=a},get font(){d("font");return this._context.font},set font(a){b("font",a);this._context.font=a},get textAlign(){d("textAlign");return this._context.textAlign},set textAlign(a){b("textAlign",a);this._context.textAlign=a},get textBaseline(){d("textBaseline");return this._context.textBaseline},set textBaseline(a){b("textBaseline",a);this._context.textBaseline=
a},get direction(){d("direction");return this._context.direction},set direction(a){b("direction",a);this._context.direction=a},closePath:function(){a("closePath");this._context.closePath()},moveTo:function(b,c){a("moveTo",[b,c]);this._context.moveTo(b,c)},lineTo:function(b,c){a("lineTo",[b,c]);this._context.lineTo(b,c)},quadraticCurveTo:function(b,c,d,g){a("quadraticCurveTo",[b,c,d,g]);this._context.quadraticCurveTo(b,c,d,g)},bezierCurveTo:function(b,c,d,g,h,m){a("bezierCurveTo",[b,c,d,g,h,m]);this._context.bezierCurveTo(b,
c,d,g,h,m)},arcTo:function(b,c,d,g,h,m,n){a("arcTo",void 0!==m?[b,c,d,g,h,m,n]:[b,c,d,g,h]);this._context.arcTo(b,c,d,g,h,m,n)},rect:function(b,c,d,g){a("rect",[b,c,d,g]);this._context.rect(b,c,d,g)},arc:function(b,c,d,g,h,m){a("arc",[b,c,d,g,h,m]);this._context.arc(b,c,d,g,h,m)},ellipse:function(b,c,d,g,h,m,n,p){a("ellipse",[b,c,d,g,h,m,n,p]);this._context.ellipse(b,c,d,g,h,m,n,p)}}})();

//@ sourceMappingURL=scenery-min.js.map
